<!DOCTYPE html>

<html>
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ISYE6644_Simulation</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>




<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
<!-- End of mathjax configuration --><link href="https://monzersaleh.github.io/css/jlab.css" rel="stylesheet"/><link href="https://netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"/><link href="https://monzersaleh.github.io/css/mymenu_v1.css" rel="stylesheet"/></head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light"><nav class="nav" id="leftMenu" role="navigation"><ul class="nav__list"><li><a href="/">Home Page</a></li><li><a href="#Details">Details</a></li><li><input hidden id="group-2" type="checkbox"/><label for="group-2"><span class="fa fa-angle-right"></span>M1-Intro</label><ul class="group-list"><li><a href="#Introduction">Introduction</a></li><li><a href="#Examples">Examples</a></li><li><a href="#Randomness">Randomness</a></li><li><a href="#Simulated-Output">Simulated Output</a></li></ul></li><li><input hidden id="group-3" type="checkbox"/><label for="group-3"><span class="fa fa-angle-right"></span>M2-Math&amp;Stats Review</label><ul class="group-list"><li><a href="#Calc---Derivatives">Calc - Derivatives</a></li><li><a href="#Calc---Integrals">Calc - Integrals</a></li><li><a href="#Calc---Numerical-Integration">Calc - Numerical Integration</a></li><li><a href="#Probability">Probability</a></li><li><a href="#Expectations">Expectations</a></li><li><a href="#Functions-of-an-R.V.">Functions of an R.V.</a></li><li><a href="#Joint-PDFs">Joint PDFs</a></li><li><a href="#Conditional-Expectations">Conditional Expectations</a></li><li><a href="#Correlation-&amp;-Covariance">Correlation &amp; Covariance</a></li><li><a href="#Common-Distributions">Common Distributions</a></li><li><a href="#Estimation">Estimation</a></li></ul></li><li><input hidden id="group-4" type="checkbox"/><label for="group-4"><span class="fa fa-angle-right"></span>M3-Basic Simulation</label><ul class="group-list"><li><a href="#Integration">Integration</a></li><li><a href="#Monte-Carlo-Integration">Monte Carlo Integration</a></li><li><a href="#MCI---Example-1">MCI - Example 1</a></li><li><a href="#MCI---Example-2">MCI - Example 2</a></li><li><a href="#MCI---Example-3">MCI - Example 3</a></li><li><a href="#MCI---Example-4">MCI - Example 4</a></li></ul></li><li><input hidden id="group-5" type="checkbox"/><label for="group-5"><span class="fa fa-angle-right"></span>M4-Simulation Basics</label><ul class="group-list"><li><a href="#Simulation-Steps">Simulation Steps</a></li><li><a href="#Definitions-and-terminology">Definitions and terminology</a></li><li><a href="#Time-Advance-Mechanisms">Time Advance Mechanisms</a></li><li><a href="#General-Modelling">General Modelling</a></li><li><a href="#Simulation-Languages">Simulation Languages</a></li></ul></li><li><a href="#Arena">Arena</a></li><li><input hidden id="group-7" type="checkbox"/><label for="group-7"><span class="fa fa-angle-right"></span>M5Pt1-ARENA intro</label><ul class="group-list"><li><a href="#Introduction">Introduction</a></li></ul></li><li><input hidden id="group-8" type="checkbox"/><label for="group-8"><span class="fa fa-angle-right"></span>M5Pt2-ARENA continued</label><ul class="group-list"><li><a href="#Batch,-Separate,-and-Record-Modules">Batch Separate and Record Modules</a></li><li><a href="#Run-Setup-and-Control">Run Setup and Control</a></li><li><a href="#Two-Channel-Manufacturing-Example">Two-Channel Manufacturing Example</a></li></ul></li><li><input hidden id="group-9" type="checkbox"/><label for="group-9"><span class="fa fa-angle-right"></span>M5Pt3-ARENA Advanced</label><ul class="group-list"><li><a href="#Fake-Customers">Fake Customers</a></li><li><a href="#The-Advanced-Process-Template">The Advanced Process Template</a></li><li><a href="#Seize,-Delay,-Release">Seize Delay Release</a></li><li><a href="#Resource-Failures-and-Maintenance">Resource Failures and Maintenance</a></li><li><a href="#The-Blocks-Template">The Blocks Template</a></li><li><a href="#The-Joy-of-Sets">The Joy of Sets</a></li><li><a href="#Ex-Call-Centre-Model">Ex Call-Centre Model</a></li><li><a href="#Demo-Inventory-System">Demo-Inventory System</a></li><li><a href="#Demo-1-vs-2-Waiting-Lines">Demo-1 vs 2 Waiting Lines</a></li></ul></li><li><input hidden id="group-10" type="checkbox"/><label for="group-10"><span class="fa fa-angle-right"></span>M6-Generating Random Nums Uniform</label><ul class="group-list"><li><a href="#Lousy-Generators">Lousy Generators</a></li><li><a href="#Linear-Congruential-Generators">Linear Congruential Generators</a></li><li><a href="#Tausworthe-generator">Tausworthe generator</a></li><li><a href="#Generalizations-of-LCGs">Generalizations of LCGs</a></li><li><a href="#Generators---Theory">Generators - Theory</a></li><li><a href="#Generators---Choosing/Testing">Generators - ChoosingTesting</a></li></ul></li><li><input hidden id="group-11" type="checkbox"/><label for="group-11"><span class="fa fa-angle-right"></span>M7-RV Generation</label><ul class="group-list"><li><a href="#Inverse-Transform-Theorem">Inverse Transform Theorem</a></li><li><a href="#Further-examples">Further examples</a></li><li><a href="#Discrete-Examples">Discrete Examples</a></li><li><a href="#Empiral-Distributions">Empiral Distributions</a></li><li><a href="#Convolution-Method">Convolution Method</a></li><li><a href="#Acceptance-Rejection-Method">Acceptance-Rejection Method</a></li><li><a href="#Ex1-Complex-Function">Ex1-Complex Function</a></li><li><a href="#Ex2-Half-Normal">Ex2-Half Normal</a></li><li><a href="#Normal">Normal</a></li></ul></li><li><input hidden id="group-12" type="checkbox"/><label for="group-12"><span class="fa fa-angle-right"></span>M7-RV Gen Continued</label><ul class="group-list"><li><a href="#Ex3-Poisson">Ex3-Poisson</a></li><li><a href="#Composition">Composition</a></li><li><a href="#Box-Muller">Box-Muller</a></li><li><a href="#Polar-Method">Polar Method</a></li><li><a href="#Order-Statistics">Order Statistics</a></li><li><a href="#BiVariate-Normal">BiVariate Normal</a></li><li><a href="#MultiVariate-Normal">MultiVariate Normal</a></li><li><a href="#Markov-Chains">Markov Chains</a></li><li><a href="#Nonhomogeneous-Poisson-Processes-(NHPP)">Nonhomogeneous Poisson Processes NHPP</a></li><li><a href="#Time-Series">Time Series</a></li><li><a href="#Queueing">Queueing</a></li><li><a href="#Brownian-Motion">Brownian Motion</a></li></ul></li><li><input hidden id="group-13" type="checkbox"/><label for="group-13"><span class="fa fa-angle-right"></span>M8-Input Analysis</label><ul class="group-list"><li><a href="#Identifying-Distributions">Identifying Distributions</a></li><li><a href="#Unbiased-Point-Estimation">Unbiased Point Estimation</a></li><li><a href="#Mean-Squared-Error">Mean Squared Error</a></li></ul></li><li><input hidden id="group-14" type="checkbox"/><label for="group-14"><span class="fa fa-angle-right"></span>M9-Output Analysis</label><ul class="group-list"><li><a href="#Introduction">Introduction</a></li><li><a href="#Mathematical-Interlude">Mathematical Interlude</a></li><li><a href="#Finite-Horizon-Analysis">Finite-Horizon Analysis</a></li><li><a href="#Finite-Horizon-Extensions">Finite-Horizon Extensions</a></li><li><a href="#Simulation-Initialization">Simulation Initialization</a></li><li><a href="#Steady-State-Analysis">Steady-State Analysis</a></li><li><a href="#Prop-of-Batch-Means">Prop of Batch Means</a></li></ul></li><li><a href="#End-of-Notes">End of Notes</a></li><li><a href="#Pi-Simulation">Pi Simulation</a></li></ul></nav><div id="contentBody"><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h1 id="ISYE-6644---Simulation">ISYE 6644 - Simulation<a class="anchor-link" href="#ISYE-6644---Simulation">¶</a></h1><h2 id="Details">Details<a class="anchor-link" href="#Details">¶</a></h2><p><strong>Professor:</strong>  Dr. David Goldsman</p>
<p><a href="https://www2.isye.gatech.edu/~sman/courses/6739/A-First-Course-in-Probability-and-Statistics-Student-Version-v210818.pdf">Textbook Optional</a></p>
<p><a href="https://www2.isye.gatech.edu/~sman/courses/6739/">Course Notes</a></p>
<p><a href="https://www.omscs-notes.com/simulation/welcome/">Other Notes</a></p>
<p><strong>Description</strong><br/>
This course covers modeling of discrete-event dynamic systems and introduces methods for using these models to solve engineering design and analysis problems.  It'll be a mix of probability, statistics, computer science, and programming.</p>
<p>We'll work hard and play hard on a number of interesting topics.  Everything from a Prob/Stats bootcamp to the generation of random variables on a computer to the analysis of outputs from a simulation.    I tend to assign a lot of homework, but I promise that it's all reasonable.  We'll have two impossibly difficult midterms and a final, but you'll survive.</p>
<p>By the time you're done with this course (if you are still walking), you'll be able to model, simulate, and analyze a variety of real-world processes.  Think the line at Disneyworld, or a complicated manufacturing system, or even stock options!</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M1-Intro">M1-Intro<a class="anchor-link" href="#M1-Intro">¶</a></h2><h3 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">¶</a></h3><p>Objectives:</p>
<ul>
<li>Identify simulation models and recognize studies</li>
<li>Illustrate organization of simulation languages including Modeling with Arena ( a comprehensive simulation package )</li>
</ul>
<p><strong>Models</strong><br/>
Are high level representations of the operation of a real world process or system.</p>
<ul>
<li>Can be discrete (vs Continuous)</li>
<li>Stochastic (vs Deterministic)</li>
<li>Dynamic (vs Static)</li>
</ul>
<p>How to solve a model?</p>
<ul>
<li>Analytical methods (exact and/or symbolic)</li>
<li>Numerical methods</li>
<li>Simulation</li>
</ul>
<p>Simulation is good to describe / analyze real or conceptual system behaviour. Ask "what-if" type questions. Aid in system design and optimization. It is most popular in Manufacturing industry. Used calculate the movement of parts of interation of system components; Evaluate part flow thru a system; Examine conflicting demand for resources; etc etc. Basically any system that looks at throughput (Queueing Problems). Disadvantages include: Not easy, Time consuming and costly,</p>
<p>Let's now take a quick look at some applications of simulation.<br/>
These include</p>
<ul>
<li>call centres, fast food drive thrus, </li>
<li>as well manufacturing plants such as an automobile centre or other production facility, </li>
<li>supply chains   </li>
<li>Health: Hospital room allocations, Disease propogation</li>
<li>Time: monitoring time series</li>
<li>Surveillance Monitoring such as drugs administered in a hospital setting</li>
</ul>
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples">¶</a></h3><p>Let's now look at some examples</p>
<p>Q1: How many people need to be a room such that there is at least two with the same birthday?</p>
<ul>
<li>You could take some random guesses such as 9, 23, 42, or 183! </li>
<li>It turns out that only 23 people are needed! On average at least </li>
</ul>
<p>Q2: Simulating Pi (3.14159...)</p>
<ul>
<li>draw a unit square, and inside it draw a circle ( fully inside )</li>
<li>now throw a dart at the square, and keep count,</li>
<li>if inside the circle it counts as a success, </li>
<li>as the number of throws grows the proportion </li>
</ul>
<p>Q3: Integration using simulation</p>
<ul>
<li>Recall that an integral of a function can be approximated by a series of rectangles along the x axis.</li>
<li>their height is determined by the function value at the centre</li>
<li>now sum the area of all the rectangles</li>
<li>as these rectangle get thinner and thinner </li>
<li>you'll converge to the integral</li>
</ul>
<p><img src="ISYE6644_images/w101.png" width="350"/></p>
<h3 id="Randomness">Randomness<a class="anchor-link" href="#Randomness">¶</a></h3><p>Problem:</p>
<ul>
<li>Need random variables (RVs) to run the simulation, (e.g. interarrival times, service times)    </li>
</ul>
<p>Solutions<br/>
Generate uniform(0,1) pseudo-random numbers (PRNs)</p>
<ul>
<li>using a deterministice algorithm</li>
<li>Not really random but appear to be ( to a human at least )</li>
</ul>
<p>Generate other RVs</p>
<ul>
<li>Start with unif(0,1)</li>
<li>Apply transformations to get to any other type of random variable</li>
</ul>
<p>Example: Linear Congruential Generator</p>
<ul>
<li>Choose an integer "seed"    </li>
<li>Set X(i) = a * X(i-1) mod m     </li>
<li>where a &amp; m are carefully chosen constants and mod is the modulus function</li>
<li>Set the i'th PRN as U(i) = X(i)/m</li>
<li>(Hint: m should a big prime number)</li>
</ul>
<h3 id="Simulated-Output">Simulated Output<a class="anchor-link" href="#Simulated-Output">¶</a></h3><p>Random input to a simulator means the output will also be somewhat random.</p>
<ul>
<li>almost never normally distributed</li>
<li>Not identically distributed </li>
<li>Not independent</li>
</ul>
<p>All this means that traditional statistical methods will fail.</p>
<p>Terminating Simulations</p>
<ul>
<li>Usually analyzed via independent replications</li>
<li>Make indep runs of the simulation under identical conditions</li>
<li>Sample means from each replication are assumed to be i.i.d.</li>
</ul>
<p>Steady-State Simulations</p>
<ul>
<li>First deal with initialization (start-up) bias</li>
<li>Usually warm-up simulation before collecting data. Failure to do so can ruin future analysis</li>
<li>For sampling there is <ul>
<li>Batch Means</li>
<li>Overlapping Batch Means / Spectral Analysis</li>
<li>Standardized Time Series</li>
<li>Regeneration</li>
</ul>
</li>
</ul>
<p>Batch means is the most popular.</p>
<ul>
<li>first do a warm up simulation, </li>
<li>then you make one really long run</li>
<li>then chop the remaining observations into contiguous batches</li>
<li>then sample means from each batch are approximately i.i.d. normal</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M2-Math&amp;Stats-Review">M2-Math&amp;Stats Review<a class="anchor-link" href="#M2-Math&amp;Stats-Review">¶</a></h2><p>Review of basic statistics, probability, and calculus. That will be needed later on.</p>
<h3 id="Calc---Derivatives">Calc - Derivatives<a class="anchor-link" href="#Calc---Derivatives">¶</a></h3><p>Suppose f(x) is a function that maps values of x from a certain domain X to a range Y, which we denote $f:X \to Y $</p>
<p>Then<br/>
$f(x)$ is continuous if for any $x_0$ and $x \in X$ we have $\lim_{x \to x_0} f(x)$</p>
<ul>
<li>where "lim" is assumed to exist for all $x \in X$</li>
</ul>
<p>if $f(x)$ is continuous then the deriviative is given by</p>
<ul>
<li>$\frac{d}{dx} f(x) = f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}$</li>
</ul>
<p>Some handy derivatives you should recall</p>
<ul>
<li>$\frac{d}{dx} x^k = kx^{k-1}$</li>
<li>$\frac{d}{dx} e^x = e^x$ </li>
<li>$\frac{d}{dx} sin(x) = cos(x)$</li>
<li>$\frac{d}{dx} cos(x) = -sin(x)$</li>
<li>$\frac{d}{dx} ln(x) = \frac{1}{x}$</li>
<li>$\frac{d}{dx} arctan(x) = \frac{1}{(1+x^2)}$</li>
</ul>
<p>Some handy properties/shortcuts<br/>
<img src="ISYE6644_images/w201.png" width="350"/></p>
<p>The second derivative $f''(x) = \frac{d}{dx}f'(x)$ and is the slope of the slope. In many examples f is thought of as the position, making f' the velocity, and f'' is the acceleration.</p>
<p>This has some super handy properties:</p>
<ul>
<li>the min/max of f(x) can only occur when the slope of f(x) is zero, i.e. only when f'(x)=0, say at $x=x_0$</li>
<li>In some situations this can be thought of as a point of inflection<ul>
<li>this is useful when you need to find the roots of $f(x)$, or when trying to find a min/max value in an optimization </li>
</ul>
</li>
</ul>
<p>Methods for finding zero's(basic functions):</p>
<ol>
<li>Analytical <ul>
<li>given a function f(x) </li>
<li>we set f'(x)=0 and solve for x</li>
</ul>
</li>
<li>Bisection (IVT - Intermediate Value Theorem)<ul>
<li>given f(x) and x1 and x2, with x1!=x2, where f(x1)&gt;0 and f(x2)&lt;0</li>
<li>then we bisect the interval (x1,x2) at a point x3 and comute f(x3)</li>
<li>we repeat this process for say (x1,x3) and continue the process </li>
<li>until we reach convergence or reach a threshold    </li>
</ul>
</li>
<li>Newton's method (for well behaved derivatives)<ul>
<li>given f(x) and some guess (xi)</li>
<li>choose x_i+1 = x_i - g(x_i)/g'(x_i)</li>
<li>repeat until convergence is achieved</li>
</ul>
</li>
</ol>
<h3 id="Calc---Integrals">Calc - Integrals<a class="anchor-link" href="#Calc---Integrals">¶</a></h3><p><strong>Fundamental Theorem of Calculus</strong><br/>
If f(x) is continuous, then the area under the curve for $x \in [a,b]$ is denoted and given by the definite integral.
$$\int_a^b f(x) dx = F(x)\bigg\rvert_a^b = F(b)-F(a)$$</p>
<p>Some Handy reminders</p>
<ul>
<li>$\int x^k dx = \frac{x^{k+1}}{k+1}+C, k \ne -1$</li>
<li>$\int \frac{1}{x} dx = ln|x| + C $</li>
<li>$\int e^x dx = e^x + C$</li>
<li>$\int cos(x) dx = sin(x) + C$</li>
<li>$\int \frac{1}{1+x^2} dx = arctan(x) + C$</li>
</ul>
<p>Some Handy properties include 
<img src="ISYE6644_images/w202.png" width="350"/>
<img src="ISYE6644_images/w203.png" width="350"/></p>
<p>Taylor Series Expansion of f(x) about a point a is given by<br/>
$$f(x)=\sum_{k=0}^{\infty} \frac{f^{(k)}(a)(x-a)^k}{k!}$$</p>
<p>Maclaurin series is just Taylor expanded around a=0</p>
<ul>
<li>$sin(x) = \sum_{k=0}^{\infty} \frac{(-1)^{k+1} x^{2k+1}}{(2k+1)!} $</li>
<li>$cos(x) = \sum_{k=0}^{\infty} \frac{(-1)^{k} x^{2k}}{(2k)!} $</li>
<li>$e^x = \sum_{k=0}^{\infty} \frac{x^k}{k!}$</li>
</ul>
<p>Finally recall L'Hopitals rule<br/>
<img src="ISYE6644_images/w204.png" width="350"/></p>
<h3 id="Calc---Numerical-Integration">Calc - Numerical Integration<a class="anchor-link" href="#Calc---Numerical-Integration">¶</a></h3><p>Used when a closed form of an integral doesn't exist. (ie no analytical solution can be found)</p>
<p>M1 - Riemann Summation</p>
<ul>
<li>Approximation of an integral of a function f(x) from a to b as the sum of areas of rectangles of width $\triangle x = (b-a)/n$ and height $f(x_i)$</li>
<li>$\int_a^b f(x) dx \approx \sum_{i=1}^n f(x_i) \triangle x = \frac{b-a}{n} \sum_{i=1}^n f(a + \frac{i(b-a)}{n})$</li>
<li>will converge to the integral as $n \to \infty$</li>
</ul>
<p>M2 - Trapezoid</p>
<ul>
<li>Very similar to the Riemann rectangular method, but it uses trapezoids instead.</li>
</ul>
<p>M3 - Monte Carlo Method</p>
<ul>
<li>Let $U_1,U_2,U_3,...,U_n$ be a sequence of Uniform(0,1) random Numbers</li>
<li>It can be shown that</li>
<li>$\int_a^b f(x) dx \approx \frac{b-a}{n} \sum_{i=1}^n f(a+(b-a)U_i)$</li>
<li>and again this becomes an equality as $n \to \infty$</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Probability">Probability<a class="anchor-link" href="#Probability">¶</a></h3><p>Conditional Probability is the probability of an Event A given some previous Event B has occured</p>
<ul>
<li>ie P(A|B) </li>
<li>Computed as $P(A \cap B)/P(B)$</li>
<li>Ex Let A={1,2,3} and B={3,4,5,6} then P(A|B) = 1/4</li>
</ul>
<p>A and B are termed Independent Events if $P(A \cap B) = P(A)P(B)$</p>
<p>A Random Variable X is a function from the sample space $\Omega$ to the real line. ie $X:\Omega \to \mathbb{R}$</p>
<ul>
<li>Discrete R.V. is one where the possible values of X are finite</li>
<li>Continuous R.V. is one where the probability is 0 at every individual point</li>
</ul>
<p>Well Known R.V.s</p>
<ul>
<li>Uniform(a,b) ( can be discrete or continuous )</li>
<li>Exponential$(\lambda)$ (continuous)</li>
<li>Normal($\mu,\sigma^2$) (continuous)</li>
</ul>
<p>Simulating R.V.s<br/>
Discrete</p>
<ul>
<li>if $U \sim \text{ Unif(0,1) }$ we can generate a Discrete RV by simply using the floor or ceiling function</li>
<li>ie $X \sim \lceil n U \rceil$</li>
<li>you can also think of this as just rounding up</li>
</ul>
<p><strong>Inverse transform sampling</strong> is a method for generating random numbers from any probability distribution by using its inverse cumulative distribution $F^{−1}(x)$. Recall that the cumulative distribution for a random variable $X$ is 
$ F_X(x)=P (X ≤ x)$. In what follows, we assume that our computer can, on demand, generate independent realizations of a random variable U uniformly distributed on [0,1].</p>
<p>Read More on wikipedia: <a href="https://en.wikipedia.org/wiki/Inverse_transform_sampling">https://en.wikipedia.org/wiki/Inverse_transform_sampling</a></p>
<p>Here's a Continuous example</p>
<ul>
<li>Suppose X is an exponential RV with $\lambda=2$, </li>
<li>thus the pdf is given by $p(x)=\lambda e^{\lambda x} = 2 e^{2x}$</li>
<li>with inverse of $F_X^{-1}(x) = - \frac{ln(1-x)}{2}$ ( just solve )</li>
</ul>
<p>A small example using R</p>
<div class="highlight"><pre><span></span><span class="n">num.samples</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="m">1000</span>
<span class="n">U</span><span class="w">           </span><span class="o">&lt;-</span><span class="w">  </span><span class="nf">runif</span><span class="p">(</span><span class="n">num.samples</span><span class="p">)</span>
<span class="n">X</span><span class="w">           </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">-</span><span class="nf">log</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">U</span><span class="p">)</span><span class="o">/</span><span class="m">2</span>

<span class="c1"># plot</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">freq</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">'X'</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s">'Generating Exponential R.V.'</span><span class="p">)</span>
<span class="nf">curve</span><span class="p">(</span><span class="nf">dexp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">rate</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Expectations">Expectations<a class="anchor-link" href="#Expectations">¶</a></h3><p>Definition of the expected value</p>
<p>$
E[X] = 
\begin{cases} 
  \sum_x x f(x)  \\
  \int_x x f(x)
\end{cases}
= \int_{\mathbb{R}} dF(X) \text{ we will use this as an abbreviation for the piecewise function }
$</p>
<p><strong>Example</strong>, Exponential($\lambda$)<br/>
$
f(x) = 
\begin{cases} 
  \lambda e^{-\lambda x} &amp; \text{ if x &gt; 0 }  \\
  0 &amp; \text{ otherwise }
\end{cases}
$</p>
<p>Integration by parts plus l'Hopital's Rule yields<br/>
$E[X] = \int_R x f(x) dx = \int_0^{\infty} x \lambda e^{-\lambda x} dx = \frac{1}{\lambda} $</p>
<p><strong>LOTUS: Law Of the Unconscious Statistician</strong><br/>
Suppose that h(X) is some function of the R.V. X,then<br/>
$
E[h(X)] = 
\begin{cases} 
  \sum_x h(x) f(x) &amp; \text{ X is discrete }  \\
  \int_x h(x) f(x) &amp; \text{ X is continuous }
\end{cases}
= \int_{\mathbb{R}} h(x) dF(X) 
$</p>
<p>Example</p>
<pre><code>Suppose X is a discrete R.V. with the following distribution
  x     2    3    4
f(x)  0.3  0.6  0.1

and let h(x) = x^3
Then 
E[X^3] = 8(0.3)+27(0.6)+64(0.1) = 25</code></pre>
<p>Similarly for $X \sim Uniform(0,2)$ we have $E[X^n] = \frac{2^n}{(n+1)}$</p>
<p><strong>Moment Generating Functions</strong></p>
<ul>
<li>N'th raw moment is given by $E[X^n]$ <ul>
<li>Expected value is the 1st moment)  </li>
</ul>
</li>
<li>N'th central moment is given by $E[(X-E[X])^n]$ <ul>
<li>Variance is the 2nd central moment</li>
<li>$Var(X)=E[(X-E[X])^2]=E[X^2]-(E[X])^2$</li>
</ul>
</li>
</ul>
<p>Examples</p>
<ol>
<li>For $X \sim Bernoulli(p)$<ul>
<li>$E[X]=p$</li>
<li>$Var[X]=p(1-p)$</li>
</ul>
</li>
<li>for $X \sim Exp(\lambda)$    <ul>
<li>$E[X^n] = \int_0^{\infty} x^n \lambda e^{-\lambda x} dx = n! / \lambda^n$</li>
<li>$V[X]=\frac{2}{\lambda^2} - (\frac{1}{\lambda^1})^2 = 1/\lambda^2$</li>
</ul>
</li>
</ol>
<p><strong>Theorem</strong> (proofs left as an exercise)</p>
<ul>
<li>$E[aX+b]=aE[X]+b$</li>
<li>$Var[aX+b]=a^2 Var(X)$</li>
</ul>
<p><strong>Definition</strong> Moment Generating Functions<br/>
$M_X(t)=E[e^{tX}]$ is the moment generating function (mgf) of the R.V. X<br/>
(Note that $M_X(t)$ is a function of t only!!)</p>
<p>Examples</p>
<ul>
<li>for $X \sim Bern(p)$ we have $M_X(t) = \sum_x e^{tx} f(x) = e^{t \cdot 1} p + e^{t \cdot 0} q = pe^t+q$</li>
<li>for $X \sim Exp(\lambda)$ we have $M_X(t) = \int e^{tx} f(x) = \lambda \int_0^{\infty} e^{(t-\lambda)x} dx = \lambda / (\lambda - t)$ when $\lambda &gt; t$</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Functions-of-an-R.V.">Functions of an R.V.<a class="anchor-link" href="#Functions-of-an-R.V.">¶</a></h3><p>Problem: Suppose we have an R.V. X with pdf f(x). However, we also have that Y = h(X). Then what is the pdf of Y?</p>
<p>Examples ( solution to be shown later )</p>
<ul>
<li>if $X \sim Normal(0,1)$ then $Y=X^2 \sim \chi^2(1)$</li>
<li>if $U \sim Uniform(0,1)$ then $Y=-(1/\lambda)ln(U) \sim Exp(\lambda) $</li>
</ul>
<p>Discrete Example:</p>
<pre><code>  x             0    1    2 
f(x)          1/4  1/2  1/4

y = x^3 - x     0    0    6</code></pre>
<p>This implies that g(0) = P(Y=0) = P(X=0 or 1) = 3/4 and g(6) = P(Y=6) = 1/4.</p>
<pre><code>g(y) = 3/4  if y = 0 
     = 1/4  if y = 6</code></pre>
<p>Suppose X has pdf $f(x)=|x|,-1 \le x \le 1$, and $Y=X^2$<br/>
Then<br/>
$
\begin{split}
G(y) &amp; = P(Y \le y) \\
&amp; = P(X^2 \le y) \\
&amp; = P(-\sqrt{y} \le X \le \sqrt{y}) \\
&amp; = \int_{-\sqrt{y}}^{\sqrt{y}} |x| dx \\
&amp; = y \text{ for } 0 \le y \le 1
\end{split}
$<br/>
Then the pdf of Y is $g(y)=G'(y)=1$ so $Y \sim Uniform(0,1)$</p>
<p><strong>Inverse Transform Theorem</strong><br/>
Suppose X is a continous random variable having cdf F(x). Then $F(X)\sim Uniform(0,1)$<br/>
$\begin{split}
P(Y \le y) &amp; = P(F(X) \le y)  \\
&amp; = P(X \le F^{-1}(y))  \\
&amp; = F(F^{-1}(y)) \\
&amp; = y
\end{split}$<br/>
This may seem trivial now but it is an extremely important result needed when we want to generate R.V.s during a simulation</p>
<p><strong>Example</strong> (Generating exponential RVs)<br/>
Suppose $X \sim Exp(\lambda)$, with cdf $F(x)=1-e^{-\lambda x}$ for x &gt; 0</p>
<p>Inverse Transform Theorem implies that $F(X)=1-e^{-\lambda x} \sim Uniform(0,1)$<br/>
So let $U = Unif(0,1)$ and set $F(X)=U$.<br/>
Then we have $X=\frac{-1}{\lambda} ln(1-U) \sim Exp(\lambda)$</p>
<p>For instance, if $\lambda=2, U=0.27$ then X = 0.157 is an Exp(2) instance.</p>
<p><strong>Example</strong><br/>
Suppose X has the Weibull distribution with cdf : $\large F(x)= 1 - e^{-(\lambda x)^\beta}, x &gt; 0$</p>
<p>Then solving for x we find that $\large X = \frac{1}{\lambda} [-ln(1-U)]^{1/\beta} $</p>
<p><strong>Bonus Theorem</strong><br/>
Here's another way to get the pdf of $Y=h(X)$ for some continuous function $h(\cdot)$<br/>
The cdf of Y is $\large F_Y(y) = P(Y \le y) = P(h(X) \le y) = P(X \le h^{-1}(y))$</p>
<p>By the chain rule ( and since a pdf must be $\ge 0$ ), the pdf of Y is<br/>
$\large f_Y(y) = \frac{d}{dy} F_Y(y) = f_X(h^{-1}(y)) |\frac{d}{dy} h^{-1}(y)| $</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Joint-PDFs">Joint PDFs<a class="anchor-link" href="#Joint-PDFs">¶</a></h3><p>Consider 2 RVs interacting together.</p>
<p>Then the joint cdf of X and Y is<br/>
$F(x,y)=P(X \lt x, Y \lt y) \text{ for all x,y } $</p>
<p><strong>Remark:</strong> The <em>marginal cdf</em> of X is $F_X(x) = F(x,\infty)$. We use the X subscript to remind us that it's just the cdf of X all by itself.) Similarly, the <em>marginal cdf</em> of Y is $F_Y(y) = F(\infty,y)$</p>
<p><strong>Definition:</strong> If X and Y are discrete then the joint pmf is $f(x,y) = P(X=x,Y=y) = \sum_x \sum_y f(x,y) = 1$<br/>
<strong>Remark:</strong></p>
<ul>
<li>The <em>marginal pmf</em> of X is $f_X(x) = P(X = x) = \sum_y f(x,y)$     </li>
<li>The <em>marginal pmf</em> of Y is $f_Y(y) = P(Y = y) = \sum_x f(x,y)$     </li>
</ul>
<p>For the continuous case change the summations to integrals and you're good to go.</p>
<p><strong>Example</strong><br/>
Consider $f(x,y) = \frac{21}{4} x^2 y, x^2 \le y \le 1$</p>
<p>Then the marginals pdf's are:<br/>
$\large f_X(x) = \int_{x^2}^1  \frac{21}{4} x^2 y dy = \frac{21}{8} x^2 ( 1 - x^4 ), -1 \le y \le 1 $</p>
<p><strong>Independence</strong><br/>
X and Y are <em>independent</em> RV's if $f(x,y) = f_X(x) f_Y(y), \forall x,y$</p>
<p>Example:<br/>
Let $f(x,y)=cxy$ for $0 \le x \le 2, 0 \le y \le 3$ Then X,Y are independent</p>
<p>Let $f(x,y)=\frac{21}{4} x^2 y \text{ for } x^2 \le y \le 1$ Then X,Y are not independent. 
Here the sticking point is the interval boundary for y depends on x.</p>
<p>Let $f(x,y) = \frac{c}{(x+y)} \text{ for } 1 \le x \le 2, 1 \le y \le 3$
Here the issue is the function itself, which cannot be factored into 2 multiplicative functions.</p>
<p><strong>Theorem:</strong> X and Y are independent if you can write their joint pdf as $f(x,y)=a(x)b(x)$</p>
<h3 id="Conditional-Expectations">Conditional Expectations<a class="anchor-link" href="#Conditional-Expectations">¶</a></h3><p><strong>Conditionality</strong><br/>
The conditional pdf of y given X=x is $f(y|x) = f(x,y)/f_X(x)$ ( assuming f_X(x) &gt; 0)<br/>
Similarly the conditional pdf of x given Y=y is $f(x|Y=y) = f(x,y)/f_Y(y)$ ( assuming f_Y(y) &gt; 0)</p>
<p><strong>Conditional Expectation:</strong><br/>
$
E[Y|X=x] = 
\begin{cases} 
  \sum_y y f(y|x) &amp; \text{ discrete }  \\
  \int_R y f(y|x) dy &amp; \text{ continuous }
\end{cases}
$</p>
<p>Example:<br/>
Let $f(x,y)=\frac{21}{4} x^2 y \text{ for } x^2 \le y \le 1$<br/>
Then $E[Y|x] = \int_R y f(y|x) dy = \int_{x^2}^1 \frac{2y^2}{1-x^4} dy = \frac{2}{3} \frac{1-x^6}{1-x^4}$</p>
<p><strong>Double Expectations</strong><br/>
$\large E[E(Y|X)]=E[Y]$</p>
<p>Proof<br/>
$
\begin{split}
E[E(Y|X)] 
&amp; = \int_R E(Y|x) f_X(x) dx &amp; \text{ by LOTUS}    \\
&amp; = \int_R \left( \int_R y f(y|x) dy \right) f_X(x) dx   \\
&amp; = \int_R y \int_R f(x,y) dx dy \\
&amp; = y f_Y(y) dy 
&amp; = E[Y]
\end{split}
$</p>
<p>Computing Probabilities using Conditioning<br/>
Let A be some event, and define the RV Y = 1 if A occurs; and Y = 0 otherwise.<br/>
Then $E[Y] = \sum_y y f_Y(y) = P(Y=1) = P(A) $</p>
<p>Similarly, for any RV X, we have<br/>
$E[Y|X=x] = \sum_y y f_Y(y|x) = P(Y=1|X=x) = P(A|X=x)$</p>
<p>Thus<br/>
$
\begin{split}
P(A) &amp; = E[Y]       \\
&amp; = E[E(Y|X)]       \\
&amp; = \int_R E[Y|X=x] dF_X(x) \\
&amp; = \int_R E[A|X=x] dF_X(x) \\
\end{split}
$</p>
<p>Example: Exponential Distribution<br/>
If $X \sim Exp(\mu)$ and $Y \sim Exp(\lambda)$, are independent RVs, then<br/>
$
\begin{split}
P(Y &lt; X) &amp; = \int_R P(Y &lt; x) f_X(x) dx  \\
&amp; = \int_0^{\infty} (1-e^{-\lambda x}) \mu e^{-\mu x}  \\
&amp; = \frac{\lambda}{\lambda + \mu}  \\
\end{split}
$</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Correlation-&amp;-Covariance">Correlation &amp; Covariance<a class="anchor-link" href="#Correlation-&amp;-Covariance">¶</a></h3><p><strong>Lotus in 2 Dimensions</strong><br/>
$
E[h(X,Y)] = 
\begin{cases}
\sum_x \sum_y h(x,y) f(x,y) \text{ if (X,Y) is discrete } \\
\int_x \int_y h(x,y) f(x,y) \text{ if (X,Y) is continuous } \\
\end{cases}
$</p>
<p><strong>Theorem</strong> $ E[X + Y]=E[X] + E[Y] $<br/>
<strong>Theorem</strong> $ Var[X + Y]=V[X] + V[Y] $ True if and only if X,Y are independent</p>
<p>Suppose $X_1,\cdots,X_n$ form a <em>random sample</em> from f(x) if all the $X_i$'s are independent, and each has the same pdf/pmf.<br/>
We can write that the $X_i$'s are independent and identically distributed, $X_1,\cdots,X_n \overset{iid}\sim f(x)$</p>
<p>Lemma:<br/>
Let $X_1,\cdots,X_n \overset{iid}\sim f(x)$<br/>
Then the sample mean is given by $\bar{X}_n = \sum X_i/n$<br/>
and the sample variance is given by $Var(\bar{X}_n) = Var(X_i)/n$</p>
<p><strong>Covariance</strong><br/>
$Cov(X,Y) = E[(X - E[X])(Y - E[Y])] = E[XY] - E[X]E[Y]$</p>
<ul>
<li>Observe that $Cov(X,X) = Var(X)$ )   </li>
<li>REMARK : Cov(X,Y)=0 does not imply that X,Y are independent<ul>
<li>Ex Let $X \sim Unif(-1,1)$ and $Y = X^2$</li>
<li>Then Cov(X,Y) = 0, but clearly Y depends on X</li>
</ul>
</li>
</ul>
<p><strong>Theorem</strong> Cov(aX,bY) = abCov(X,Y)<br/>
<strong>Theorem</strong></p>
<ul>
<li>Regardless of Independence<ul>
<li>Var(X + Y) = Var(X)+Var(Y)+2Cov(X,Y)</li>
<li>Var(X - Y) = Var(X)+Var(Y)-2Cov(X,Y) ( Note that you still add the variances )</li>
</ul>
</li>
</ul>
<p><strong>Correlation</strong><br/>
The <em>correlation</em> between X and Y is defined as<br/>
$\large \rho = \frac{Cov(X,Y)}{ \sqrt{Var(X)Var(Y)} }$</p>
<p><strong>Theorem</strong> $-1 \le \rho \le 1$</p>
<p>Example 1</p>
<pre><code>f(x,y)   X=2    X=3   X=4    f(y)
Y = 40   0.0    0.2   0.1    0.3
Y = 50   0.15   0.1   0.05   0.3
Y = 60   0.30   0.0   0.1    0.4
f(x)     0.45   0.3   0.25   1</code></pre>
<p>E[X] = 2.8 , E[Y] = 51<br/>
Var(X)=0.66, Var(Y) = 69<br/>
E[XY] = $\sum_x \sum_y xy f(x,y) = 140$</p>
<p>$\rho = -0.415$</p>
<p><strong>Example 2</strong><br/>
Consider two assets $S_1,S_2$, with expected returns $\mu_1,\mu_2$, variances $\sigma_1^2,\sigma_2^2, $, and $Cov(S_1,S_2)=\sigma_{12}$. We can then define a portfolio $P = wS_1+(1-w)S_2$ where $w \in [0,1]$. 
Then $E[P]=w\mu_1+(1-w)\mu_2$<br/>
And $Var[P]=w^2 \sigma_1^2 + (1-w)^2 \sigma_2^2 + 2w(1-w)\sigma_{12}$</p>
<p>Furthermore, if we set $\frac{d}{dw} Var(P) = 0$, we obtain the critical point that (hopefully) minimizes the variance of the portfolio $w = \frac{\sigma_2^2 - \sigma_{12}}{\sigma_1^2 + \sigma_2^2 - 2 \sigma_{12}}$</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Common-Distributions">Common Distributions<a class="anchor-link" href="#Common-Distributions">¶</a></h3><p>Bernoulli $X \sim Bernoulli(p)$<br/>
$
f(x) =
\begin{cases}
p \text{ if x = 1} \\
1-p \text{ if x = 0} \\
\end{cases}
$</p>
<ul>
<li>E[X] = p</li>
<li>Var[X] = p(1-p)</li>
<li>$M_X(t) = pe^t + q$</li>
</ul>
<p><strong>Binomial</strong> $Y \sim Binomial(n,p)$<br/>
If $X_1,\cdots,X_n \overset{iid}\sim Bern(p)$ ( ie N bernoulli trials )<br/>
then $Y = \sum_1^n X_i \sim Bin(n,p)$</p>
<p>$P(Y = y) = \binom{n}{y} p^y (1-p)^{n-y}$</p>
<ul>
<li>E[Y] = np</li>
<li>Var(Y) = npq</li>
<li>$M_Y(t) = (pe^t + q)^n$</li>
</ul>
<p><strong>Geometric</strong> $X \sim Geometric(p)$<br/>
$f(x) = q^{x-1} p, x=1,2,...$</p>
<ul>
<li>E[X] = 1/p   </li>
<li>Var(X) = q/p^2   </li>
<li>$M_X(t) = pe^t / (1-qe^t)$    </li>
</ul>
<p><strong>Negative Binomial</strong><br/>
$
\begin{equation}
NBin(r|p)=\left(\begin{array}{c}
y - 1 \\
r - 1
\end{array}\right)p^{r}(1-p)^{y-r}
\end{equation}
$</p>
<p><strong>Poisson</strong><br/>
$\large f(x) = \frac{e^{-\lambda} \lambda^x}{x!}$</p>
<ul>
<li>E[X] = $\lambda$</li>
<li>Var[X] = $\lambda$</li>
<li>$M_X(t) = e^{\lambda(e^t - 1)}$</li>
</ul>
<p><strong>Continuous Distributions</strong></p>
<ul>
<li>Uniform $\large X \sim N(a,b)\; f(x)=\frac{1}{b-a} \; \text{ for } a \le x \le b$       </li>
<li>Exponential $\large X \sim Exp(\lambda) \; f(x)=\lambda e^{-\lambda x}$     <ul>
<li>NB: Memoryless property $P(X &gt; s+t | X &gt; s) = P(X &gt; t)$    </li>
</ul>
</li>
<li>Gamma $\large X \sim Gamma(\alpha,\lambda) \; f(x) = \frac{\lambda^{\alpha} x^{\alpha-1} e^{-\lambda x}}{\Gamma(\alpha)}$<ul>
<li>where $\Gamma(\alpha) = \int_0^{\infty} t^{\alpha-1} e^{-t} dt$</li>
<li>Note also </li>
<li>if $X_1,X_2,\cdots,X_n \overset{iid}\sim Exp(\lambda)$      </li>
<li>then $Y = \sum_1^n X_i \sim Gamma(n,\lambda)$ ( Which is called an Erlang Distribution )<ul>
<li>$\large F_Y(y) = (1 - e^{- \lambda y}) \sum_0^{n-1} \frac{(\lambda y)^j}{j!} \; y \ge 0$</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The most famous of all - The Normal<br/>
$\large X \sim N(\mu,\sigma^2) \; f(x)=\frac{1}{\sqrt{2 \pi \sigma^2}} exp\left[\frac{-(x-\mu)^2}{2\sigma^2}\right] $</p>
<ul>
<li>$E[X] = \mu $</li>
<li>$Var(X) = \sigma^2 $</li>
<li>$M_X(t) = exp(\mu t + (1/2) \sigma^2 t^2)$</li>
</ul>
<p>Extremely Useful Properties<br/>
<strong>Theorem</strong> If $X_1,X_2$ are independent with $X_i \sim N(\mu_i,\sigma_i^2)$ then $ X_1 + X_2 \sim N(\mu_1 + \mu_2, \sigma_1 + \sigma_2)$</p>
<p><strong>Corollary (of a previous theorem)</strong></p>
<ul>
<li>If $X_1,\cdots,X_n \overset{iid}\sim N(\mu,\sigma^2)$     </li>
<li>Then the sample mean is $\bar{X}_n \sim N(\mu,\sigma^2 / n)$      <ul>
<li>This is telling us that as n grows large the variance becomes less and less variable</li>
</ul>
</li>
</ul>
<p><strong>Central Limit Theorem</strong><br/>
If $(X_1,X_2,\cdots,X_n) \overset{iid}\sim f(x)$ with mean $\mu$ and variance $\sigma^2$<br/>
Then $\large Z_n = \frac{\sum X_i - n \mu}{\sqrt{n}\sigma} = \frac{\sqrt{n}(\bar{X}_n - \mu)}{\sigma} \overset{d}\rightarrow N(0,1)$</p>
<p>In plain language: The cdf of any iid RVs will approach the normal as n increases</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Estimation">Estimation<a class="anchor-link" href="#Estimation">¶</a></h3><p><strong>Define:</strong> A <em>statistic</em> is a function of the observations $X_1,\cdots,X_n$ and not dependent on any unknown parameters<br/>
Examples: $\bar{X} = (1/n)\sum_i X_i$ or $S^2 = \frac{1}{n-1} \sum_i (X_i - \bar{X})^2$</p>
<p><strong>Define:</strong>  $T(\boldsymbol{X})$ is <em>unbiased</em> for $\theta$ if $E[T(\boldsymbol{X})] = \theta$</p>
<p>Example:</p>
<ul>
<li>Suppose $X_1,\cdots,X_n$ are iid anything with mean $\mu$    </li>
<li>Then $\large E[\bar{X}] = E\left[ \frac{1}{n} \sum X_i \right] = \frac{1}{n} \sum E[X_i] = E[X_i] = \mu$    </li>
<li>So $\bar{X}$ is always unbiased for $\mu$. That's why $\bar{X}$  is the sample mean
<strong>(Note that $\bar{X}$ being unbiased does not imply 1/$\bar{X}$ is unbiased)</strong> </li>
</ul>
<p>Example:</p>
<ul>
<li>Suppose $X_1,\cdots,X_n$ are iid anything with mean $\mu$ and variance $\sigma^2$      </li>
<li>Then $\large E[S^2] = E\left[ \frac{\sum (X_i - \bar{X})^2}{n-1} \right] = Var(X_i) = \sigma^2$</li>
<li>Thus $S^2$ is always unbiased for $\sigma^2$, this is why $S^2$ is called the sample variance.</li>
</ul>
<p>Example:<br/>
Suppose that $X_1,\cdots,X_n \overset{iid}\sim Unif(0,\theta)$<br/>
Consider two estimators: $Y_1 = 2\bar{X}$ and $Y_2 = 2\frac{n+1}{n} max(X_i,1\le i \le n)$</p>
<p>Since $E[Y_1] = 2 E[\bar{X}] = 2 E[X_i] = \theta$ we can see that $Y_1$ is unbiased for $\theta$
$Y_2$ also unbiased but this is more difficult to determine</p>
<p>Thus<br/>
$
\begin{split}
P(M \le y) &amp; = P(X_1 \le y,\cdots, X_n \le y)       \\
&amp; = \prod_i P(X_i \le y)  \\
&amp; = [P(X_1 \le y)]^2      \\
&amp; = [\int_0^y f_{X_1}]^n  \\
&amp; = [\int_0^y 1/\theta]^n \\
&amp; = (y/\theta)^n
\end{split}
$</p>
<p>Which implies that the pdf of M is $\large f_M(y) = \frac{d}{dy} (y/\theta)^n = \frac{ny^{n-1}}{\theta^n}$</p>
<p>Now we can compute<br/>
$E[M] = \int_0^{\theta} y f_M(y) dy = \int_0^{\theta} \frac{ny^n}{\theta^n} = \frac{n\theta}{n+1}$</p>
<p>This tells us that $Y_2$ is also biased, so which is better? It turns out that $Y_2$ is best because it has a lower variance.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M3-Basic-Simulation">M3-Basic Simulation<a class="anchor-link" href="#M3-Basic-Simulation">¶</a></h2><p>This module will go through a bunch of simulation examples that you can do by hand.</p>
<p>Topics</p>
<ol>
<li>Solving a differential equation</li>
<li>Monte Carlo integration</li>
<li>Making some pi</li>
<li>Single-server queue</li>
<li>(s,S) inventory system</li>
<li>Simulating random variables</li>
<li>Spreadsheet simulation</li>
</ol>
<p>Recall: If $f(x)$ in continuous, then it has the derivative<br/>
$\frac{d}{dx}f(x) = f'(x) = \underset{x\to\infty}\lim \frac{f(x+h) - f(x)}{h} $<br/>
If the limit exists and is well-defined for any given x. Think of the derivative as the slope of the function</p>
<p>So for a small h<br/>
$f'(x) \approx \frac{f(x+h) - f(x)}{h}$ and $f(x+h) \approx f(x) + h f'(x)$</p>
<p><strong>Example</strong><br/>
Suppose you have a differential equation of a population growth model, $f'(x) = 2f(x)$ and suppose we know that $f(0)=10$. Then we can approximate the equation using the above equations</p>
<p>Observe that:<br/>
$f(x+h) \approx f(x) + h f'(x) = f(x) + h(2f(x)) = f(x)(1+2h)$</p>
<p>Similarly<br/>
$f(x+2h)=f((x+h)+h) \approx (1+2h)f(x+h)\approx(1+2h)^2 f(x)$<br/>
Thus $f(x+ih)\approx(1+2h)^i f(x)$ for i=0,1,2,...</p>
<p>So for f(0) and h=0.01 we have $f(0.01i) \approx 10(1.02)^i$</p>
<pre><code> 0   0.01   0.02   0.03   0.04 ...  0.10
10  10.20  10.40  10.61  10.82 ... 12.19   simulation using above
10  10.20  10.41  10.62  10.83 ... 12.21   this is real value, turns out f(x)=e^2x - we hid this fact to illustrate</code></pre>
<h3 id="Integration">Integration<a class="anchor-link" href="#Integration">¶</a></h3><p>The function F(x) having derivative f(x) is called the antiderivative. The antiderivative is denoted $F(x) = \int f(x) dx$ and this is also called the indefinite integral of f(x).</p>
<p><strong>Fundamental Theorem of Calculus</strong><br/>
If $f(x)$ is continuous, then the area under the curve for $x \in [a,b]$ is denoted and given by the definite integral<br/>
$\large \int_a^b f(x) dx =  F(x) |_a^b = F(b) - F(a)$</p>
<h3 id="Monte-Carlo-Integration">Monte Carlo Integration<a class="anchor-link" href="#Monte-Carlo-Integration">¶</a></h3><p>Let the integral $\large I = \int_a^b g(x) dx = (b-a) \int_0^1 g(a+(b-a)u)du$ where u = (x-a)/(b-a)</p>
<p>Suppose $U_1,U_2,\cdots \overset{iid}\sim Uniform(0,1)$
and we define $I_i = (b-a)g(a+(b-a)U_i)$ for i = 1,2,...,n</p>
<p>We can use the sample average as an estimator for I:<br/>
$\large \bar{I}_n = \frac{1}{n} \sum I_i = \frac{b-a}{n} \sum_1^n g(a+(b-a)U_i)$<br/>
Turns out that, due to the law of large numbers, if an estimator is asymptotically unbiased and it's variance goes to zero, then things are good.</p>
<p>Consider, by LOTUS:<br/>
$ 
\begin{split}
E[\bar{I}_n] &amp; = (b-a)E[g(a+(b-a)U_i)] \\
&amp; = (b-a) \int_R g(a+(b-a)u) f(u) du   \\
&amp; = \text{ where f(u) is the Uniform(0,1) pdf} \\
&amp; = (b-a) \int_0^1 g(a+(b-a)u) du \\
&amp; = I
\end{split}
$
So $\bar{I}_n$ is unbiased for I</p>
<p>Since it can also be shown that Var($\bar{I}_n) = O(1/n)$ the LLN implies that $\bar{I}_n \to I \text{ as } n \to \infty$<br/>
Furthermore, by CLT we also have that $\bar{I}_n \approx N(E[\bar{I}_n], Var[\bar{I}_n]) \sim N(I,Var[I_n]/n)$<br/>
Which suggests a $100(1-\alpha)\%$ confidence interval<br/>
$I \in \bar{I}_n \pm z_{\alpha/2} \sqrt{S_I^2/n}$<br/>
Where $z_{\alpha/2}$ is the usual standard normal quantile<br/>
$S_I^2 = \frac{1}{n-1} \sum_i^n (I_i - \bar{I}_n)^2$</p>
<p><strong>Example:</strong></p>
<p>Suppose $I = \int_0^1 sin(\pi x) dx$ ( furthermore suppose you don't know the actual answer :))<br/>
Take 4 Uniform(0,1) observations say, 0.79  0.11  0.68  0.31<br/>
Since $I_i = (b-a)g(a+(b-a)U_i) = g(U_i) = sin(\pi U_i)$<br/>
We obtain $\bar{I}_n = \frac{1}{4} \sum I_i = \frac{1}{4} \sum sin(\pi U_i) = 0.656$<br/>
( The real answer is $2/\pi$ which is 0.6366, so it's pretty good )</p>
<p>Furthermore a 95% confidence interval for I is $I \in 0.656 \pm 1.96 \sqrt{0.0557/4}$ and it gets better as n increases!!</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="MCI---Example-1">MCI - Example 1<a class="anchor-link" href="#MCI---Example-1">¶</a></h3><p>Let's try computing pi using Monte Carlo Integration as described above</p>
<p><strong>Problem</strong> Consider a unit square (with area one). Inscibed in the square is a circle with radius 1/2, thus the area of the circle is $\pi/4$. We will throw darts at the square. We expect that the probability of the dart landing in the circle is $\pi/4$. We will use this to compute $\pi$, or at least estimate it.</p>
<p><strong>How</strong> Toss n darts at the square and calculate the proportion $\hat{p}_n$ that land in the circle. Then an estimate for $\pi$ is $\hat{\pi}_n = 4 \hat{p}_n$ which converges to $\pi$ as n becomes large by the Law of large numbers LLN</p>
<p>To simulate a dart toss let $U_1,U_2 \overset{iid}\sim Unif(0,1)$. Then $(U_1,U_2)$ represents the random position of the dart on the unit square.</p>
<p>A success is when $(U_1 - 1/2)^2 + (U_2 - 1/2)^2 \le 1/4$</p>
<p><strong>Implementation</strong></p>
<ul>
<li>Choose your favourite spreadsheet</li>
<li>Column 1 : pick a random number between 0,1 (=RAND()) call this col $U_1$</li>
<li>Column 2 : pick a random number between 0,1 (=RAND()) call this col $U_2$</li>
<li>Column 3 : now take the sum of each column less 1/2 and squared</li>
<li>Column 4 : if Col 3 &gt; 1/4 then 0 else 1</li>
<li>Drag rows to your hearts content ( number of tosses )</li>
</ul>
<p>Finally just sum(col4)/count(col4). As the number of tosses, represented by rows, gets larger your estimation will get better. Remember to multiply by 4!! to get $\pi$ since the area of the circle is $\pi/4$</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="MCI---Example-2">MCI - Example 2<a class="anchor-link" href="#MCI---Example-2">¶</a></h3><p><strong>Problem</strong> Customers arrive at a single server queue with iid interarrival times and iid servie times. Customers must wait in a FIFO, first in first out line, if the server is busy. We want to estimate the expected customer wait time, and the expected number of people in the system (queue), as well as the server utilization.</p>
<p><strong>Parameters</strong></p>
<ul>
<li>Interarrival time between customer $i-1$, and $i$ is $I_i$, this is the amount of time between two arrivals</li>
<li>Customer i's arrival time is $A_i = \sum_1^i I_j$, this is the time the i'th customer arrives/enters the system</li>
<li>Customer i's service start time is $T_i = max(A_i,D_{i-1})$, where $D_{i-1}$ would be the departure time of the previous customer</li>
<li>Customer i's waiting time $W_i^Q = T_i - A_i$, no surprise here it's just the length of time it takes for service to start</li>
<li>Customer i's time in the system $W_i^Q = D_i - A_i$, no surprise it's just their departure time less arrival time</li>
<li>Customer i's service time is $S_i$</li>
<li>Customer i's departure time is $D_i = T_i + S_i$</li>
</ul>
<p>Small example</p>
<pre><code>i | I_i  A_i  | T_i W^Q S_i | D_i
1 |   3    3  |   3   0   7 |  10
2 |   1    4  |  10   6   6 |  16
3 |   2    6  |  16  10   4 |  20
4 |   4   10  |  20  10   6 |  26
5 |   5   15  |  26  11   1 |  27
6 |   5   20  |  27   7   2 |  29

NB sum(W^Q)/6 = 7.33 = Avg wait time for this simulation with six customer</code></pre>
<p>The expected number of people at any time in the system is a bit trickier.<br/>
We can integrate over L(t)<br/>
<img src="ISYE6644_images/w301.png" width="400"/></p>
<p>Or more easily is taking the average over $D_i - A_i$<br/>
$
\begin{split}
\bar{L} &amp; = \frac{\text{total person-time in system}}{29}  \\
&amp; = \frac{\sum_1^6 (D_i - A_i)}{29} \\
&amp; = \frac{7+12+14+16+12+9}{29} \\
&amp; = \frac{70}{29} \approx 2.41 \\
\end{split}
$</p>
<p>Finally to get estimated server utilization time we take time busy / total time ie $\hat{\rho} = 26/29$. Note that for the first three units of time the server is free.</p>
<p>What about a LIFO system? Last in first out?? 
We can re-use our example above<br/>
Some columns remain the same $i \; I_i \; A_i \; S_i $
but this time some columns change such as $T_i \; W_i^Q $</p>
<pre><code>i | I_i  A_i  | T_i W^Q S_i | D_i
1 |   3    3  |   3   0   7 |  10
2 |   1    4  |  23  19   6 |  29
3 |   2    6  |  17  11   4 |  21
4 |   4   10  |  10   0   6 |  16
5 |   5   15  |  16   1   1 |  17
6 |   5   20  |  21   1   2 |  23

Now sum(W^Q)/6 = 5.33 is the avg wait time
And 58/29 = 2 is the avg number of people in the system</code></pre>
<p>Comparing each example suggests that a LIFO is a better approach.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="MCI---Example-3">MCI - Example 3<a class="anchor-link" href="#MCI---Example-3">¶</a></h3><p>Let's now consider a more complex (s,S) inventory system</p>
<p><strong>Constraints</strong></p>
<ul>
<li>A Store sells a product at $d per unit</li>
<li>Store policy says we should have "at least" s units at the start of each day</li>
<li>if inventory at end of day is less than s then we must order enough to get back to S by the beginning of the next day</li>
<li>there are various costs in the system</li>
</ul>
<p><strong>Parameters</strong><br/>
Let $I_i$ denote the inventory at the end of day i, and let $Z_i$ denote the order that we place at the end of the day i.<br/>
Clearly<br/>
$Z_i = 
\begin{cases}
S - I_i &amp; \text{ if } I_i &lt; s \\
0 &amp; \text{ otherwise }
\end{cases}
$</p>
<p>Extra Details</p>
<ul>
<li>If an order is placed to the supplier at the end of day i, it costs the store $K+cZ_i$. </li>
<li>It costs \$h per unit for the store to hold unsold inventory overnight</li>
<li>There is also a penalty cost of \$p per unit if demand can't be met   </li>
<li>No backlogs are allowed   </li>
<li>Demand on day i is $D_i$</li>
</ul>
<p>How much money does the store make on day i????
<img src="ISYE6644_images/w302.png" width="400"/></p>
<p>Let d=10; s=3; S=10; K=2; c=4; h=1; p=2<br/>
Consider</p>
<ul>
<li>Demand sequence $D_1=5 \; D_2=2 \; D_3=8 \; D_4=6 \; D_5=2 \; D_6=1 \;$     </li>
<li>Initial stock of $I_0 + Z_0 = 10$</li>
</ul>
<p><img src="ISYE6644_images/w303.png" width="400"/></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="MCI---Example-4">MCI - Example 4<a class="anchor-link" href="#MCI---Example-4">¶</a></h3><p><strong>Discrete Uniform:</strong></p>
<ul>
<li>Consider a D.U. on ${1,2,\cdots,n}$ ie $X=i$ with probability 1/n for i=1,2,...,n.<ul>
<li>for this could just be an n-sideed dice toss</li>
</ul>
</li>
<li>If $U \sim Unif(0,1)$, we can obtain a D.U. Random Variate simply by setting $X=\lceil nU \rceil$     <ul>
<li>where $\lceil \cdot \rceil$ is the ceiling or round up function    </li>
</ul>
</li>
</ul>
<p><strong>Another Discrete Uniform</strong><br/>
$
P(X=x)
\begin{cases}
0.25 &amp; \text{ if } x=-2   \\
0.10 &amp; \text{ if } x=3    \\
0.65 &amp; \text{ if } x=4.2  \\ 
0    &amp; \text{ otherwise } \\
\end{cases}
$</p>
<p>We can't use a die toss to simulate this random variable. Instead, we use the inverse transform method.</p>
<pre><code> x   f(x)  P(X&lt;=x)   Unif(0,1)
-2   0.25     0.25  [0.00,0.25]
 3   0.10     0.35  (0.25,0.35]
 4.2 0.65     1.00  (0.35,1.00)</code></pre>
<ul>
<li>Sample $U \sim Unif(0,1)$. </li>
<li>Choose the corresponding x-value (ie $X=F^{-1}(U)$).<ul>
<li>EX U=0.46 means that X=4.2</li>
</ul>
</li>
</ul>
<p>Now we'll use the inverse transform method to generate a continuous RV. We'll talk about the following result a little later</p>
<p><strong>Theorem</strong> If X is a continuous RV with CDF F(x), then the R.V. $F(X) \sim Unif(0,1)$.<br/>
This suggests a way to generate realizations of the R.V. X. Simply set $F(X)=U \sim Unif(0,1)$ and solve for $X=F^{-1}(U)$</p>
<p>Example:<br/>
Suppose $X \sim Exp(\lambda)$. Then $F(x)=1-e^{-\lambda x} \; for \; x \gt 0$<br/>
So Set $F(X)=1-e^{-\lambda X} = U$<br/>
Now solve for X, $X = \frac{-1}{\lambda} ln(1-U) \sim Exp(\lambda)$</p>
<p><strong>Ex: Generating Uniforms</strong> The above RV generation Examples required us to generate pratically independent and identically distributed (iid) Unif(0,1) RV's. In excel for example the '=RAND()' function generates Uniform(0,1).</p>
<p>Here's an algorithm to generate pseudo-random numbers (PRNs) of deterministic numbers that appear to be iid U(0,1).</p>
<ul>
<li>Pick a seed integer $X_0$</li>
<li>Let $X_i = 16807 X_{i-1} mod(2^31 - 1) \; for \; i=1,2,\cdots$</li>
<li>then set $R_i = X_i / mod(2^31 - 1) \; i=1,2,\cdots$</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M4-Simulation-Basics">M4-Simulation Basics<a class="anchor-link" href="#M4-Simulation-Basics">¶</a></h2><p>Goal: To Understand the nutbolts of simulation.</p>
<p>Objective:</p>
<ol>
<li>Steps in a simulation study</li>
<li>Useful Definitions</li>
<li>Simulation clock advance mechanisms</li>
<li>Two modeling approaches for simulations</li>
<li>Simulation Languages</li>
</ol>
<h3 id="Simulation-Steps">Simulation Steps<a class="anchor-link" href="#Simulation-Steps">¶</a></h3><p><strong>Problem Formulation</strong> statement of problem.</p>
<ul>
<li>Profits are too low. What to do?</li>
<li>Customers are complaining about the long lines. Help!</li>
</ul>
<p><strong>Objectives and Planning</strong> what specific questions to answer?</p>
<ul>
<li>How many workers to hire?</li>
<li>How much buffer space to insert in the assembly line?</li>
</ul>
<p><strong>Model Building</strong> both an art and science.</p>
<ul>
<li>M/M/k queueing model?</li>
<li>Need physics equations?</li>
</ul>
<p><strong>Data Collection</strong> what kinds of data, how much?</p>
<ul>
<li>Continuous? Discrete?</li>
<li>What exactly should be collected?</li>
<li>Budget considerations.</li>
</ul>
<p><strong>Coding</strong> decide on language, write program</p>
<ul>
<li>Modeling paradigm<ul>
<li>Event-Scheduling</li>
<li>Process-Interaction</li>
</ul>
</li>
<li>100s of languages out there</li>
</ul>
<p><strong>Verification</strong> Is code OK? If not, go back to 5 (Coding).</p>
<p><strong>Validation</strong> Is model OK? If not, go back to 3 (Modeling) and 4 (Data Collection)</p>
<p><strong>Experimental Design</strong> what experiments need to be run to efficiently answer our questions?</p>
<ul>
<li>Statistical considerations</li>
<li>Time / budget</li>
</ul>
<p><strong>Run Experiments</strong></p>
<ul>
<li>press the “go” button and make your production runs, often substantial. </li>
<li>May require a lot of time.</li>
</ul>
<p><strong>Output Analysis</strong> statistical analysis, estimate relevant measures of performance</p>
<ul>
<li>Often iterative with 8 (Experimental Design) and 9 (Production Runs)</li>
<li>Almost always need more runs</li>
</ul>
<p><strong>Make Reports</strong> Implement, and Make Management Happy</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Definitions-and-terminology">Definitions and terminology<a class="anchor-link" href="#Definitions-and-terminology">¶</a></h3><p><strong>System</strong> is a collection of entities (people, machines, etc.) that interact together to accomplish a goal.</p>
<p><strong>Model</strong> is an abstract representation of a system, usually containing math, and/or logical relationships describing the system in terms of states, entities, sets, events, etc. (terms that we’ll define below).</p>
<p><strong>System state</strong> A set of variables that contains enough information to describe the system. Think of the state as a “snapshot” of the system.<br/>
E.g., in a single-server queue, all you might need to describe the state are:</p>
<ul>
<li>$L_Q(t)$ = # of people in queue at time t</li>
<li>$B(t)$ = 1/0 if server is busy/idle at time t.</li>
</ul>
<p><strong>Entities</strong> can be permanent (like a machine) or temporary (e.g., customers), and can have various properties or attributes (e.g.,  priority of a customer or average speed of a server).</p>
<p><strong>list (or queue)</strong> is an ordered list of associated entities (for instance, a linked list, or a line of people).</p>
<p><strong>Event</strong> is a point in time at which the system state changes (and which can’t be predicted with certainty beforehand).<br/>
Examples:</p>
<ul>
<li>an arrival event    </li>
<li>a departure event    </li>
<li>a machine breakdown event  </li>
</ul>
<p>“Event” technically means the time that a thing happens, but loosely refers to “what” happens (an arrival).</p>
<p>An <strong>activity</strong> is a duration of time of specified length (aka an unconditional wait).<br/>
Examples include:</p>
<ul>
<li>exponential customer interarrival times</li>
<li>constant service times </li>
<li>We can explicitly generate those events, so they are “specified”.</li>
</ul>
<p>A <strong>conditional wait</strong> is a duration of time of unspecified length.<br/>
E.g., a customer waiting time</p>
<ul>
<li>we don’t know that directly. </li>
<li>In fact, we just know arrival and service times and will use those to reverseengineer the waiting times.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Time-Advance-Mechanisms">Time Advance Mechanisms<a class="anchor-link" href="#Time-Advance-Mechanisms">¶</a></h3><p>We’ll discuss the simulation clock and how this is used to move the simulation along as time progresses.</p>
<p><strong>Definitions</strong><br/>
The simulation clock is a variable whose value represents simulated time (which doesn’t equal real time).<br/>
Time-Advance Mechanisms — how does the clock move? Always moves forward (never goes back in time).</p>
<p>Two ways:</p>
<ul>
<li>Fixed-Increment Time Advance</li>
<li>Next-Event Time Advance</li>
</ul>
<p><strong>Fixed-Increment Time Advance</strong><br/>
In this situation we will update the state of the system at fixed times, nh, for n = 0,1,2,…, where h is chosen appropriately. This is used in continuous-time models (e.g., differential equations) and models where data are only available at fixed times (e.g., at the end of every month).</p>
<p>We will not use this in this course!!</p>
<p><strong>Next-Event Time Advance</strong><br/>
In this scenario the clock is initialized at 0. All known future event times are determined and placed in the future events List (<strong>FEL</strong>), ordered by time. The clock advances to the most imminent event, then to the next most imminent event, etc. At each event, the system state and FEL are updated.</p>
<p>The system state can only change at event times. Nothing really happens between events. The simulation progresses by sequentially executing (dealing with) the most imminent event on the FEL.</p>
<p>What do we mean by “dealing with”? The system state is updated, depending on what type of event it is (arrival, departure, etc.). For example, if it’s an arrival event, you may have to turn on an idle server, or add a new customer to the queue of a busy server. Now Update the FEL!</p>
<p>What do we mean by “updating the FEL”? Any time there’s an event, the simulation may update the chronological order of the FEL’s events by</p>
<ul>
<li>inserting new events,</li>
<li>deleting events,</li>
<li>moving them around, or</li>
<li>doing nothing</li>
</ul>
<p>Example:<br/>
      After guy arrives at a queue, typical simulation programs will immediately spawn the next arrival time. If this arrival time is significantly far enough in the future, we’ll simply put it at the “end” of the FEL (in terms of ordered execution times of the events).</p>
<p>      If that next arrival turns out to happen before another event, e.g., a slow server finishing his current customer, then that next arrival must be inserted in the interior of the FEL (in terms of ordered execution times).</p>
<p>      What if the arrival is a nasty looking guy, and a number of customers currently in line get 
disgusted and leave or switch to other lines? Then you have to delete or move entries in the FEL</p>
<p>To do this we will need efficient list processing (e.g., linked lists) for the FEL.</p>
<ul>
<li>Singly and doubly linked lists intelligently store the events in an array that allows the chronological order of the events to be accessed.</li>
<li>Such lists easily accommodate insertion, deletion, switching of events, etc.</li>
<li>Take a Computer Science course to learn more.</li>
</ul>
<p>Be careful about events that take place at the same time, e.g., a guy shows up at the same time that another guy finishes getting served. Simply establish ground rules for how to deal with ties. Every discrete-event simulation language maintains a FEL somewhere deep in its cold, cold heart.</p>
<p>Most commercial simulation packages take care of the FEL stuff for you, so you don’t have to mess around at all with FEL logic.</p>
<p><strong>EXAMPLE:</strong><br/>
Next-Event Time Advance Example (adapted from BCNN): Consider the usual single-server FIFO queue that will process exactly 10 customers.<br/>
The arrival times and service times are:</p>
<pre><code>Customer       1   2   3   4   5   6   7   8   9  10
Arrival Time   1   3   4  10  17  18  19  20  27  29
Service Time   5   4   1   3   2   1   4   7   3   1</code></pre>
<p>Let's create a table with entries for event time, system state, queue, FEL, and cumulative statistics (total server busy time and cust system time).</p>
<p>A denotes an arrival and D a departure (e.g., 2A is customer 2’s arrival). Services have priorities over arrivals in terms of updating the FEL: break ties by handling a service completion first — get those guys out of the system!</p>
<pre><code>Clock     System State    Queue          FEL                Cumululative Stats (times)
   t      Lq(t)   B(t)    Cust,arrTime   event time,type    Busy   TimeInSystem
   0       0      0       0                 (1,1A)           0        0
   1       0      1       0              ( 3,2A),(6 ,1D)     0        0
   3       1      1       (2,3)          ( 4,3A),(6 ,1D)     2        2
   4       2      1       (2,3),(3,4)    ( 6,1A),(10,4D)     3        4
   6       1      1       (3,4)          (10,2D),(10,4D)     5       10
   10      0      1       0              (10,4A),(11,3D)     9       18
   ............</code></pre>
<p>Recall 
Lq(t) = number of people in the system 
 B(t) = Server busy</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="General-Modelling">General Modelling<a class="anchor-link" href="#General-Modelling">¶</a></h3><p>Two Modeling Approaches</p>
<p>Last Time: Discussed the FEL and how time flies in a discrete-event simulation.<br/>
This Time: We’ll look at two highlevel simulation modeling approaches.</p>
<p>The “process-interaction” approach will be used to model complicated simulation processes. There is also an alternative approach called “Event Scheduling”.</p>
<p><strong>Event Scheduling</strong>
This is really complex. Google it</p>
<p>Most commercial applications use Process Interaction (PI)</p>
<p>How would we handle such a generic model in a PI language (like Arena)?<br/>
All you do is:</p>
<ul>
<li>Create customers every once in a while.</li>
<li>Process (serve) them, maybe after waiting in line.</li>
<li>Dispose of the customers after they’re done being processed.</li>
</ul>
<h3 id="Simulation-Languages">Simulation Languages<a class="anchor-link" href="#Simulation-Languages">¶</a></h3><p>More than 100 commercial languages in the ether.</p>
<ul>
<li>Examples (sort of from low- to highlevel): FORTRAN, SIMSCRIPT, GPSS/H, Extend, Arena, Simio, Automod, AnyLogic</li>
<li>5–10 major players at schools</li>
<li>Huge price range from &lt;\$1,000 – \\$100,000?</li>
</ul>
<p>But there’s also some Freeware available!</p>
<ul>
<li>Several nice packages in Java, Python (e.g., SimPyl).</li>
<li>Little bit higher learning curve, but not too bad.</li>
</ul>
<p>When selecting a language, you should take into account:</p>
<ul>
<li>Cost considerations: \$$, learning curve, programming costs, runtime costs, etc.</li>
<li>Ease of learning: documentation, syntax, flexibility</li>
<li>World view: E-S, P-I, continuous models, combination</li>
<li>Features: RV generators, stats collection, debugging aids, graphics, user community</li>
</ul>
<p>Where to learn simulation languages?</p>
<ul>
<li>Here (nice to have you here!)</li>
<li>Textbooks (especially in conjunction with this class)</li>
<li>Conferences such as the Winter Simulation Conference</li>
<li>Vendor short courses (at a potentially steep cost)</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Arena">Arena<a class="anchor-link" href="#Arena">¶</a></h2><p>We move to the design and analysis of dynamic systems that evolve over time.</p>
<ul>
<li>We’ll use Arena, from Rockwell Software – one of several popular “discrete-event” simulation packages.</li>
<li>Free Arena download available at : <a href="https://www.arenasimulation.com/academic/students">https://www.arenasimulation.com/academic/students</a></li>
</ul>
<h2 id="M5Pt1-ARENA-intro">M5Pt1-ARENA intro<a class="anchor-link" href="#M5Pt1-ARENA-intro">¶</a></h2><p>Some Handy Tutorials</p>
<ul>
<li><a href="https://shamsulsarip.files.wordpress.com/2015/07/arena-tutorial.pdf">https://shamsulsarip.files.wordpress.com/2015/07/arena-tutorial.pdf</a></li>
<li><a href="https://uh.edu/~lcr3600/simulation/models.html">https://uh.edu/~lcr3600/simulation/models.html</a></li>
</ul>
<p>Topics:</p>
<ul>
<li>Introductory</li>
<li>Modeling multi-channel systems (network like)</li>
<li>Call-centre model</li>
<li>Misc Model demos</li>
</ul>
<h3 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">¶</a></h3><p><strong>Process-Interaction</strong><br/>
Recall that PI approach was mentioned in a previous module. Basically it's just a flowchart!.</p>
<p>Consider a generic customer <strong>entity</strong> and the sequence of events and activities <strong>processes</strong> it undergoes as it moves through the system. At the same time the system may have entities competing with each other as the compete for resources, aka processes. Arena takes this process-interaction world view. The entities flow through a network of modules (blocks) that describe their behaviour. The network can be represented as a process flowchart.</p>
<p>Example People show up at a barber shop, get served, perhaps after waiting in line, and then leave.<br/>
In Arena:</p>
<ul>
<li>Create (to generate customer arrivals)</li>
<li>Process (use the barber)</li>
<li>Dispose (customer leaves the barber )</li>
</ul>
<p><img src="ISYE6644_images/w401.png" width="400"/></p>
<p><strong>Getting Arena</strong></p>
<p>Just go to Rockwell's website or google arenasimulation. Get the student version. It's not fully functional but it will suffice to provide the needed ability to learn most of the basic.</p>
<p>Quick Overview:</p>
<ul>
<li>File: Lets you do the usual New, Open, Close, Save,…, <ul>
<li>but also allows you to import different template panels and background pix.</li>
</ul>
</li>
<li>Edit: Allows you to edit entity pix, insert objects, other nice stuff.</li>
<li>View: See various toolbars, customize your “named views”, etc.</li>
<li>Tools: Lots of cool toys, including Input Analyzer, OptQuest, AVI capture, macros,…</li>
<li>Arrange, Object, Window: Various visualization aids.</li>
<li>Run: Set a run up and make it go as fast as you want or step-bystep</li>
</ul>
<p>Basic Process Template: Is a panel on the left hand side of Arena (old version). In Newer versions of Arena they've categorized the modules/blocks into similarity like panels. For example under Discrete processing you'll find the Create-Process-Dispose modules.</p>
<p>For our purposes we will focus on the modules in the Basic Process Template</p>
<ul>
<li>Modules: Create, Dispose, Process, Decide, etc etc</li>
<li>Data: Attribute, Entity, Queue, Resource, Schedule, Set, Picture</li>
</ul>
<p>For more advanced templates go to File &gt; Attach and pick a different template</p>
<p>Let's delve into the Create-Process-Dispose process-interaction</p>
<ul>
<li>Create: Periodically generates customer arrivals</li>
<li>Process: Have work performed on the customers; (maybe wait in line, or possibly self service)</li>
<li>Dispose: Customers leave the system after service</li>
</ul>
<p>If you double click on a module, in the model editor, you will see it's properties.</p>
<p>Create has fields for</p>
<ul>
<li>The name of the module</li>
<li>The type of entity (customer)</li>
<li>Interarrival distribution</li>
<li># of customers per arrival</li>
<li>Maximum # of arrivals allowed</li>
<li>Time that the first guy shows up</li>
</ul>
<p>Process module has fields for</p>
<ul>
<li>The name of the module</li>
<li>Type of action. This is where you can try to reserve a server or free a server who’s currently in use. <ul>
<li>More on this in next lesson.</li>
</ul>
</li>
<li>How long will you be delayed?<ul>
<li>I.e., what is the service time?</li>
</ul>
</li>
</ul>
<p>Dispose module</p>
<ul>
<li>Nothing deep here – you just get rid of entities.</li>
<li>You can name the module.</li>
</ul>
<p><strong>Seize-Delay-Release</strong></p>
<p>You'll take one of the following “actions” in the Process module:</p>
<ul>
<li>Delay: <ul>
<li>Spend time in the Process (self-service).</li>
</ul>
</li>
<li>Seize-Delay-Release: <ul>
<li>Grab at least one resource (server), </li>
<li>spend time getting served, </li>
<li>then free the server for the next customer.</li>
<li>If you Seize and the server isn’t available, you may have to wait in a queue.</li>
</ul>
</li>
<li>Seize-Delay: <ul>
<li>Grab at least one resource             </li>
<li>Spend time getting served.              </li>
<li>Remember to Release the server sometime later, else he gets deadlocked and a giant line will form!</li>
</ul>
</li>
<li>Delay-Release: <ul>
<li>Use a previously Seize’d server for a while, </li>
<li>then free him for the next guy to use.</li>
</ul>
</li>
</ul>
<p>Example:</p>
<ul>
<li>A customer walks into the Process module, <ul>
<li>does a Seize-Delay-Release to grab </li>
<li>and use one unit of the resource Barber.</li>
</ul>
</li>
<li>Hit the Add button, <ul>
<li>name the resource Barber, </li>
<li>and set Quantity = 1.</li>
</ul>
</li>
<li>The Process is given a default name of “Process 1” <ul>
<li>and includes the resource </li>
<li>as well as the default queue "Process 1: Queue" (talk about later).</li>
</ul>
</li>
<li>Process = Resource + Queue</li>
</ul>
<p><img src="ISYE6644_images/w402.png" width="500"/></p>
<p><strong>Decide Module</strong></p>
<p>The Decide module allows customers to make probabilistic and conditional choices about their paths.</p>
<p>When an entity gets to a Decide module, they can…</p>
<ul>
<li>Randomly go to either of two locations (“2-way by Chance”) (probabilities are given in percentages)</li>
<li>Randomly go to any of various locations (“N-way by Chance”)</li>
<li>Go to either of two locations if a condition is satisfied (“2-way by Condition”)</li>
<li>Go to any of various locations if a condition is satisfied (“N-way by Condition”)</li>
</ul>
<p><img src="ISYE6644_images/w403.png" width="500"/></p>
<p><strong>Assign Module</strong></p>
<p>The Assign module allows us to give values to attributes and variables, and even assign graphics to entities.</p>
<p><em>Attributes</em></p>
<p>Each customer passing through the system has various properties</p>
<ul>
<li>Tom is 6’ tall, weighs 160 lbs, loves baseball, and has LDL cholesterol = 108.</li>
<li>Justin B. is 4’11” tall, weighs 280 lbs, loves eating lard, and has LDL = 543.</li>
<li>Both guys have 4 attributes, though other guys may have different numbers of attributes.</li>
<li>Attributes need to be numerical; for example, BB = 11 and lard = 28.</li>
</ul>
<p><em>Variables</em></p>
<p>Unlike attributes, whose values are specific to each customer variables are global.</p>
<ul>
<li>If you change a variable anyplace in the Arena program, it gets changed everywhere.</li>
<li>Example: <ul>
<li>a WIP (Work In Process) variable might be incremented when an entity is Create’d, </li>
<li>and decremented if it’s Dispose’d – these events could occur anywhere.</li>
</ul>
</li>
</ul>
<p><strong>Spreadsheets</strong></p>
<ol>
<li>The Attribute Spreadsheet keeps track of existing attributes that you might define in an Assign.<ul>
<li>Can make your own (double click).</li>
<li>Can be vectorized.</li>
</ul>
</li>
<li>Variable Spreadsheet pretty much the same.</li>
<li>Entity Spreadsheet allows you to set initial picture.</li>
</ol>
<p><strong>Arena Internal Variables</strong></p>
<p>Talk about Arena’s so called “internal” variables that are automatically calculated as the simulation proceeds.</p>
<p>Dirty Little Secret: Arena keeps track of and continuously updates lots of stuff as the simulation runs.<br/>
Good for making decisions, drawing graphs, etc.</p>
<ul>
<li><p>Examples:</p>
<ul>
<li>TNOW = current simulated time</li>
<li>NR(Barber) = # of resource Barber’s servers now working</li>
<li>NQ(Process 1.Queue) = # customers in that queue</li>
<li>Create 1.NumberOut = # of customers who have so far left the module named Create 1</li>
</ul>
</li>
<li><p>Huge list is available if you sniff around Build Expression.</p>
</li>
<li>Demo Time! Go to the shortest line.</li>
</ul>
<p><strong>Arena Graphics and Illustrations</strong></p>
<p>How can we display the values of certain variables in real time, construct graphs, and produce output result files?</p>
<p><img src="ISYE6644_images/w404.png" width="500"/></p>
<p>When the simulation is over, it will automatically generate an output report giving info on server usage, queue length,  customer waits and cycle times, and other user-defined quantities.</p>
<ul>
<li>Demo time, including drill press example!</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M5Pt2-ARENA-continued">M5Pt2-ARENA continued<a class="anchor-link" href="#M5Pt2-ARENA-continued">¶</a></h2><h3 id="Batch,-Separate,-and-Record-Modules">Batch, Separate, and Record Modules<a class="anchor-link" href="#Batch,-Separate,-and-Record-Modules">¶</a></h3><p><strong>Batch Module</strong></p>
<ul>
<li>Combine (“batch”) multiple customers into one “super”-customer.            </li>
<li>Batch Size = 3 accumulates 3 guys before sending off the super-customer.</li>
<li>If info about the individual customers in a batch won’t be needed later on, <ul>
<li>then choose Type = Permanent. </li>
</ul>
</li>
<li>But if you want eventually to reconstitute the original members, set Type = Temporary.</li>
<li>Temporary batches will need to be split before being Dispose’d (keep watching).</li>
</ul>
<p><strong>Seperate Module</strong></p>
<ul>
<li>Used to <ul>
<li>Duplicate a single entity, </li>
<li>or split multiple entities that had been combined in a Batch module</li>
<li>If batch type=Permanent then use "Duplicate original" to get clones</li>
<li>if batch type=Temporary then use "Split existing branch" to regain their original attributes</li>
</ul>
</li>
<li>If dealing with a Permanent batch, usually use Duplicate Original to get several customers all with the same attributes.</li>
<li>If dealing with a Temporary batch, use Split Existing Batch to reproduce customers with original attributes.</li>
</ul>
<p><strong>Record Module</strong></p>
<ul>
<li>Nothing special, Collect statistics when an entity passes through the module.</li>
<li>We’ll talk more about this module as we encounter it in future examples.</li>
<li>Demo Time! Now we’ll look at a couple of permutations of the Batch and Separate modules.</li>
</ul>
<p>DEMO: "Module05-13_-_BatchSeparate.doe"</p>
<ul>
<li>Notice how a man and a woman become batched into a single woman</li>
<li>In the top model they are seperated into clones ... because the batch type is permanent</li>
<li>In the bottom model they are seperated back into their original types</li>
</ul>
<h3 id="Run-Setup-and-Control">Run Setup and Control<a class="anchor-link" href="#Run-Setup-and-Control">¶</a></h3><p>We’ll be looking at a bunch of easy little trivia points to help you get your simulation runs going efficiently.</p>
<p><strong>Run Setup</strong></p>
<p>Run &gt; Setup gives you lots of stuff.</p>
<p>Replication Parameters tab</p>
<ul>
<li>Number of Reps: # of indep runs.</li>
<li>Initialize Between Reps: Do you start the stats collection and/or system state from scratch for each replication?</li>
<li>Warm-up Period: How long to run before you start keeping data.</li>
<li>Rep Length: How long each run is.</li>
<li>Terminating Condition: <ul>
<li>Any special ways to stop the simulation </li>
<li>(besides rep length condition from this tab or max arrivals from Create module)?</li>
</ul>
</li>
<li><p>Run Speed tab: Often need to speed up or slow down the simulation by more than what you can do on the main screen.</p>
</li>
<li><p>Reports: Arena has a variety of reports that it gives upon completion of a run.</p>
<ul>
<li>Contains info on customer waits, lengths of queues, server utilizations, userdefined variables, etc.</li>
<li>Category Overview summarizes all reps.</li>
<li>Category by Replication gives tedious info about each rep.</li>
<li>SIMAN Report gives concise text file</li>
</ul>
</li>
</ul>
<p>Run &gt; Setup &gt; Run Control</p>
<ul>
<li>gives a variety of ways that you can run the simulation.</li>
<li>Ex: <ul>
<li>Batch mode, which turns off all graphics and result in extremely fast runs.</li>
</ul>
</li>
</ul>
<h3 id="Two-Channel-Manufacturing-Example">Two-Channel Manufacturing Example<a class="anchor-link" href="#Two-Channel-Manufacturing-Example">¶</a></h3><p>Demo a twochannel manufacturing system, where we finally put a lot of the previous material together.</p>
<p>This is Model 4-1 “An Electronic Assembly and Test System” from the KSZ (2015) text, Simulation with Arena.</p>
<ul>
<li>Two different arrival streams<ul>
<li>Type A parts show up 1-at-a-time; Type B’s 4-at-a-time.</li>
<li>Type A’s show up a little more often than Type B’s.</li>
</ul>
</li>
<li>A’s feed into a Prep A server; B’s go to Prep B. Different service times.</li>
<li>Then the parts get processed by the same Sealer server, but again with different service time distributions.</li>
<li>All parts undergo an inspection. If they pass, they exit.</li>
<li>If they don’t pass, they go to a Rework server, and then another inspection. Whether or not they pass, they exit the system.</li>
</ul>
<p><img src="ISYE6644_images/w405.png" width="500"/></p>
<p>How to handle different A and B service times at Sealer?</p>
<ul>
<li>Trick 1: Pre-assign the service times as an attribute (Sealer Time) in an Assign module immediately after each customer arrives. Use that attribute regardless of being a Type A or B part.</li>
<li>Trick 2: While we’re at it, use the Assign to store each customer’s arrival time as an attribute. Use the Arena variable TNOW to do so.</li>
<li>Record departure times just before parts get Dispose’d, This will allow us to get average cycle times ( depart – arrival Times ) for any of the 3 types of parts (pass on first try, pass on second, fail both).</li>
</ul>
<p>Dave’s Alternative Trick: Is there another way to model the process time at the Sealer without having to assign a Sealer Time attribute for A’s and B’s?</p>
<ul>
<li>Yes! It involves a little work, but it’s nice to know.</li>
<li>Note that the entity types (Part A and Part B) are assigned in the respective Create modules.</li>
<li>Instead of assigning the Sealer Time as an attribute in the Assign module, we can just wait until the Sealer Process module and use the following logical expression, <ul>
<li>where (x==y) = 1 if x=y, and 0 otherwise. (See why?)</li>
<li>((Entity.Type == Part A) <em> TRIA(1,3,4)) + ((Entity.Type == Part B) </em> WEIB(2.5,5.3))</li>
</ul>
</li>
</ul>
<p><img src="ISYE6644_images/w406.png" width="600"/></p>
<p>Demo: "Module05-15_-_Model_04-01-ElectronicAssembly-slow.doe"</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M5Pt3-ARENA-Advanced">M5Pt3-ARENA Advanced<a class="anchor-link" href="#M5Pt3-ARENA-Advanced">¶</a></h2><h3 id="Fake-Customers">Fake Customers<a class="anchor-link" href="#Fake-Customers">¶</a></h3><p>This Lesson: We’ll talk about “fake” customers!</p>
<p>Idea: These aren’t real customers at all… their purpose is just to do some task that Arena needs.</p>
<p>You can use “fake” customers to accomplish various tasks during a simulation.</p>
<ul>
<li>Like triggering a breakdown, keeping track of statistics or metrics </li>
<li>Not actual customers that you care about in terms of waiting times or use of resources.</li>
<li>Demo Time will explain all!<ul>
<li>Calculate normal probabilities</li>
<li>Keep track of which time period you’re in (part of Call Center example coming up)</li>
<li>Breakdown demon</li>
</ul>
</li>
</ul>
<h3 id="The-Advanced-Process-Template">The Advanced Process Template<a class="anchor-link" href="#The-Advanced-Process-Template">¶</a></h3><p>This Lesson: We’ll add to our arsenal of modules by introducing the Advanced Process template!</p>
<p>Idea: Lots of great new stuff, though I don’t expect you to memorize everything.</p>
<p>File &gt; Template Panel &gt; Attach (and hopefully you find it in the Rockwell Software \ Arena \ Template directory).</p>
<p>For Newer Arena try &gt; Attach &gt; "...\Program Files\Rockwell Software\Arena\Template\OldArenaTemplates"</p>
<p>Lots of new modules and
spreadsheets.</p>
<ul>
<li>I don’t expect you to memorize them all.</li>
<li>Concentrate for now on a few of these (comment on others later):<ul>
<li>Seize, Delay, Release modules</li>
<li>Expression, Failure spreadsheets.</li>
</ul>
</li>
</ul>
<h3 id="Seize,-Delay,-Release">Seize, Delay, Release<a class="anchor-link" href="#Seize,-Delay,-Release">¶</a></h3><ul>
<li>Why do we have separate Seize, Delay, and Release modules? <ul>
<li>Aren’t they right there in the Process module?</li>
</ul>
</li>
<li>Yup, but sometimes you need to do things that are too complicated for the Process module version of Seize–Delay–Release.</li>
<li>Now you can handle things like…<ul>
<li>Seize–Assign–Delay–Release</li>
<li>Non-symmetric multiple Seize’s and Release’s</li>
<li>Complicated Seize’s and Release’s that might depend on sets of servers (as in the upcoming Call Center example)</li>
</ul>
</li>
<li>Demo Time!<ul>
<li>Will talk about some of these Seize, Delay, Release issues.</li>
<li>Will also sneak in some wisdom about the Expression spreadsheet.</li>
</ul>
</li>
</ul>
<h3 id="Resource-Failures-and-Maintenance">Resource Failures and Maintenance<a class="anchor-link" href="#Resource-Failures-and-Maintenance">¶</a></h3><p>This Lesson: We’ll study model breakdowns and maintenance in a way that’s more direct than via fake customers.</p>
<p><strong>Failures</strong></p>
<ul>
<li>You can cause resource failures by scheduling “breakdown demons” (fake customers with high priority). <ul>
<li>this isn’t elegant.</li>
<li>Better way is to use the Resource and Failure spreadsheets in conjunction with each other.</li>
</ul>
</li>
</ul>
<p><img src="ISYE6644_images/w407.png" width="600"/></p>
<p><em>How To</em></p>
<p>Go to Resource spreadsheet in the Basic Process template.</p>
<ul>
<li>Click on Failures column.</li>
<li>Add a Failure Name.</li>
<li>Choose Failure Rule (will discuss in a minute).</li>
<li>Go to the Failure spreadsheet in the Advanced Process template, where you’ll see your new failure name.</li>
<li>Choose type of failure:<ul>
<li>Count (failure after a certain # of arrivals)</li>
<li>Time (after a certain amount of time)</li>
</ul>
</li>
<li>Choose downtime (for repair): Can be any expression.</li>
</ul>
<p><em>Notes and Remarks</em></p>
<p>Can schedule multiple failures by using multiple rows of the Failures column in the Resource spreadsheet, e.g., type I failure, type II failure, scheduled maintenance.</p>
<p>Types of Failure Rules:</p>
<ul>
<li>Ignore (complete service of current customer, but reduce repair time).</li>
<li>E.g., if repair time = 1 hour and cust still needs 10 min, then repair time gets reduced to 50 min and finishes at 60 min mark.</li>
<li>Wait (complete service of current cust and delay repair). </li>
<li>E.g., if repair time = 1 hr and cust needs 10 min, then repair finishes at 70 min mark.</li>
<li>Preempt (stop service of current cust, but complete service after the repair). Repair stops at 60 min mark, cust finishes at 70 min mark.</li>
<li>Demo Time!</li>
</ul>
<h3 id="The-Blocks-Template">The Blocks Template<a class="anchor-link" href="#The-Blocks-Template">¶</a></h3><p>This Lesson: We’ll add to our bag of tricks by introducing the Blocks template.</p>
<p>These are lots or blocks in this template, but don’t be intimidated.</p>
<p>File &gt; Template Panel &gt; Attach "...\Program Files\Rockwell Software\Arena\Template"</p>
<p>Huge number of blocks!</p>
<ul>
<li>Do not be scared!       </li>
<li>They’re sort of a self-contained language (related to SIMAN).        </li>
<li>Very specialized and low-level.      </li>
<li>Very useful, but we’ll only need a few for now:      </li>
<li>Seize, Delay, Release, Queue, Alter    </li>
</ul>
<p>Yikes! Why are we seeing stuff like Seize, Delay, Release yet again!? At least two reasons…</p>
<ul>
<li>Arena has been built in many layers over the years, and these are what’s left from SIMAN – the “original” incarnation of Arena.</li>
<li>But in any case, and for whatever reason, certain primitive blocks such as the Queue block can’t even connect to a Seize module from the Advanced Process template or a Process module from the Basic Process template. So you’re stuck!</li>
</ul>
<p>Demo Time!</p>
<ul>
<li>A Queue-Seize-Delay-Release example using primitive blocks (we’ll see this again in the Call Center example coming up).</li>
<li>Using the Alter block to change the number of resources.</li>
</ul>
<h3 id="The-Joy-of-Sets">The Joy of Sets<a class="anchor-link" href="#The-Joy-of-Sets">¶</a></h3><p>This Lesson: What are sets, and how do they enhance our modeling ability? Idea: We’ll especially concentrate on resource sets.</p>
<ul>
<li>As in baby math class, a set is just a group of elements. Elements are allowed to belong to more than 1 set.</li>
<li><p>“Elements” can mean a lot of things in Arena, and so there are various types of sets:</p>
<ul>
<li>Resource (e.g., a set of servers)</li>
<li>Counter ( count entities, fake customers, etc etc)</li>
<li>Tally</li>
<li>Entity Type</li>
<li>Entity Picture</li>
<li>…and tougher stuff later</li>
</ul>
</li>
<li><p>Use the Set spreadsheet in the Basic Process template to define sets.</p>
</li>
<li>We’ll just study resource sets for now.</li>
<li>A “vanilla” resource has identical, interchangeable servers. But a resource set can have distinct servers, with different schedules, service speeds, service specialties, etc.</li>
<li><p>Call Center Example: Three products with the following resources</p>
<ul>
<li>Product 1: Charity, Noah, Molly, Anna, Sammy</li>
<li>Product 2: Tierney, Sean, Emma, Anna, Sammy</li>
<li>Product 3: Shelley, Jenny, Christie, Molly, Anna, Sammy</li>
<li>Molly, Anna, and Sammy all have degree of cross-functionality.</li>
<li>All 11 servers turn out to have different schedules (more on that later)</li>
</ul>
</li>
<li><p>To define the resource set Product 1, choose Type = Resource, click in Members, then enter Product 1’s servers under Resource Name.</p>
</li>
</ul>
<p><img src="ISYE6644_images/w408.png" width="600"/></p>
<p>Product 1’s “Preferred Order” is to try Charity first. If she’s not available, try Noah. Save Sammy for last because he’s crossfunctional. Other orders are possible.</p>
<ul>
<li>Have to be a little careful with Seize-Delay-Release for a resource set.</li>
<li>The problem is that you have to make sure that you Release the same guy that you originally Seize’d. (If you release a random server, some other customer may lose his server!)</li>
</ul>
<p><img src="ISYE6644_images/w409.png" width="600"/></p>
<p>Let’s Seize a server from the set Product 1 in Preferred Order. Make sure we remember who it is. Then when we’re done, Release that same guy.</p>
<p><img src="ISYE6644_images/w410.png" width="600"/></p>
<ul>
<li>Seize Quantity = 1 guy from the set Product 1 in the Preferred Order. Save the “name” of that server in the customer’s Save Attribute called Tech Agent Index.</li>
<li><p>Later, Release that Specific Member stored in Tech Agent Index.</p>
</li>
<li><p>Various Seize Selection Rules are possible:</p>
<ul>
<li>Cyclical</li>
<li>Random</li>
<li>Preferred Order</li>
<li>Specific Member</li>
<li>Largest Remaining Capacity</li>
<li>Smallest Number Busy</li>
</ul>
</li>
<li>This stuff will be very useful when we do our Call Center example.</li>
<li>Demo Time! A simple model with 4 servers.<ul>
<li>See "ArenaFiles\Module05-22_-_Model_05-01-_CallCenter.doe"</li>
</ul>
</li>
</ul>
<h3 id="Ex-Call-Centre-Model">Ex Call-Centre Model<a class="anchor-link" href="#Ex-Call-Centre-Model">¶</a></h3><p><strong>Call Center Description</strong></p>
<p>Program is arranged in submodels.</p>
<ul>
<li>Create and Direct Arrivals<ul>
<li>How often do calls show up and where do they go?</li>
</ul>
</li>
<li>Tech Support Calls<ul>
<li>What kind of tech support do you need?</li>
</ul>
</li>
<li>Returned Tech Calls<ul>
<li>Sometimes the guy has to get back to you.</li>
</ul>
</li>
<li>Sales Calls</li>
<li>Order Status Calls</li>
<li>Time Period Counter - What ½-hour period of the day is it?</li>
</ul>
<p>Calls show up according to a nonhomogeneous Poisson process.</p>
<ul>
<li><p>The center accepts calls from 8:00A till 6:00P.</p>
<ul>
<li>The arrival rates change every half hour (see table below from KSZ).      </li>
<li>Also see Arrival Schedule in the Basic Process Schedule spreadsheet.         </li>
</ul>
</li>
<li><p>A few staff actually stay at work until 7:00P, in order to let the calls at the end of the day clear out. (You have to explicitly model 0 arrivals for the last two half-hour segments of the Arrival Schedule.)</p>
</li>
</ul>
<p><img src="ISYE6644_images/w411.png" width="600"/></p>
<p><strong>Phone Lines</strong></p>
<p>There are 26 phone lines. If you get a busy signal, you balk and get killed off.</p>
<ul>
<li>Use a Queue block with capacity 0 to try to Seize a line. If the Seize fails, there’s no place to go in the Queue, and out you go.</li>
<li>The Queue and Seize both come from the Blocks template panel. This is the only place where you can get a Queue block, and it only connects to this kind of Seize. (Recall that you can also use a Seize within a Process module in the Basic Process template, and there’s another Seize in the Advanced Process template!)</li>
</ul>
<p><strong>Types of Calls</strong></p>
<p>There are 3 general types of calls, which we’ll handle with an “N-way by Chance” Decide module. Each customer hears a recording for a UNIF(0.1,0.6) amount of time, while he makes his choice of call type.</p>
<ul>
<li>76% go to Tech Support.</li>
<li>16% go to Sales.<ul>
<li>There are 7 identical, faceless Sales guys that we’ll need to schedule (but not on an individual basis).</li>
<li>Sales calls take TRIA(4,15,45).</li>
</ul>
</li>
<li>8% go to Order Status.<ul>
<li>Most callers can do self-service in a TRIA(2,3,4) amount of time. But…</li>
<li>15% of customers need a Sales guy for TRIA(3,5,10).</li>
</ul>
</li>
</ul>
<p><strong>Tech Support</strong></p>
<p>There are 3 specific types of Tech Support calls (which we’ll again handle via a Decide module):</p>
<ul>
<li>25% are for Product 1.</li>
<li>34% are for Product 2.</li>
<li>41% are for Product 3.</li>
<li>Each customer gets another recording for a UNIF(0.1,0.5) amount of time, while he makes his choice.</li>
<li>All Tech Support calls require staff for a TRIA(3,6,18) duration of time.</li>
</ul>
<p><strong>Call Backs</strong></p>
<p>4% of Tech Support calls require additional investigation.</p>
<ul>
<li>This additional investigation is carried out by another group of staff that we won’t worry about. The customer’s original server is freed up when he makes the determination that more research is needed.</li>
<li>The investigation takes an EXPO(60) amount of time.</li>
<li>At that point, the original Tech Support guy will call the customer back using one of the 26 phone lines (but with high priority).</li>
<li>That call takes TRIA(2,4,9) time.</li>
</ul>
<p><strong>Tech Support Info</strong></p>
<p>Tech Support staff have some interesting issues.</p>
<ul>
<li>They all have 8 hr days + 30 min for lunch.</li>
<li>They all have different schedules. We’ll need Resource Schedules to model this on an individual basis.</li>
<li>They all have different product expertise. We’ll need Sets to model this. Here are the Preferred Orders for the sets:<ul>
<li>Product 1: Charity, Noah, Molly, Anna, Sammy</li>
<li>Product 2: Tierney, Sean, Emma, Anna, Sammy</li>
<li>Product 3: Shelley, Jenny, Christie, Molly, Anna, Sammy</li>
</ul>
</li>
</ul>
<p><img src="ISYE6644_images/w412.png" width="600"/></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Demo-Inventory-System">Demo-Inventory System<a class="anchor-link" href="#Demo-Inventory-System">¶</a></h3><p><strong>Description of (s,S) Policy</strong></p>
<ul>
<li>Simulate the widget inventory stock over time.</li>
<li>Use modules from the Basic and Advanced panels.</li>
<li>Customer interarrivals are EXPO(0.1).</li>
<li>Demand size is a DISC function.</li>
<li>Demand is always “met” (backlogged, if necessary).</li>
<li>Inventory is “taken” at the start of each day.</li>
<li>If inventory is below s, we order up to S.</li>
<li>Delivery lead time is UNIF(0.5,1) before order arrives (pretty quick, but by the time it arrives, other customers will have arrived).</li>
<li>Order costs (set-up + incremental), holding costs, penalty costs.</li>
<li>Calculate average total cost per day over 120 days.</li>
<li>Inventory, unit costs, and all of the other parameters are variables.</li>
<li>Inventory is decremented by demands, incremented by orders.</li>
<li>Interarrival times, demands, lead time, are expressions from Advanced Process template.</li>
<li>Accumulated costs are calculated in the Statistic spreadsheet in the Advanced panel.</li>
<li>Daily inventory review is conducted by a “fake” customer.</li>
</ul>
<h3 id="Demo-1-vs-2-Waiting-Lines">Demo-1 vs 2 Waiting Lines<a class="anchor-link" href="#Demo-1-vs-2-Waiting-Lines">¶</a></h3><p>This Lesson: Should we use one line feeding into two parallel servers or separate lines feeding into two individual servers?<br/>
Idea: We’ll use a very cool trick called common random numbers to do an apples-toapples comparison.</p>
<p><strong>Game Plan</strong></p>
<ul>
<li>Option A: Customers show up and join one line in front of two identical servers. They go to whichever server is available first.</li>
<li>Option B: Customers randomly choose which of two lines (in front of single servers) to join.</li>
<li>Will compare which of A or B is better by using:<ul>
<li>The exact same customer arrivals (thanks to a Separate module), and</li>
<li>The same service times for a particular customer whether or not he’s doing A or B (thanks to an early Assign module).</li>
</ul>
</li>
<li>Almost certainly, Option A is better (why?)</li>
<li>Matching up the arrival and service times makes things easier for us statistically. “Common Random Numbers”</li>
</ul>
<p><img src="ISYE6644_images/w413.png" width="600"/></p>
<p><strong>A Crazy Re-entrant Queue</strong></p>
<p>Re-entrant Queues</p>
<ul>
<li>Customers go to Server 1, then to Server 2, then back to Server 1, back to 2, and finally back to 1. <ul>
<li>That is, 1 -&gt; 2 -&gt; 1 -&gt; 2 -&gt; 1.</li>
<li>These returns are why we call the queues “re-entrant”.</li>
<li>They’re depicted in Arena as 5 separate Process modules with Seize-DelayRelease trios. (It’s OK to Seize the same server in different Process modules.)</li>
</ul>
</li>
<li>This seems like a perfectly boring model. Let’s make it interesting.<ul>
<li>All service times are exponential. </li>
<li>Here are the means: 1 (0.1) -&gt; 2 (0.5) -&gt; 1 (0.1) -&gt; 2 (0.1) -&gt; 1 (0.5)</li>
<li>…and the customer priorities: 1 (low) -&gt; 2 (high) -&gt; 1 (medium) -&gt; 2 (low) -&gt; 1 (high)</li>
</ul>
</li>
<li>Thus, on the customer’s 3rd visit to Server 1, he has a high-priority EXPO(0.5) service time.</li>
</ul>
<p><img src="ISYE6644_images/w414.png" width="600"/></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M6-Generating-Random-Num's-Uniform">M6-Generating Random Num's Uniform<a class="anchor-link" href="#M6-Generating-Random-Num's-Uniform">¶</a></h2><p>In this Module we’ll do a deep dive to investigate how to generate Unif(0,1) pseudo-random numbers.</p>
<p>This is really just a cookbook of recipe's for generating Unif(0,1) RVs. ( www.youtube.com/watch?v=dk01eeKMD_I )</p>
<p>Uniform(0,1) random numbers are the key to random variate generation in simulation. You can then transform these Unif(0,1) RV's into your favourite RV, like the uniform</p>
<p><strong>Goal:</strong> Give an algorithm that produces a sequence of pseudo-random numbers (PRNs) $R_1,R_2,\cdots$ that appear to be iid U(0,1)</p>
<p><strong>Desired Algo Properties</strong></p>
<ul>
<li>Output appear to be iid Unif(0,1)</li>
<li>very fast </li>
<li>Ability to reproduce any sequence it generates</li>
</ul>
<p><strong>Bad Properties</strong></p>
<ul>
<li>Output of a random device </li>
<li>Table of random numbers</li>
<li>midsquare</li>
<li>fibonacci - because it is predictable</li>
</ul>
<p><strong>Decent algo's</strong></p>
<ul>
<li>Linear congruential (most common in practice)</li>
<li>Tausworthe (linear recursion mod 2)</li>
<li>Hybrid approaches</li>
</ul>
<h3 id="Lousy-Generators">Lousy Generators<a class="anchor-link" href="#Lousy-Generators">¶</a></h3><p><strong>Random Devices</strong><br/>
Nice randomness properties. However, Unif(0,1) seq storage is difficult so repeating an experiemnt is almost impossible.<br/>
Examples</p>
<ul>
<li>coin toss</li>
<li>gieger particle counter</li>
<li>least significant digit of an atomic clock</li>
</ul>
<p><strong>Random Number Table</strong>
There was actually a book written that contained 1million random numbers. Fun read eh?<br/>
<em>A Million Random Digits with 100,000 Normal Deviates</em>  Published by the rand corp.</p>
<p><strong>Mid-Square Method</strong> By J Von Neumann<br/>
Idea is to take the middle part squared of the previous random number. Note that this is actually quite terrible.</p>
<p>Example:</p>
<ul>
<li>Take $R_i = X_i/10000 \; \forall i \; where \; X_i's$ are integers &lt;10000   </li>
<li>Set seed $X_0=6632$ then $6632^2 = 43\textbf{9834}24$ the middle portion is 9834</li>
<li>So $X_1=9834$ then $9834^2 = 96\textbf{7075}56$ the middle portion is 7075</li>
<li>So $X_2=7075$ keep repeating</li>
</ul>
<p>Notes</p>
<ul>
<li>Unfortunately, positive serial correlation in $R_i's$</li>
<li>Also, occasionally degenerated; e.g. consider $X_i=0003$</li>
</ul>
<p><strong>Fibonacci and Additive Congruential Generators</strong></p>
<ul>
<li>$X_i = (X_{i-1}+X_{i-2}) mod \; m \; for \; i=1,2,...$</li>
<li>where $R_i=X_i/m$, </li>
<li>m is the modulus, </li>
<li>$X_{-1},X_0$ are seeds, </li>
<li>and $a = b mod m$ iff a is the remainder of b/m (ex 6 = 13 mod 7)</li>
</ul>
<p>Problems:</p>
<ul>
<li>small numbers will generally follow small numbers.  </li>
<li>It's not possible to get $X_{i-1} &lt; X_{i+1} &lt; X_i $ nor to get $X_i &lt; X_{i+1} &lt; X_{i-1} $ which should occur</li>
</ul>
<h3 id="Linear-Congruential-Generators">Linear Congruential Generators<a class="anchor-link" href="#Linear-Congruential-Generators">¶</a></h3><p>Variations of the LCG are the most commonly used generators in practice. They are pretty great when implemented properly.</p>
<ul>
<li>$X_i = (aX_{i-1}+c) \; mod \; m$ where X_0 is the seed</li>
<li>$R_i = X_i/m, i=1,2,...$</li>
<li>Choose <em>a,c,m</em> carefully to get good statistical quality and long period cycle length. </li>
<li><p>i.e. time until LCG starts to repeat itself.</p>
</li>
<li><p>If c=0, LCG is called a multiplicative generator</p>
</li>
</ul>
<p><img src="ISYE6644_images/MOD6-01.png" width="400;"/></p>
<p>Consider:</p>
<ul>
<li>$X_i = (5 X_{i-1} + 2) \; mod \; 8$ which is similar to the above  </li>
<li>does this achieve a full cycle? How so</li>
</ul>
<p>Consider: <strong>(Desert Island Generator)</strong><br/>
Here's our old 16807 implementation (BFS 1987), translated from fortran. It works decently. It's fast, is full period and has a cycle length of &gt; 2 billion.<br/>
$X_i = 16807 X_{i-1} \; mod \; (2^{31} - 1)$</p>
<p><strong>Algo</strong><br/>
Let $X_0$ be an integer seed between 1 and $2^{31}0 -1$</p>
<p>Then for i = 1,2,...</p>
<ul>
<li>$K = floor(X_{i-1}/12773)$</li>
<li>$X_i = 16807(X_{i-1} - 127773K) - 2836K$</li>
<li>if $X_i &lt; 0$, then set $X_i = X_i + 2147483647$     </li>
<li>$R_i = X_i * 4.656612875E-10$</li>
</ul>
<p><strong>Example</strong><br/>
If $X_0=12345678$ then K=96 and</p>
<ul>
<li>$X_1=16807[12345678 - 12773(96)]-2836(96)=1335380034$    </li>
<li>hence $R_1=0.621835$</li>
</ul>
<p><strong>LCG Pitfalls</strong></p>
<ul>
<li>$X_i = (4X_{i-1}+2) \; mod \; 8$ is not full period since it only produces even integers</li>
<li>$X_i = (X_{i-1}+1) \; mod \; 8$ is full period but it produces non-random numbers s.t. (1,2,3)</li>
<li>In any case, if m is small, you'll get quick cycling whether or not the generator is full period. <ul>
<li>Small can mean anything less than 2 billion or so!</li>
</ul>
</li>
<li>And just because m is big, you still have to be careful. Some subtle problems can arise. (ex: see RANDU )</li>
</ul>
<p><strong>RANDU Example</strong></p>
<ul>
<li>$X_i = 65539 X_{i-1} \; mod \; 2^{31}$ was very popular in the 1960's</li>
</ul>
<p><img src="ISYE6644_images/MOD6-02.png" width="400;"/></p>
<p><strong>Exercises</strong></p>
<ol>
<li>Implement RANDU and see how it does. </li>
</ol>
<ul>
<li>plot $R_{i-1} \; vs \;  R_i$ for i=1,2,...,1000 and see what happens</li>
<li>try different seeds and you might see different hyperplanes?</li>
<li>or try to plot ($R_{i-2},R_{i-1},R_{i}$) in 3 Dim's</li>
</ul>
<ol>
<li>Now do the same with the 16807 generator ( you won't see hyperplanes - bummer )</li>
</ol>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Tausworthe-generator">Tausworthe generator<a class="anchor-link" href="#Tausworthe-generator">¶</a></h3><p>This class of generators tends to be popular with programmers.</p>
<p><strong>Definition</strong></p>
<ul>
<li>Define a sequence of binary digits $B_1,B_2,...$              </li>
<li>by $\large B_i = \left( \sum_{j=1}^q c_j B_{i-j} \right)$ where $c_j = 0 \; or \; 1$ (Looks a bit like a generalization of LCG's)</li>
<li>Usual Implementation (saves computational effort)         </li>
<li>$B_i = (B_{i-r} + B_{i-q}) \; mod \; 2 = B_{i-r} \; XOR \; B_{i-q} \; (0 &lt; r &lt; q)$        </li>
<li>To obtain $B_i=0$ if $B_{i-r} = B_{i-q}$</li>
<li>or that $B_i = 1$ if $B_{i-r} \ne B_{i-q}$</li>
<li>To initialize $B_i$'s sequence, specify $B_1,B_2,\cdots,B_q$</li>
</ul>
<p><strong>Example</strong> (this comes from Law 2015)</p>
<ul>
<li>Let $r=3,q=5,B_1=\cdots=B_5=1$.</li>
<li>Obtain $B_i=(B_{i-3}+B_{i-5}) \; mod \; 2 = B_{i-3} \; XOR \; B_{i-5} \; i&gt;5$</li>
<li>$B_6=(B_3 \; XOR \; B_1)=0$</li>
<li>$B_7=(B_4 \; XOR \; B_2)=0$</li>
<li>etc etc</li>
</ul>
<p>You should see something like this (for example)<br/>
$\color{red}{1111}$ 1011 0100 0010 0101 1001 $\color{red}{1111}$</p>
<p>The period of 0-1 bits is always $2^q - 1 = 31$</p>
<p>This begs the question how do we go from $B_i$'s to $Unif(0,1)$'s?<br/>
Easy way: Use (l-bits in base 2)/$2^l$ and convert to base 10</p>
<p><strong>Example:</strong><br/>
Set l-4 in previous example and you should get<br/>
$1111_2,1000_2,1101_2,1101_2,\cdots \rightarrow 15/16,8/16,13/16,13/16,\cdots$</p>
<p>Lots of potential for tausworthe generators. Nice properties include long periods, and fast calculation.</p>
<h3 id="Generalizations-of-LCGs">Generalizations of LCGs<a class="anchor-link" href="#Generalizations-of-LCGs">¶</a></h3><p>A Simple Generalization:<br/>
$X_i = (\sum_{j=1}^q a_i X_{i-j}) \; mod \; m$ where the $a_i's$ are constants<br/>
Extremely large periods possible (up to m^q - 1 if paramters are chosen properly).</p>
<ul>
<li>watch out! Fibonacci is a special case of these</li>
</ul>
<p><strong>Combination of Generators</strong><br/>
Can combine two generators $X_i,X_2,...$ and $Y_1,Y_2,...$ to construct $Z_1,Z_2,...$<br/>
Some possiblities include</p>
<ul>
<li>Set $Z_i=(X_i+Y_i) \; mod \; m$</li>
<li>Shuffling</li>
<li>Set $Z_i=X_i$ or $Z_i=Y_i$</li>
</ul>
<p><strong>Example</strong> Due to L'Ecuyer (1999)</p>
<ul>
<li>Initialize $X_{1,0} \; X_{1,1} \; X_{1,2} \; X_{2,0} \; X_{2,1} \; X_{2,2}$ </li>
<li>for $i \ge 3$ set <ul>
<li>$X_{1,i}=(1,403,580X_{1,i-2}-810,728X_{1,i-3}) \; mod \;(2^{32} - 209)$</li>
<li>$X_{2,i}=(527,612X_{2,i-1}-1,370,589X_{2,i-3}) \; mod \;(2^{32} - 22,853)$</li>
<li>$Y_i = (X_{1,i} - X_{2,i}) \; mod \;(2^{32} - 209) $</li>
<li>$R_i = Y_i / (2^{32} - 209)$</li>
</ul>
</li>
</ul>
<p>As crazy as this works it is surprsingly really good with a cycle length of approx $2^{191}$</p>
<p>It is of interest to note that Matsumoto and Nishimura have developed the “Mersenne Twister” generator, which has period of $2^{19937} – 1$ (yes, that's a prime number) and works great!!</p>
<p>You’ll often need several billion PRN’s, but never anything over $2^{100}$.</p>
<p>All standard packages use one of these good generators.</p>
<h3 id="Generators---Theory">Generators - Theory<a class="anchor-link" href="#Generators---Theory">¶</a></h3><p><em>These are nice to know and understand, but the professor claims that we will not be held responsible for this section</em></p>
<p><strong>Theorem</strong> The generator $X_i=aX_{i-1} \; mod \; 2^n$ for n &gt; 3 can have a cycle length of at most $2^{n-2}$. This is achieved whn $X_0$ is odd and $a=8k+3$ or $a=8k+5$ for some k.</p>
<p><strong>Example</strong> BCNN: $X_i = 13 X_{i-1} \; mod \; 64$</p>
<p><img src="ISYE6644_images/MOD6-03.png" width="400;"/></p>
<p><strong>More fun Theorems</strong></p>
<p><strong>Theorem</strong> $X_i = (aX_{i-1} + c) \; mod \; m$ for c &gt; 0, has a full cycle if</p>
<ul>
<li>i - c and m are relatively prime; </li>
<li>ii - a-1 is a multiple of every prime which divides m </li>
<li>iii - a-1 is a multiple of 4 if 4 divides m</li>
</ul>
<p><strong>Corollary</strong> $X_i = (aX_{i-1} + c) \; mod \; 2^n$ for (c,n &gt; 1) has full cycle if c is odd and a=4k+1 for some k.</p>
<p><strong>Theorem</strong> The multiplicative generator $X_i=aX_{i-1} \; mod \; m$, with prime m has full period (m-1) if and only if</p>
<ul>
<li>i. m divides $a^{m-1}-1$ and </li>
<li>ii. for all integers i &lt; m-1, m does not divide $a^i - 1$</li>
</ul>
<p><strong>Remark</strong> for $m=2^{31}-1$ it can be shown that 534,600,000 multipliers yield full period, the "best" of which is a=950,706,376 (Fishman and Moore 1986).</p>
<p><img src="ISYE6644_images/MOD6-04.png" width="400;"/></p>
<h3 id="Generators---Choosing/Testing">Generators - Choosing/Testing<a class="anchor-link" href="#Generators---Choosing/Testing">¶</a></h3><p>We’ll now give an overview on statistical tests for goodness-of-fit and independence.</p>
<p>We’ll look at two classes of tests:</p>
<ul>
<li>Goodness-of-fit tests — are the PRNs approximately Unif(0,1)?</li>
<li>Independence tests — are the PRNs approximately independent?</li>
</ul>
<p>If a generator passes both types of tests (in addition to others I won’t tell you about), we’ll be happy to use the PRNs it generates.</p>
<p>All tests are of the form $H_0$ (our null hypothesis) vs. $H_1$ (the alternative hypothesis). We regard $H_0$ as the status quo, so we’ll only reject $H_0$ if we have “ample” evidence against it. (Innocent until proven guilty.) Usually, we really want to avoid incorrect rejections of $H_0$.</p>
<p>When we design the test, we set the level of significance</p>
<ul>
<li>α = P(Reject $H_0$ | $H_0$ true).</li>
<li>Typically, α  = 0.05 or 0.1, and is the probability of Type I error.</li>
</ul>
<p>We can also specify the probability of Type II error,</p>
<ul>
<li>β = P(Accept $H_0$ | $H_0$ false),</li>
<li>but we won’t worry about that just now.</li>
</ul>
<blockquote><p><font color="red"> $\chi^2$ Goodness-Of-Fit Test</font></p>
</blockquote>
<p>Test $H_0:R_1,R_2,\cdots,R_n \sim Unif(0,1)$</p>
<p>Divide the unit interval into k cells, or sub-intervals. If you choose equi-probable cells $[0,1/k),[1/k,2/k),\cdots,[k-1/k,1]$, then a particular observation $R_j$ will fall in a particular cell with prob $1/k$.</p>
<p>Tally how many of the n observations fall into the k cells. If $O_i=$ # of $R_j's$ in cell i, then (since the $R_j's$ are iid), we can easily see that $O_i \sim Bin(n,1/k)$</p>
<p>Thus, the expected number of $R_j's$ to fall in cell i will be $E_i = E[O_i]=n/k,i=1,2,...,k$</p>
<p>We will reject the null hypothese $H_0$ if the $O_i's$ don't match the $E_i's$ well.<br/>
The $\chi^2$ goodness-of-fit statistic is</p>
<ul>
<li>$\large \chi_0^2 = \sum_{i=1}^k \frac{(O_i - E_i)^2}{E_i}$</li>
<li>A large value of this statistic indicates a bad fit</li>
</ul>
<p>In fact we reject the null hypothesis $H_0$ (that the observations are uniform) if $\chi_0^2 &gt; \chi_{\alpha,k-1}^2$, where $\chi_{\alpha,k-1}^2$ is the appropriate $1-\alpha$ quantile from a $\chi^2$ table, ie $Pr(\chi_0^2 &gt; \chi_{\alpha,k-1}^2) = 1-\alpha$.</p>
<p>if $\chi_0^2 \le \chi_{\alpha,k-1}^2$, we fail to reject $H_0$ (which doesn't imply acceptance of $H_1$)</p>
<p>Usual recommendation for $\chi^2$ goodness-of-fit test to work, is to pick k,n such that $E_i \ge 5$ and n at least 30. But when we test PRN generators we usually have a huge number of observations n (generally in the millions) with a large number of cells k. When k is large, we can use the approximation</p>
$$\large \chi_{\alpha,k-1}^2 \approx (k-1) \left[ 1 - \frac{2}{9(k-1)} + z_{\alpha} \sqrt{\frac{2}{9(k-1)}} \right]$$<p>where $z_{\alpha}$ is the appropriate standard normal quantile.</p>
<p><strong>Remarks</strong></p>
<ul>
<li>1: 16807 PRN generator usually passes a gof test just fine</li>
<li>2: We will show gof tests for other distributions later on (until now we have focused on uniform PRNs)</li>
<li>3: Other gof tests are Kolmogorov-Smirnov test, Anderson-Darling test, etc. </li>
</ul>
<p><img src="ISYE6644_images/MOD6-05.png" width="400;"/></p>
<blockquote><p><font color="red"> Independence Tests </font></p>
<p><font color="red"> RUN Test - Up and Down </font></p>
</blockquote>
<p>We’ll look at so-called “runs” tests for independence of the PRNs.</p>
<p>See (<a href="https://www.eg.bucknell.edu/~xmeng/Course/CS6337/Note/master/node44.html">https://www.eg.bucknell.edu/~xmeng/Course/CS6337/Note/master/node44.html</a>)</p>
<p>The runs test examines the arrangement of numbers in a sequence to test the hypothesis of independence</p>
<p>A run is defined as a succession of similar events proceded and followed by a different event.
E.g. in a sequence of tosses of a coin, we may have</p>
<ul>
<li>H T T H H T T T H T    </li>
</ul>
<p>The first toss is proceded and the last toss is followed by a "no event". This sequence has six runs, first with a length of one, second and third with length two, fourth length three, fifth and sixth length one.</p>
<p>A few features of a run</p>
<ul>
<li>two characteristics: number of runs and the length of run  </li>
<li>an up run is a sequence of numbers each of which is succeeded by a larger number; </li>
<li>a down run is a squence of numbers each of which is succeeded by a smaller number</li>
</ul>
<p>If a sequence of numbers have too few runs, it is unlikely a real random sequence.<br/>
E.g. 0.08, 0.18, 0.23, 0.36, 0.42, 0.55, 0.63, 0.72, 0.89, 0.91,<br/>
the sequence has one run, an up run. It is not likely a random sequence.</p>
<p>If a sequence of numbers have too many runs, it is unlikely a real random sequence.<br/>
E.g. 0.08, 0.93, 0.15, 0.96, 0.26, 0.84, 0.28, 0.79, 0.36, 0.57.<br/>
It has nine runs, five up and four down. It is not likely a random sequence.</p>
<p>If a is the total number of runs in a truly random sequence, the mean and variance of a is given by
$$\mu_a = \frac{2N - 1}{3} $$
and
$$\sigma^2 = \frac{16N - 29}{90} $$</p>
<p>For $ N &gt; 20$, the distribution of a is reasonably approximated by a normal distribution, $N(\mu_a, \sigma_a^2)$</p>
<ul>
<li>We reject $H_0$ if A is to small or to big</li>
</ul>
<p>The test statistic is $Z_0 = \frac{A-E[A]}{\sqrt{Var(A)}}$</p>
<ul>
<li>we reject $H_0$ if $|Z_0| \gt z_{\alpha/2}$</li>
</ul>
<p>Failure to reject the hypothesis of independence occurs when</p>
<ul>
<li>$-z_{\alpha/2} \le Z_0 \le z_{\alpha/2}$, where the $\alpha$ is the level of significance</li>
</ul>
<blockquote><p><font color="red"> RUN Test - above and below the mean </font></p>
</blockquote>
<ul>
<li>Let $n_1$ and $n_2$ be the number of individual observations above and below the mean, let b the total number of runs</li>
<li>For a given $n_1$ and $n_2$, the mean and variance of b can be expressed as<br/>
$ \mu_b = \frac{2 n_1 n_2}{N} + \frac{1}{2} $ and $ \sigma_b^2 = \frac{2n_1 n_2 (2n_1 n_2 - N)} {N^2 (N-1)}$</li>
</ul>
<p>For either $n_1$ or $n_2$ greater than 20, b is approximately normally distributed<br/>
$\large Z_0 = \frac{b - (2n_1 n_2 / N) - 1/2} { [\frac{2n_1 n_2 (2 n_1 n_2 - N)} {N^2 (N-1)} ]^{1/2}}$</p>
<p>The test stat is given by $Z_0 = \frac{B-\mu_b}{\sqrt{\sigma_b^2}}$</p>
<ul>
<li>reject $H_0$ if $|Z_0| \gt z_{\alpha/2}$</li>
<li>Failure to reject the hypothesis of independence occurs when <ul>
<li>$-z_{\alpha/2} \le Z_0 \le z_{\alpha/2}$, where $\alpha$ is the level of significance</li>
</ul>
</li>
</ul>
<blockquote><p><font color="red"> Correlation Test </font></p>
</blockquote>
<p>Assuming that the $R_i's$ are all $Unif(0,1)$, Let's conduct a correlation test for $H_0: R_i's$ independent<br/>
We define the <em>Lag-1 correlation</em> of the $R_i's$ by $\rho \equiv Corr(R_i,R_{i+1})$.</p>
<ul>
<li>Ideally $\rho$ should equal 0.   </li>
</ul>
<p>A good estimator for $\rho$ is given by $\large \hat{\rho} \equiv \left( \frac{12}{n-1} \sum_{k=1}^{n-1} R_k R_{k+1}  \right) - 3$</p>
<p>Under $H_0$: $\large \hat{\rho} \approx Normal\left( 0, \frac{13n - 19}{(n-1)^2} \right)$</p>
<p>The test statistic is given by: $Z_0 = \hat{\rho} / \sqrt{Var(\hat{\rho})} $<br/>
and we reject when $|Z_0| \gt z_{\alpha/2}$</p>
<p><img src="ISYE6644_images/MOD6-06.png" width="400;"/></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M7-RV-Generation">M7-RV Generation<a class="anchor-link" href="#M7-RV-Generation">¶</a></h2><p>In this section we will look at methods to generate random variates from any distribution. We will look at multiple methods to generate observations from any distribution, and even stochastic processes. All of this is fundamentally driven by the previous section to generate PRNs from a U(0,1).</p>
<p>Ideally we want this to be fast, and reproducible.</p>
<h3 id="Inverse-Transform-Theorem">Inverse Transform Theorem<a class="anchor-link" href="#Inverse-Transform-Theorem">¶</a></h3><p><strong>Inverse Transform Theory</strong> Let X be a continuous random variable with cdf F(x) then $F(x) \sim U(0,1)$. This should be intuitively true to even the casual learner as the CDF must converge to 1 in order for the underlying pdf to be a valid distribution.</p>
<p><strong>Proof:</strong><br/>
Let $Y=F(x)$ and suppose that Y has cdf G(y)<br/>
then $G(y) = Pr(Y \le y ) = P(F(x) \le y) = P(x \le F^{-1}(y))$<br/>
thus $G(y) = F(F^{-1}(y)) = y$</p>
<p><strong>Application</strong><br/>
Let $U \sim U(0,1)$. Then F(X)=U implies that $F^{-1}(U)$ has the same distribution as X</p>
<p><strong>Algorithm</strong></p>
<ul>
<li>sample U from U(0,1)</li>
<li>Return $X = F^{-1}(U)$</li>
</ul>
<p>Illustration from wikipedia<br/>
<img src="ISYE6644_images/MOD7-01.png" width="400;"/></p>
<p><strong>Examples</strong></p>
<ul>
<li>Uniform $F^{-1}(U) \to X = a + (b - a)U $</li>
<li>Exponential $F^{-1}(U) \to A = -(1/\lambda) ln(1-U)$ (recall than Ln(1-U) is equivalent to ln(U) when U is between 0, and 1</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Further-examples">Further examples<a class="anchor-link" href="#Further-examples">¶</a></h3><p><strong>$\color{red}{Weibull}$</strong></p>
<ul>
<li>$F(x) = 1-e^{-(\lambda x)^{\beta}}$</li>
<li>$X = F^{-1}(U) = \frac{1}{\lambda} [-ln(u)]^{1/\beta}$</li>
</ul>
<p><strong>$\color{red}{Triangular}$</strong></p>
<ul>
<li>pdf: $f(x) = \begin{cases}
x &amp; \text{ if } 0 \le x \lt 1 \\
2-x &amp; \text{ if } 1 \le x \le 2 \\
\end{cases}$</li>
<li>cdf: $F(x) = \begin{cases}
x^2 / 2 &amp; \text{ if } 0 \le x \lt 1 \\
1-(x-2)^2 / 2 &amp; \text{ if } 1 \le x \le 2 \\
\end{cases}$</li>
<li>for U &lt; 0.5 solve $x^2 / 2$ to get $X = \sqrt{2U}$</li>
<li>for U &gt; 0.5 we solve for the root $1-(x-2)^2 / 2$ which has only one at $X=2-\sqrt{2(1-U)}$</li>
</ul>
<h3 id="Discrete-Examples">Discrete Examples<a class="anchor-link" href="#Discrete-Examples">¶</a></h3><p><strong>$\color{red}{Bernoulli}$</strong></p>
<ul>
<li>Construct a simple backwards table  
<pre><code>x  P(X=x)  U(0,1)
0   1-p    [0,p]   if U &lt;= p then X = 0
1     p    (p,1)   if U  &gt; p then X = 1</code></pre>
</li>
</ul>
<p>this can also be used for more complex tables</p>
<pre><code> x    P(X=x)  F(x)  U(0,1)
-1      0.6   0.6   [0.0,0.6]  if U &lt;= .6 then X = -1
 2.5    0.3   0.9   (0.6,0.9]  if .6 &lt; U &lt;= .9 then X = 2.5
 4      0.1   1.0   (0.9,1.0]  if .9 &lt; U &lt;= 1. then X = 4</code></pre>
<p><strong>$\color{red}{Geometric}$</strong></p>
<ul>
<li>$f(k) = q^{k-1} p$</li>
<li>$F(k)=1-q^k$</li>
<li>$X = F^{-1}(U) = min(k;1-q^k \ge U) =  \lceil \frac{\ln(1-U)}{ln(1-p)} \rceil = \lceil \frac{\ln(U)}{ln(1-p)} \rceil$</li>
</ul>
<h3 id="Empiral-Distributions">Empiral Distributions<a class="anchor-link" href="#Empiral-Distributions">¶</a></h3><p>What happens when we have some data from an unknown continuous distribution?</p>
<p>If you can't find a good theoretical distribution to model a certain RV, you may want to use the empirical cdf of the data $X_1,X_2,...,X_n$.<br/>
$$\hat{F}_n(x) = \frac{count(X_i) \le x}{n}$$</p>
<p>Note that $\hat{F}_n(x)$ is a step function with jumps of height 1/n every time an observation occurs. However, even though X is continuous, the Glivenko-Cantelli lemma says that $\hat{F}_n(x) \rightarrow F(x)$ for all x as $n \to \infty$. So $\hat{F}_n(x)$ is a good approximation to the true cdf F(x).</p>
<p>Using ARENA functions DISC and CONT provide the ability to generate RV's from the empirical CDFs of discrete and continuous distributions, respectively.</p>
<p>To do this manually</p>
<ul>
<li>first define the ordered points <ul>
<li>$X_{(1)} \le X_{(2)} \le \cdots X_{(n)} $</li>
<li>ie if $x1=4,x2=1,x3=6$ then $X_{(1)}=1; X_{(2)}4; X_{(3)}=6$</li>
</ul>
</li>
</ul>
<p>Given that we only have a finite number n of data points we can turn the empirical cdf into a continuous RV by using linear interpolation between the $X_{(i)}'s$</p>
<p>$\large
F(x) = \begin{cases}
0 &amp; \text{ if } x \lt X_{(1)} \\
\frac{i-1}{n-1} + \frac{x-X_{(i)}}{(n-1)(X_{(i+1)} - X_{(i)})} &amp; \text{ if } X_{(i)} \le x \lt X_{(i+1)} \\
1 &amp; \text{ if } x \ge X_{(n)} \\
\end{cases}
$</p>
<ul>
<li>Set $F(X) = U \sim U(0,1)$; Let $P=(n-1)U$ and $I=\lceil P \rceil $</li>
<li>Solve to get $X = X_I + (P - I + 1)(X_{(I+1)} - X_{(I)})$<ul>
<li>where $X_I$ is some random starting pt</li>
<li>interestingly (P - I + 1) turns out to be Unif(0,1)</li>
</ul>
</li>
</ul>
<p>Example:</p>
<ul>
<li>Suppose $X_{(1)}=1; X_{(2)}4; X_{(3)}=6$, also U = 0.73</li>
<li>Then <ul>
<li>P=(n-1)U = 1.46 = (3-1)*0.73</li>
<li>I = ceil(p) = 2</li>
</ul>
</li>
<li>thus <ul>
<li>$X = X_I + (P - I + 1)(X_{(I+1)} - X_{(I)})$</li>
<li>$X = X_2 + (1.46 - 2 + 1)(X_{(3)} - X_{(2)})$</li>
<li>$X = 4 + (0.46)(6-4)$</li>
<li>$X = 4.92$</li>
</ul>
</li>
</ul>
<p><img src="ISYE6644_images/MOD7-02.png" width="400;"/></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Convolution-Method">Convolution Method<a class="anchor-link" href="#Convolution-Method">¶</a></h3><p>Here Convolution really just means summation of RV's to produce another RV (albeight related). This is not the same convolution you may have encountered in signal or image processing studies.</p>
<p><strong>$\color{red}{Binomial}$</strong><br/>
Recall that the Binomial is just the summation of bernoulli RVs</p>
<ul>
<li>ie $Y = \sum X_i \sim Bin(n,p)$ where $X_i \sim bern(p)$ and iid</li>
<li>So using the Inverse Transform generate some bernoulli's then sum them up</li>
<li>Ex $Y \sim Bin(3,0.4)$ <ul>
<li>u1=0.63, u2=0.17, u3=0.81</li>
<li>then Y = 0+1+0 = 1</li>
</ul>
</li>
</ul>
<p><strong>$\color{red}{Triangular}$</strong><br/>
Recall that the sum of Uniform(0,1) is Triangular(0,1,n)</p>
<ul>
<li>ie $Y = U_1 + U_2 \sim Tri(0,1,2)$ where $U_i \sim U(0,1)$</li>
<li>this is faster and easier than using the inverse transform for triangular</li>
</ul>
<p><strong>$\color{red}{Erlang}$</strong><br/>
Recall that $Erlang(n,\lambda)$ is the summation of n exponentials with rate = $\lambda$</p>
<ul>
<li>$Y = \sum X_i = \sum \left[ \frac{-1}{\lambda} ln(U) \right] = \frac{-1}{\lambda} ln\left( \prod U_i \right)$</li>
</ul>
<p><strong>$\color{red}{NegBinomial}$</strong></p>
<ul>
<li>if $X_1,...,X_n$ are iid Geometric(p) </li>
<li>then $\sum X_i \sim NegBin(n,p)$</li>
</ul>
<p><strong>$\color{red}{Chi-squared}$</strong></p>
<ul>
<li>if $Z_1,...,Z_n$ are iid Normal(0,1)</li>
<li>then $\sum Z_i^2 \sim \chi^2(n)$</li>
</ul>
<p><strong>$\color{red}{Cauchy}$</strong></p>
<ul>
<li>if $X_1,...,X_n$ are iid Cauchy</li>
<li>then $\bar{X} \sim Cauchy$ yay????</li>
</ul>
<h3 id="Acceptance-Rejection-Method">Acceptance-Rejection Method<a class="anchor-link" href="#Acceptance-Rejection-Method">¶</a></h3><p>Majority of cdf's cannot be inverted efficiently. AR samples from a distribution "almost" or similar to the one we want, and then adjusts it by "accepting" only a certain proportion of this samples.</p>
<p>As an example let's consider U(2/3,1). Normally we would use the inverse tranform method but we will develop the AR method to help build intuition.</p>
<ul>
<li>generate $U \sim U(0,1)$</li>
<li>if $U \ge 2/3$ we accept and $X \leftarrow U$<ul>
<li>else we reject </li>
</ul>
</li>
<li>go back to 1 and repeat the desired number of times</li>
</ul>
<p>Suppose we wish to simulate a continuous RV X with some pdf f(x). But for whatever reason f(x) is too difficult to generate directly. Further suppose that we can generate a RV with pdf h(x) = t(x)/c where t(x) majorizes f(x).</p>
<ul>
<li>ie t(x) majorizes f(x) implies<ul>
<li>$t(x) \ge f(x)$ </li>
<li>and $c = \int_{-\infty}^{\infty} t(x) dx \ge \int_{-\infty}^{\infty} f(x) dx = 1 $</li>
<li>where c is less than infinity</li>
</ul>
</li>
</ul>
<p><strong>Theorem</strong><br/>
Define g(x) = f(x)/t(x) and note that 0 &lt;= g(x) &lt;= 1 for all x. Let $U \sim U(0,1)$ and let Y be an RV, independent of U, with pdf h(y)=t(y)/c. if $U \le g(Y)$ then Y has conditional pdf f(y).</p>
<p>This suggests the following AR Algorithm</p>
<ul>
<li>repeat<ul>
<li>generate U(0,1) </li>
<li>generate Y from h(y) (indep of U)</li>
</ul>
</li>
<li>until $U \le g(Y) = \frac{f(Y)}{t(Y)} = \frac{f(Y)}{c h(Y)}$    </li>
<li>Return $X \leftarrow Y$</li>
</ul>
<p><img src="ISYE6644_images/MOD7-03.png" width="400;"/></p>
<p><strong>Proof</strong><br/>
Won't be responsibile for this but it is good to know.</p>
<p>Let A be the Acceptance Event. Then the cdf of X is<br/>
$\large P(X \le x) = P(Y \le x|A) = \frac{P(A,Y \le x)}{P(A)} \text{ (1) }$</p>
<p>Then<br/>
$\begin{split} 
P(A|Y=y) &amp;= P(U \le g(Y) | Y=y)  \\
&amp;= P(U \le g(y) | Y=y) \\
&amp;= P(U \le g(Y) &amp; \text{since U and Y are indep} \\
&amp;= g(y) &amp; \text{ U is uniform - (2)}
\end{split}$</p>
<p>Now by the Law of Total Probability<br/>
$\begin{split} 
P(A|Y \le x) &amp;= \int_{-\infty}^{\infty} P(A,Y \le x | Y = y) h(y) dy \\
&amp;= \int_{-\infty}^{x} P(A,Y = y) h(y) dy \\
&amp;= (1/c) \int_{-\infty}^{x} P(A,Y = y) t(y) dy \\
&amp;= (1/c) \int_{-\infty}^{x} g(y) t(y) dy  &amp; \text{from previous result above} \\
&amp;= (1/c) \int_{-\infty}^{x} f(y) dy &amp; \text{ (3) }
\end{split}$</p>
<p>Letting $x \rightarrow \infty$ we get<br/>
$\large P(A) = (1/c) (1/c) \int_{-\infty}^{\infty} f(y) dy = 1/c \text{ (4) } $</p>
<p>Putting it all together (1),(3),(4)<br/>
$\large  P(X \le x) = \frac{P(A,Y \le x)}{P(A)} = \int_{-\infty}^{x} f(y) dy$</p>
<p>thus the pdf of X is f(x)</p>
<p>There are two issues when using this</p>
<ul>
<li>The ability to quickly sample from h(y)</li>
<li>c must be small, ie t(x) must be close to f(x) since $P(U \le g(Y)) = 1/c$<ul>
<li>and the number of trials until success ($U \le g(Y)$) is Geom(1/c), </li>
<li>so the mean number of trials is c</li>
</ul>
</li>
</ul>
<p>Let's now take a look at some examples</p>
<h3 id="Ex1-Complex-Function">Ex1-Complex Function<a class="anchor-link" href="#Ex1-Complex-Function">¶</a></h3><p>Let's generate a RV with a pdf of $f(x) = 60 x^3 (1-x)^2$ over $0 \le x \le 1$. I'll save you the effort and tell you that this cannot be inverted using analytical methods</p>
<p>Use your favourite approach to find that the max occurs at x=0.6 with a value f(0.6)=2.0736. We will take this as our majorizer t(x).</p>
<p>Now get $c = \int_0^1 t(x) dx = 2.0736$<br/>
so find that $h(x)=t(x)/c = 1$ so h(x) is a Unif(0,1)<br/>
Now $\large g(x) = \frac{f(x)}{t(x)} = \frac{60 x^3 (1-x)^2}{20.736}$</p>
<p>so now we generate a random U(0,1), as a random Y (which in our case is just another U(0,1)<br/>
(say U=0.13 and Y = 0.25)</p>
<p>Now we plug y into g(x), ie compute g(Y). You should find that U &lt;= g(Y) so we accept $X = 0.25$ as a Random variate.</p>
<h3 id="Ex2-Half-Normal">Ex2-Half Normal<a class="anchor-link" href="#Ex2-Half-Normal">¶</a></h3><p>Consider a standard <em>half-normal</em> RV with pdf<br/>
$\large f(x) = \frac{2}{\sqrt{2\pi}} e^{-x^{2} /2 } \; x \ge 0$</p>
<p>we will use the following majorizing function<br/>
$\large t(x) = \sqrt{\frac{2e}{\pi}} e^{-x} \; x \ge 0$<br/>
with $\large c = \int_0^{-\infty} t(x) dx = \sqrt{\frac{2e}{\pi}}$</p>
<p>Thus $h(x) = e^{-x}$ which is easy to sample from<br/>
and $g(x) = e^{-(x-1)^2 / 2 } $</p>
<p>We can build upon this to generate Normal Random Variates!!!!</p>
<ul>
<li>Gen U(0,1) as usual</li>
<li>Gen X from the half normal (above) </li>
<li>if $U \le 0.5$ then take -X</li>
<li>elif $U \ge 0.5$ then take X</li>
</ul>
<p>Reminder to get $N(\mu,\sigma^2)$ we just apply the transform $\mu + \sigma Z$</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Normal">Normal<a class="anchor-link" href="#Normal">¶</a></h3><p>Using Inverse Transform:</p>
<ul>
<li>Suppose you want to generate samples from $X \sim N(3,16)$ and you have U = 0.59</li>
<li>then take $X \leftarrow \mu + \sigma Z$ where $Z \sim N(0,1)$</li>
<li>ie $X = \mu + \sigma Z = 3 + 4 N(0,1;0.59) = 3+4(0.2275) = 3.91$</li>
</ul>
<p>Crude desert island N(0,1)<br/>
Suppose $U_1,...,U_n$ are iid U(0,1) and let $Y=sum U_i$<br/>
For a large n the Central Limit Theorem implies that $Y \approx N(n/2,n/12)$<br/>
So for say n = 12 (pretend this is large)</p>
<ul>
<li>$Y-6 = \sum_1^{12} U_i - 6 \approx N(0,1)$</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M7-RV-Gen-Continued">M7-RV Gen Continued<a class="anchor-link" href="#M7-RV-Gen-Continued">¶</a></h2><h3 id="Ex3-Poisson">Ex3-Poisson<a class="anchor-link" href="#Ex3-Poisson">¶</a></h3><p>Recall: <strong>Poisson Distribution</strong> $P(X=n) = e^{-\lambda} \frac{\lambda^n}{n!}$</p>
<p>We'll use a variation of the AR method to generate a realization of X. The algo will go through a set of equivalence statements to arrive at a rule that gives X=n. Recall that by definition, X=n if we observe exactly n arrivals from a $Poisson(\lambda)$ process in one time unit.</p>
<p>Define $A_i$ as the i'th interarrival time from a $Pois(\lambda)$ distribution.</p>
<p>$\begin{split}
X=n &amp; \iff \text{ there are exactly n } Poisson(\lambda) \text{ arrivals by time t=1 } \\
&amp; \iff \sum_1^n A_i \le 1 \lt \sum_1^{n+1} A_i &amp; \text{ NB the n+1'th arrival is after t=1 } \\
&amp; \iff \sum_1^n \left[\frac{-1}{\lambda} ln(U_i) \right]  \le 1 \lt \sum_1^{n+1} \left[\frac{-1}{\lambda} ln(U_i) \right] \\
&amp; \iff \frac{-1}{\lambda} ln\left( \prod_1^n U_i \right) \le 1 \lt ln\left( \prod_1^{n+1} U_i \right) \\
&amp; \iff \prod_1^{n} U_i \ge e^{-\lambda} \gt \prod_1^{n+1} U_i &amp; \text{(5)}
\end{split}$</p>
<p>To apply the result we create a simple algo that samples U(0,1)'s until the final statement is true. ie until $e^{-\lambda} \gt \prod_1^{n+1} U_i$ is true.</p>
<p>Algo:</p>
<pre><code>a &lt;-  e^(-\lambda)
p &lt;-  1
X &lt;- -1

while(p &lt; a)
    U &lt;- generate U(0,1)
    p &lt;- p*U
    X &lt;- X + 1

Return X</code></pre>
<p>Example: Poisson(2); t/f lambda=2; e^(-2) = 0.1353</p>
<pre><code>n  Ui      prod_Ui's   Stop
0  0.3911  0.3911      N
1  0.9451  0.3696      N
2  0.5033  0.1860      N
3  0.7003  0.1303      Y  since 0.1303 &lt; 0.1353

Take X = 3</code></pre>
<p>Remarks:</p>
<ul>
<li>the expected number of U's needed to generate one realization of X is $E[X+1]=\lambda + 1$    </li>
<li>if $\lambda \ge 20$ then we can use the normal approximation $\frac{X - \lambda}{\sqrt{\lambda}} \apprx N(0,1)$</li>
</ul>
<p>Algo (for $\lambda \ge 20$):</p>
<pre><code>Generate Z from N(0,1)
Return X = max(0,floor(\lambda + sqrt(\lambda)*Z + 0.5)) "Continuity Correction"

Ex 
if \lambda=30, Z=1.46
then X = max(0,floor(30 + sqrt(30)*1.46 + 0.5)) = 38</code></pre>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Composition">Composition<a class="anchor-link" href="#Composition">¶</a></h3><p>Composition is most useful when you are faced with a mixture of RV's</p>
<p>Suppose an RV comes from, or is composed of, two or more RVs, such as flight delay due to maintenence delay and air traffic delay. How can we generate such a RV?</p>
<p>Let's define a formal structure<br/>
Our goal is to generate a RV with a cdf like $F(x)=\sum_1^{\infty} p_j F_j(x)$<br/>
where $p_j &gt; 0$ for all j, and $\sum p_j=1$ and the $F_j(x)'s$ are easy cdf's that we can sample from.<br/>
then</p>
<ul>
<li>generate a positive integer J such that $P(J=j)=p_j$ for all j</li>
<li>return X from the cdf $F_j(x)$</li>
</ul>
<p>Proof that X has cdf F(x):<br/>
$\begin{split}
P(X \le x) &amp; = \sum_1^{\infty} P(X \le x | J = j) P(J=j) \\
&amp; = \sum_1^{\infty} p_j F_j(x) \\
&amp; = F(x)
\end{split}$</p>
<p>Example: LaPlace distribution, as Exponential reflected off the y-axis</p>
<pre><code>f(x) = 0.5e^(x)  when x &lt; 0
     = 0.5e^(-x) when x &gt; 0

F(x) =   0.5e^(x)  when x &lt; 0
     = 1-0.5e^(-x) when x &gt; 0

Meanwhile we decompose X into a negative exponential and a regular distribution
F_1(x) = e^x if x &lt; 0   Negative exp cdf
       = 1   if x &gt; 0
F_2(x) = 0     if x &lt; 0 Regular exp cdf
       = 1-e^x if x &gt; 0

Then 
F(x) = 0.5F_1 + 0.5F_2

Now we can use the inverse transform 
F_1 = e^(x) = U
F_2 = 1-e^(-x) = U

thus
X  &lt;-  ln(u)  with probability 1/2 
   &lt;- -ln(u)  with probability 1/2</code></pre>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Box-Muller">Box-Muller<a class="anchor-link" href="#Box-Muller">¶</a></h3><p>An easy way to generate standard normal</p>
<p>Theorem: If $U_1,U_2$ are iid U(0,1), then</p>
<ul>
<li>$Z_1 = \sqrt{-2ln(U_1)} cos(2\pi U_2)$     </li>
<li>$Z_2 = \sqrt{-2ln(U_1)} sin(2\pi U_2)$<br/>
are iid N(0,1)</li>
</ul>
<p>(Warning this must be done in radians)</p>
<p>Corollaries of the Box-Muller:</p>
<ol>
<li><p>Recall $Z_1^2 + Z_2^2 \sim \chi^2(1) + \chi^2(1) \sim \chi^2(2)$</p>
<ul>
<li>but BM tells us $Z_1^2 + Z_2^2 = -2 ln(U_1) (cos^2(2\pi U_2) + sin^2(2\pi U_2) ) = -2ln(U_1)$</li>
<li>which you may recall is just exp(1/2) </li>
<li>thus $\chi^2(2) \sim Exp(1/2)$</li>
</ul>
</li>
<li><p>$Z_1/Z_2 = N(0,1)/N(0,1) \sim Cauchy \sim t(1)$</p>
<ul>
<li>but BM tells us $Z_1/Z_2 = \sqrt{-2ln(U_1)} cos(2\pi U_2) / \sqrt{-2ln(U_1)} sin(2\pi U_2) = tan(2\pi U_2)$</li>
<li>thus $t(1) \sim Cauchy \sim tan(2\pi U_2)$</li>
<li>incidentally $cot(2\pi U_2)$ works just as well</li>
</ul>
</li>
</ol>
<h3 id="Polar-Method">Polar Method<a class="anchor-link" href="#Polar-Method">¶</a></h3><p><img src="ISYE6644_images/MOD7-04.png" width="500;"/></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Order-Statistics">Order Statistics<a class="anchor-link" href="#Order-Statistics">¶</a></h3><p>How to generate order statistics efficiently.</p>
<p>Suppose that $X_1,X_2,...,X_n$ are iid RV's from some distribution with cdf F(x) and let $Y=min{X_1,X_2,...,X_n}$ with cdf G(y). In this scenario Y is called a first order statistic.</p>
<p>Q: Can we generate Y using just one U(0,1)?<br/>
A: Yes, since the $X_i's$ are iid we have<br/>
$\begin{split}
G(y) &amp; = 1-P(Y \gt y) \\
&amp; = 1-P(min(X_i) \gt y) \\
&amp; = 1-P(all(X_i) \gt y) \\
&amp; = 1-[P(X_1 \gt y)]^n \\
&amp; = 1-[1-F(y)]^n \\
\end{split}$</p>
<p>Now we apply the inverse transform.<br/>
Let G(Y) = U<br/>
Then $Y = F^{-1}(1-(1-U)^{1/n})$</p>
<p>Example: Suppose $X_1,X_2,...,X_n \sim Exp(\lambda)$<br/>
Then $G(y) = 1-(e^{-\lambda y})^n = 1-e^{-n \lambda y }$<br/>
Thus $Y=min(X_i) \sim Exp(n\lambda)$<br/>
So we take $Y=\frac{-1}{n\lambda} ln(U)$</p>
<p>(Similarly you could take $Z=max_i(X_i)$</p>
<p>Helpful tidbits</p>
<ul>
<li>$\chi^2(n)$ distribution <ul>
<li>if $Z_1,Z_2,...,Z_n$ are iid N(0,1) then $\sum Z_i^2 \sim \chi^2(n)$</li>
</ul>
</li>
<li>Cauchy / t-distribution<ul>
<li>if $Z \sim N(0,1)$ and $Y \sim \chi^2(n)$ and X and Y are indep</li>
<li>then $\frac{Z}{\sqrt{Y/n}} \sim t(n)$</li>
</ul>
</li>
<li>F(n,m) distribution<ul>
<li>if $X \sim \chi^2(n)$ and $Y \sim \chi^2(m)$ and X and Y are indep </li>
<li>then $(X/n)/(Y/m) \sim F(n,m)$</li>
</ul>
</li>
</ul>
<h3 id="BiVariate-Normal">BiVariate Normal<a class="anchor-link" href="#BiVariate-Normal">¶</a></h3><p><img src="ISYE6644_images/MOD7-05.png" width="500;"/></p>
<h3 id="MultiVariate-Normal">MultiVariate Normal<a class="anchor-link" href="#MultiVariate-Normal">¶</a></h3><p><img src="ISYE6644_images/MOD7-06.png" width="500;"/></p>
<p>In order to generate $\textbf{X}$, Let's start with a vector $\textbf{Z} = (Z_1,...,Z_n)$ of iid N(0,1) RV's. Which means suppose $\textbf{Z} \sim N(0,I)$ where I is the k by k identity matrix, and 0 is just a 0 vector. Then we need to find the lower triangular Cholesky matrix C such that $\sum = CC^T$. It can be shown that $\textbf{X} = \mu + C \textbf{Z}$ is a multivariate normal with mean $\mu$ and covariance matrix</p>
<p>$\sum = E[(C\textbf{Z})(C\textbf{Z})^T] = E[C\textbf{Z}\textbf{Z}^T C^T] = C (E[\textbf{Z}\textbf{Z}^T])C^T=CC^T$</p>
<p><img src="ISYE6644_images/MOD7-07.png" width="500;"/></p>
<p>Once C has been computed the multiVariate Normal RV $X = \mu + C Z$ can be easily generated:</p>
<ol>
<li>Generate $Z_1,...,Z_k \sim N(0,1)$</li>
<li>Let $X_i \leftarrow \mu_i + \sum_{j=1}^i c_{ij}Z_j$ for i=1,2,3,...,k</li>
<li>Return $X = (X_1,...,X_k)$</li>
</ol>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Markov-Chains">Markov Chains<a class="anchor-link" href="#Markov-Chains">¶</a></h3><p>Consider a time series having a certain number of states, such as sunny/rainy, that can transition from day to day. For example on monday it's sunny, on tues rainny, and on wed it's rainny again. Informally speaking: If tomorrow's weather only depends in today then you have a <strong>Markov Chain.</strong></p>
<p>Simple Example:<br/>
Let $X_i=0$ if it rains on day i, else $X_i=1$ otherwise<br/>
We can denote the day-to-day transition probabilities as $P_{jk} = P(state=k, day=i+1 | state=j, day=i)$  for j,k = 0,1</p>
<p>Suppose that the probability state transitions is defined as<br/>
$\textbf{P} = \begin{pmatrix} 0.7 &amp; 0.3 \\ 0.4 &amp; 0.6 \end{pmatrix} = \begin{pmatrix} p00 &amp; p01 \\ p10 &amp; p11 \end{pmatrix}$</p>
<p>Given it rained on Monday how can we simulate the rest of the week?</p>
<pre><code>        P(R|X_i-1)   U_i   U_i&lt;P_*0  R/S
Mon      -            -       -       R
Tue      0.7         0.62     Y       R
Wed      0.7         0.03     Y       R
Thr      0.7         0.77     N       S  
Fri      0.4         0.91     N       S</code></pre>
<p><strong>$\color{red}{\text{Poisson Arrivals}}$</strong></p>
<p>When the arrival rate is a constant $\lambda$, the interarrivals of a Poisson($\lambda$) process are iid Exp($\lambda$), and the arrivals times are:<br/>
$T_0 \leftarrow 0$<br/>
$T_i \leftarrow T_{i-1} - \frac{1}{\lambda} ln(U_i) \; i \ge 1$</p>
<p><strong>$\color{red}{\text{Poisson Arrivals on a fixed interval}}$</strong></p>
<p>Now suppose that we want to generate a <em>fixed number n</em> of PP($\lambda$) arrivals in a <em>fixed time interval</em> [a,b]. To do so we note a theorem stating the the joint distribution of the n arrivals is the same as the joint distribution of the order statistics of n iid U(a,b) RV's.</p>
<ul>
<li>Generate iid $U_1,...,U_n$ from U(0,1)</li>
<li>Sort the $U_i's \; U_{(1)} \lt ... \lt U_{(n)}$ </li>
<li>Set the arrival times to $T_i \leftarrow a + (b-a) U_{i}$</li>
</ul>
<p>(Note PP just means Poisson Processes)</p>
<h3 id="Nonhomogeneous-Poisson-Processes-(NHPP)">Nonhomogeneous Poisson Processes (NHPP)<a class="anchor-link" href="#Nonhomogeneous-Poisson-Processes-(NHPP)">¶</a></h3><p>Nonhomogeneous Poisson Processes: What happens when the rate $\lambda$ changes over time, it is not constant.</p>
<p><strong>$\color{red}{\text{Nonstationary Poisson Arrivals}}$</strong></p>
<p>Same assumptions as a regular Poisson process except the arrival rate $\lambda$ isn't a constant, so stationary increments doesn't apply.</p>
<p>Let</p>
<ul>
<li>$\lambda(t)$= rate (intensity) function at time t</li>
<li>$N(t)$=number of arrivals during [0,t]</li>
</ul>
<p>then</p>
<ul>
<li>$N(s+t) - N(s) \sim Poisson(\int_s^{s+t} \lambda(u) du)$</li>
</ul>
<p><strong>Example:</strong> Suppose that the arrival pattern to the Waffle House over a certain time period is an NHPP with $\lambda(t)=t^2$. Find the probability that there will be exactly 4 arrivals between times t=1 and 2.</p>
<p>Using our above formula</p>
<ul>
<li>$N(1+1) - N(1) \sim Poisson(\int_1^{2} \lambda(u) du) = Poisson(\int_1^{2} t^2 du) \sim Poisson(7/3)$</li>
</ul>
<p>Thus</p>
<ul>
<li>$P(N(2)-N(1) = 4) = \frac{e^{-7/3} (7/3)^4}{4!} = 0.120$</li>
</ul>
<p><strong>$\color{red}{\text{Thinning Algorithm}}$</strong></p>
<p><img src="ISYE6644_images/MOD7-08.png" width="400;"/></p>
<p>point 3 describes the thinning nature of the algo. It thins out the arrivals by only keeping the best one.</p>
<p>$T_0 \leftarrow 0;$<br/>
$i \leftarrow 0;$</p>
<p>Repeat:</p>
<ul>
<li>$t \leftarrow T_i$    </li>
<li>Repeat<ul>
<li>gen U,V from U(0,1)</li>
<li>$t \leftarrow t-\frac{1}{\lambda^*} ln(U)$ Each t-update represents a potential arrival (at rate $\lambda^*$)</li>
<li>UNTIL $V \le \lambda(t)/\lambda^*$ But we only keep the potential arrival with probability $\lambda(t)/\lambda^*$</li>
</ul>
</li>
<li>$i \leftarrow i+1$</li>
<li>$T_i \leftarrow t$ These $T_i's$ are the arrivals that we end up keeping  </li>
</ul>
<p>For a great demo see the excel</p>
<ul>
<li>Module07 - NHPP Demo-1.xlsx</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Time-Series">Time Series<a class="anchor-link" href="#Time-Series">¶</a></h3><p>Our goal is to illustrate various time series processes. We’ll be doing standard normal noise “ARMA” processes + a more-obscure “ARP” process with Pareto noise.</p>
<p><strong>$\color{red}{\text{First Order Moving Average Process}}$</strong></p>
<p>An MA(1) is a time series process defined by $Y_i=\epsilon_i + \theta \epsilon_{i-1}$ for i=1,2,.... Where $\theta$ is a constant and $\epsilon_i's$ are iid N(0,1) that are independent of $Y_0$. MA(1) is a popular tool for modeling and detecting trends.</p>
<p>MA(1) also has a covariance function $Var(Y_i)=1+\theta^2$,<br/>
$Cov(Y_i,Y_{i+1}) = Cov(\epsilon_i + \theta \epsilon_{i-1}, \epsilon_{i+1} + \theta \epsilon_{i})=\theta Var(\epsilon_{i})=\theta$<br/>
and $Cov(Y_i,Y_{i+k})=0$ for $k \ge 2$ (Meaning the covariances diminish quickly)</p>
<p>How to generate?</p>
<ul>
<li>Start with $\epsilon_0 \sim N(0,1)$, </li>
<li>then generate $\epsilon_1 \sim N(0,1)$ to get $Y_1$</li>
<li>then generate $\epsilon_2 \sim N(0,1)$ to get $Y_2$</li>
<li>etc etc</li>
</ul>
<p><strong>$\color{red}{\text{First Order AutoRegressive Process}}$</strong></p>
<p>An AR(1) process is defined by $Y_i=\phi Y_{i-1} + \epsilon_{i}$ for i=1,2,....; where $-1 \lt \phi \lt 1$, $Y_0 \sim N(0,1)$ and the $\epsilon_i's$ are iid. $Nor(0,1-\phi^2)$ RVs that are indep of $Y_0$. This is used to model lots of real world stuff.</p>
<p>The AR(1) has covariance function $Cov(Y_i,Y_{i+k})=\phi^{|k|}$ for all $k=0, \pm 1, \pm 2$</p>
<p>if $\phi$ is close to one, you should get highly positively correlated $Y_i's$. If $\phi$ is close to zero, the $Y_i's$ are nearly independent.</p>
<p>How to generate?<br/>
Start with $Y_0 \sim N(0,1)$</p>
<ul>
<li>Then generate $\epsilon_1 \sim \sqrt{1-\theta^2}N(0,1)$ to get $Y_1 = \phi Y_0 + \epsilon_1$             </li>
<li>Then generate $\epsilon_2 \sim \sqrt{1-\theta^2}N(0,1)$ to get $Y_2 = \phi Y_2 + \epsilon_2$             </li>
</ul>
<p><strong>$\color{red}{\text{ARMA(p,q) Process}}$</strong></p>
<p>A generalization of the MA(1) and AR(1) processes is a ARMA(p,q). It consists of a p'th order AR and q'th order MA which is defined as</p>
$$\large Y_i=\sum_{j=1}^p \phi_j Y_{i-j} + \epsilon_{i} + \sum_{j=1}^q \theta \epsilon_{i-1} \; i=1,2,.. $$<p>where $\phi_j's$ and $\theta_j's$ are chosen so as to assure that the process doesn't explode. Such processes are used in a variety of modeling and forecasting applications.</p>
<p><strong>$\color{red}{\text{Exponential AR Process}}$</strong></p>
<p>An EAR(1) process is defined by<br/>
$Y_i = \begin{cases} 
\phi Y_{i-1}  &amp; \text{ with probability } \phi \\
\phi Y_{i-1} + \epsilon_i  &amp; \text{ with probability } 1-\phi 
\end{cases}$<br/>
for i=1,2,...; where $0 \le \phi \lt 1, Y_0 \sim Exp(1)$ and the $\epsilon_i's$ are iid Exp(1) RVs independent of $Y_0$.</p>
<p>EAR(1) has the same covariance structure as the AR(1): $Cov(Y_i,Y_{i+k})=\phi^{|k|}$. However, it requires that $0 \le \phi \lt 1$</p>
<p><strong>$\color{red}{\text{ARP - AutoRegressive Pareto}}$</strong></p>
<p>Let's now consider how to generate a series of correlated Pareto RV's.</p>
<p><strong>Recall</strong> The Pareto is a heavy tailed distribution that has a variety of uses in statistical modeling. An R.V. X has the Pareto distribution with parameters $\lambda &gt; 0$ and $\beta &gt; 0$ if it has the cdf $F(x)=1-(\lambda/x)^{\beta}$</p>
<p>In order to obtain the ARP process we start with a regular AR(1) process with normal noise<br/>
$Y_i = \rho Y_{i-1} + \epsilon_i$ for i=1,2,...<br/>
where $-1 \lt \rho \lt 1 \; ; \; Y_0 \sim N(0,1) \; and \; \epsilon_i's \sim N(0,1-\rho^2)$ and indep of $Y_0$<br/>
(<strong>Note</strong> that $Y_0,Y_1,Y_2,...$ are marginally N(0,1) but correlated)</p>
<ol>
<li>Feed the ARP process into N(0,1) cdf $\Phi(\cdot)$ to obtain Unif(0,1) RV's <ul>
<li>ie $U_i = \Phi(Y_i)$ for k=1,2,</li>
</ul>
</li>
<li>Now feed the correlated $U_i's$ into the inverse of the Pareto cdf to obtain correlated Pareto RV's<ul>
<li>$\large X_i = F_X^{-1}(U_i)=F_X^{-1}(\Phi(Y_i)) = \frac{\lambda}{[1-\Phi(Y_i)]^{1/\beta}}$ for i=1,2,...</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Queueing">Queueing<a class="anchor-link" href="#Queueing">¶</a></h3><p>An easy way to generate some queueing RV's</p>
<p><strong>$\color{red}{\text{M/M/1 Queue}}$</strong></p>
<p>Consider a single-server queue with customers arriving according to a Poisson($\lambda$) process, standing in line with a FIFO discipline, and then getting served in an $Exp(\mu)$ amount of time.</p>
<p>Let $I_{i+1}$ denote the interarrival time between the i'th and (i+1)st customers; let $S_i$ be the i'th custoemrs service time; and let $W_i^Q$ denote the i'th customer's wait before service.</p>
<p>Lindley gives a very nice way to generate a series of waiting times for simple example (where you don't even need to worry about the exponential assumptions)<br/>
$W_{i+1}^Q = max\{ W_{i}^Q +S_i - I_{i+1}, 0 \} $</p>
<p>And similarly the total time in system $W_i = W_{i}^Q + S_i$ is<br/>
$W_{i+1}= max\{ W_{i} - I_{i+1}, 0 \} + S_i $</p>
<h3 id="Brownian-Motion">Brownian Motion<a class="anchor-link" href="#Brownian-Motion">¶</a></h3><p>Discovered by Brown analyzed rigorously by Einstien; mathematical rigor established by Wiener. Widely used in everything from financial analysis to queueing theory to statistics to other OR/IE application areas.</p>
<p>The stochastic process $\{ W(t), t \ge 0\}$ is a Brownian motion if:</p>
<ol>
<li>$W(0)=0$</li>
<li>$W(t) \sim N(0,t)$</li>
<li>$\{ W(t), t \ge 0\}$ has stationary and independent increments </li>
</ol>
<p>Increments: Anything like W(b)-W(a).<br/>
Stationary increments: The distribution of W(t+h)-W(t) only depends on h.<br/>
Independent increments: If $a \lt b \lt c \lt d$, then W(d)-W(c) is indep of W(b)-W(a).</p>
<p>So how do we generate a Brownian Motion Process? First we need to understand the theory behind it.</p>
<p>If $Y_1,Y_2,...$ is any seq of iid RV's with mean 0 and variance 1<br/>
Then <em>Donsker's</em> Central Limit Theorem says
$$\large \frac{1}{\sqrt{n}} \sum_{i=1}^{\lfloor nt \rfloor} Y_i \overset{d}\rightarrow W(t) \text{ as } n \rightarrow \infty$$</p>
<p>(Note that $\overset{d}\rightarrow$ denotes convergence in distribution n gets big, and $\lfloor \cdot \rfloor$ denotes the floor function)</p>
<p>So basically ... the Central Limit Theorem is just a special case of the above! What the theorem is really saying is that any set of random variables with mean 0 and variance 1 will converge under general conditions to the Standard Normal Distribution.</p>
<p>Finally we can construct a generator.</p>
<ul>
<li>Take $Y_i = \pm 1$ each with probability 0.5</li>
<li>Take n at least 100, t=1/n,2/n,...n/n and calculate W(1/n),W(2/n),...,W(n/n)<ul>
<li>alternatively you can just take $Y_i \sim N(0,1)$</li>
</ul>
</li>
<li>Construction    <ul>
<li>Pick a large value of n, and set W(0)=0</li>
<li>$\large W(\frac{i}{n}) = W(\frac{i-1}{n}) + \frac{Y_i}{\sqrt{n}}$</li>
</ul>
</li>
</ul>
<p><strong>Important Properties of BM's</strong></p>
<ul>
<li>BM is continuous everywhere, but has no derivatives</li>
<li>$Cov(W(s),W(t))=min(s,t)$</li>
<li>Area under W(t) is normal: $\int_0^1 W(t) dt \sim N(0,1/3)$    </li>
<li>A Brownian Bridge, B(t) is conditioned BM such that W(0)=W(1)=0.</li>
<li>$Cov(B(s),B(t))=min(s,t)-st$</li>
<li>$\int_0^1 B(t) dt \sim N(0,1/12)$</li>
</ul>
<p><strong>$\color{red}{\text{Geometric Brownian Motion}}$</strong></p>
<p>The process $S(t)=S(0)exp\{ (\mu - \sigma^2/2)t + \sigma W(t)\}, \; t \gt 0$ is often used to model stock prices where $\mu$ is related to the <em>drift</em> of the stock price, $\sigma$ is it's volatility, and $S(0)$ is the initial price.</p>
<p>In addition, we can use GBM to estimate option prices. Eg. a European call option permits its owner, who pays an up-front fee for the privilege, to purchase the stock at a pre-agreed strike price k, at a pre-determined expiry date T.</p>
<p>It's value is given by $\large e^{-rT} E[(S(T)-k)^+]$<br/>
Where $x^+ = max\{0,x\}$ and $\mu \leftarrow r$ is the "risk-free" interest rate</p>
<p>To estimate this expected value we can run multiple simulation replications of W(T) and $(S(T)-k)^+$ and then take the sample average of the $ e^{-rT} (S(T)-k)^+$ values.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M8-Input-Analysis">M8-Input Analysis<a class="anchor-link" href="#M8-Input-Analysis">¶</a></h2><p>This section tries to answer the question: What distribution should be used to model the inputs of a simulation.</p>
<p><strong>Goal:</strong> Use random variables in your simulation that adequately approximate what’s going on in the real world.<br/>
Examples:</p>
<ul>
<li>Interarrival times</li>
<li>Service times</li>
<li>Breakdown times
These RVs don’t just come out of thin air… you have to specify them… accurately!</li>
</ul>
<p>High-Level Game Plan</p>
<ul>
<li>Collect data for analysis.</li>
<li>Determine / estimate the underlying distribution (along with associated parameters), e.g., Nor(30,8).</li>
<li>Conduct a statistical test to see if your distribution is “approximately” correct.</li>
</ul>
<h3 id="Identifying-Distributions">Identifying Distributions<a class="anchor-link" href="#Identifying-Distributions">¶</a></h3><p>This Lesson: Some high-level, baby methods for looking at data and guessing at distributions.</p>
<p>Method 1: Take a large number of observations</p>
<ul>
<li>then it should converge to the true distribution.</li>
</ul>
<p>How to even start?</p>
<ul>
<li>Discrete vs. Continuous?</li>
<li>Univariate / Multivariate?</li>
<li>How much data available?</li>
<li>Are experts around to ask about nature of the data?</li>
<li><p>What if you don’t have much any data – can you at least guess at a good distribution?</p>
</li>
<li><p>Discrete?</p>
<ul>
<li>Bernoulli(p) (success prob p)</li>
<li>Binomial(n,p) (# successes in n Bern(p) trials)</li>
<li>Geometric(p) (# Bern(p) trials until 1st success)</li>
<li>Negative Binomial</li>
<li>Poisson(λ) (counts # arrivals over time)</li>
<li>Empirical (“sample” distribution)</li>
</ul>
</li>
<li>Continuous?<ul>
<li>Uniform (not much known from the data, except maybe min and max possible values)</li>
<li>Triangular (know min, max, “most likely” values)</li>
<li>Exponential(λ) (interarrival times from a Poisson process)</li>
<li>Normal (good model for heights, weights, IQs, sample means, etc.)</li>
<li>Beta (good for specifying bounded data)</li>
<li>Gamma, Weibull, Gumbel, lognormal (reliability data)</li>
<li>Empirical (“sample” distribution)</li>
</ul>
</li>
</ul>
<p><strong>Game Plan</strong></p>
<ul>
<li>Choose a “reasonable” distribution, and then test to see if it’s not too ridiculous.</li>
<li>Example: If you hypothesize that some data is normal, then the data should…<ul>
<li>Fall approximately on a straight line when you do graph it on a normal probability plot. </li>
<li>It should also pass goodness-of-fit tests for normality.</li>
</ul>
</li>
</ul>
<h3 id="Unbiased-Point-Estimation">Unbiased Point Estimation<a class="anchor-link" href="#Unbiased-Point-Estimation">¶</a></h3><p>Now let’s narrow down the parameters of the distributions. We’ll begin a series of lessons on point estimation. Cover unbiased estimation first. Some of this stuff was covered in Module 2, but we’ll do more now.</p>
<p><strong>Definition:</strong> A statistic is a function of the observations $X_1,...,X_n$ and not explicitly dependent on any unknown parameters.</p>
<p>Examples $\bar{X} = \frac{1}{n} \sum_1^n X_i \;,\; S^2 = \frac{1}{n-1} \sum_1^n (X_i - \bar{X})^2 $</p>
<p>Statistics are random variables. If we take two different samples, we would expect to get two different values of a statistic. A statistic is usually used to estimate some unknown parameter from the underlying probability distribution of the $X_i's$.</p>
<p>Examples of parameters: $\mu \; \sigma^2$</p>
<p>Let $X_1,...,X_n$ be iid RV's and let $T(X)=T(X_1,...,X_n)$ be a statistic based on the $X_i$'s. Suppose we use $T(X)$ to estimate some unknown parameter $\theta$. Then $T(X)$ is called a point estimator for $\theta$.</p>
<p>Examples: $\bar{X}$ is usually a point estimator for the mean $\mu = E[X_i]$ and $S^2$ is often a point estimator for the variance $\sigma^2 = Var(X_i)$.</p>
<p>It would be nice if $T(X)$ had certain properties:</p>
<ul>
<li>It's expected value should equal the parameter it's trying to estimate </li>
<li>It should have low variance.</li>
</ul>
<p><strong>Definition:</strong>  $T(X)$ is unbiased for $\theta$ if $E[T(X)]=\theta$.</p>
<p><strong>Theorem</strong><br/>
Suppose $X_1,...,X_n$ are iid anything with mean $\mu$.<br/>
Then $E[\bar{X}] = E[\frac{1}{n} \sum X_i] = \frac{1}{n} \sum E[X_i] = E[X_i] = \mu$</p>
<p>So $\bar{X}$ is always unbiased for $\mu$. That's why $\bar{X}$ is the sample mean.</p>
<p><strong>Example</strong><br/>
Suppose $X_1,...,X_n \sim Exp(\lambda)$ and iid. Then $\bar{X}$ is unbiased for $\mu=E[X_i]=1/\lambda$.<br/>
(<strong>Warning</strong> $1/\bar{X}$ is biased however for $\mu=1/\lambda$! Since $E[1/\lambda] \ne 1/E[\lambda] = \lambda$</p>
<p><strong>Theorem</strong><br/>
Suppose $X_1,...,X_n$ are iid anything with mean $\mu$ and variance $\sigma^2$<br/>
Then $\large E[S^2] = E[\frac{\sum (X_i - \bar{X})^2}{n-1}] = Var(X_i) = \sigma^2$<br/>
Thus $S^2$ is always unbiased for $\sigma^2$, which is why $S^2$ is called the sample variance</p>
<p><strong>Proof</strong><br/>
Suppose $X_1,...,X_n \sim Exp(\lambda)$ and iid. Then $S^2$ is unbiased for $Var(X_i)=1/\lambda^2$.</p>
<p>First observe that<br/>
$\large S^2 = \frac{\sum (X_i - \bar{X})^2}{n-1} = \frac{\sum X_i^2 - n \bar{X}^2}{n-1} = \frac{n}{n-1} (X_i^2 - \bar{X}^2) $</p>
<p>Since $E[X_1]=E[\bar{X}] \text{ and } Var(\bar{X})=Var(X_1)/n = \sigma^2/n $<br/>
$\large 
\begin{split}
E[S^2] 
&amp; = \frac{n}{n-1} (X_i^2 - \bar{X}^2) \\ 
&amp; = \frac{n}{n-1} (Var(X_1) + (E[X_1])^2) - Var(\bar{X}) - E[\bar{X_1}])^2    \\
&amp; = \frac{n}{n-1} (\sigma^2 - \sigma^2/n)  \\
&amp; = \sigma^2
\end{split}$<br/>
(Note however that S is <strong>biased</strong> for $\sigma$)</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Mean-Squared-Error">Mean Squared Error<a class="anchor-link" href="#Mean-Squared-Error">¶</a></h3><p>The mean squared error conbines an estimator's bias and variance</p>
<p>Good Estimator Properties:</p>
<ul>
<li>Low bias (difference between the estimator’s expected value and the true parameter value)</li>
<li>Low variance</li>
<li>Actually need to have BOTH.<ul>
<li>Low bias + high var = bad (meaningless noisy estimator)</li>
<li>Low var + high bias = bad (confident of wrong answer)</li>
</ul>
</li>
</ul>
<p><strong>Example</strong><br/>
Suppose that $X_1,...,X_n \overset{iid}\sim U(0,\theta)$ s.t. the pdf is $f(x)=1/\theta \;;\; 0 \lt x \lt \theta$<br/>
Consider two estimators $Y_1=2\bar{X} \text{ and } Y_2 = \frac{n+1}{n} max_{1\le i \le n} X_i$<br/>
Since $E[Y_1]=2E[\bar{X}]=2E[X_i]=\theta$ we see that $Y_1$ is unbiased for $\theta$<br/>
It is also the case that $Y_2$ is unbiased, but it takes a little more work to show this. As a first step we aim to get the cdf of $M = max_i X_i$</p>
<p>$\begin{split}
P(N \le y) 
&amp; = P(X_1 \le y \cup \cdots \cup X_n \le y) \\
&amp; = \prod_1^n P(X_i \le y) \\
&amp; = [P(X_i \le y)]^n \\
&amp; = [\int_0^y f_{X_1}(x) dx ]^n \\
&amp; = [\int_0^y 1/\theta dx ]^n \\
&amp; = (y/\theta)^n 
\end{split}$</p>
<p>Which implies that the pdf is $f_M(y)=\frac{d}{dy} (y/\theta)^n = \frac{ny^n-1}{\theta^n}$<br/>
Then $E[M]=\int_0^{\theta} y f_M(y) dy = \int_0^{\theta} \frac{ny^n}{\theta^n} = \frac{n\theta}{n+1}$</p>
<p>So we can clearly see that $Y_2 = (n+1)/n max_{1\le i \le n} X_i$ is unbiased for theta. So both $Y_1 \; and \; Y_2$ are unbiased for $\theta$, but which is better?</p>
<p>Let's compare variances. After similar algebra, we have $Var(Y_1) = (\theta^2)/3n$ and $Var(Y_2) = (\theta^2)/n(n+2)$<br/>
Thus $Y_2$ has much lower variance than $Y_1$.</p>
<p><strong>Define:</strong><br/>
The bias of an estimator T(X) is $Bias(T)=E(T)-\theta$<br/>
The mean squared error of T(X) is $MSE(T) = E[(T-\theta)^2]$</p>
<p><strong>Remark:</strong><br/>
After some algebra, we get an easier expression for MSE that conbines the bias and variance of an estimator.<br/>
$MSE(T)=Var(T)+(E(T)-\theta)^2$ where $(E(T)-\theta)^2$ denotes the bias<br/>
So the lower the MSE the better, even if there's a little bias</p>
<p><strong>Define</strong><br/>
The relative efficiency of $T_2$ to $T_1$ is given by $MSE(T_1)/MSE(T_2)$. If this quantity is &lt;1, then we'd want $T_1$</p>
<p><strong>Example</strong><br/>
Let $X_1,\cdots,X_n \overset{iid}\sim U(0,\theta)$<br/>
Two estimators $Y_1 = 2\bar{X}$ and $Y_2 = (n+1)/n max_i X_i$<br/>
Showed before $E[Y_1]=E[Y_2]=\theta$, Also $Var(Y_1)=(\theta^2)/3n$ and $Var(Y_1)=(\theta^2)/n(n+2)$</p>
<p>Thus $MSE(Y_1)=(\theta^2)/3n$ and $MSE(Y_1)=(\theta^2)/n(n+2)$ so $Y_2$ is better.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="M9-Output-Analysis">M9-Output Analysis<a class="anchor-link" href="#M9-Output-Analysis">¶</a></h2><p>Last Module: Discussed proper modeling techniques for the input RVs that drive a simulation.<br/>
This Module: What goes in must go out! Now we’ll analyze the output of the simulation.</p>
<h3 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">¶</a></h3><p>Steps in a Simulation Study</p>
<ul>
<li>Preliminary Analysis of System</li>
<li>Model Building</li>
<li>Verification &amp; Validation</li>
<li>Experimental Design &amp; Simulation Runs</li>
<li>Statistical Analysis of Output</li>
<li>Implementation</li>
</ul>
<p><strong>Why do we care about the output?</strong></p>
<p>Input processes driving a simulation are random variables (e.g., interarrival times, service times, and breakdown times). They must regard the output from the simulation as random. Runs of the simulation only yield estimates of measures of system
performance (e.g., the mean customer waiting time). These estimators are themselves random variables, and are therefore subject to sampling error. Sampling error must be taken into account to make valid inferences concerning system performance.</p>
<p><strong>Measures of Interest</strong></p>
<ul>
<li>Means — what is the mean customer waiting time? Means aren’t enough. If I have one foot in boiling water and one foot in freezing water, on average, I’m fine. So… </li>
<li>Variances — how much is the waiting time liable to vary?</li>
<li>Quantiles — what’s the 99% quantile of the line length in a certain queue?</li>
<li>Success probabilities — will my job be completed on time? Would like point estimators and confidence intervals for the above.</li>
</ul>
<p><strong>Problem:</strong> Simulations almost never produce raw output that is independent and identically distributed (i.i.d.) normal data.</p>
<p><strong>Example:</strong> Customer waiting times from a queueing system. . .</p>
<ol>
<li>Are not independent — typically, they are serially correlated. If one customer at the post office waits in line a long time, then the next customer is also likely to wait a long time.</li>
<li>Are not identically distributed. Customers showing up early in the morning might have a much shorter wait than those who show up just before closing time.</li>
<li>Are not normally distributed — they are usually skewed to the right (and are certainly never less than zero).</li>
</ol>
<p>Thus, it’s difficult to apply “classical” statistical techniques to the analysis of simulation output.</p>
<p>Raison d’Être: Give methods to perform statistical analysis of output from discrete-event computer simulations.</p>
<p><strong>Why all the fuss?</strong></p>
<ul>
<li>Beware – improper statistical analysis can invalidate all results.</li>
<li>Tremendous applications if you can get it right.</li>
<li>Lots of cool research problems out there.</li>
</ul>
<p>To facilitate the presentation, we identify two types of simulations with respect to output analysis:</p>
<ul>
<li>Finite-Horizon (Terminating) simulations – interested in shortterm performance</li>
<li>Steady-State simulations – interested in long-term performance</li>
</ul>
<p><strong>Finite-Horizon Simulations</strong></p>
<p>The termination of a finite-horizon simulation takes place at a specific time or is caused by the occurrence of a specific event.</p>
<p>Examples:</p>
<ul>
<li>Mass transit system during rush hour</li>
<li>Distribution system over one month</li>
<li>Production system until a set of machines breaks down</li>
<li>Start-up phase of any system — stationary or nonstationary</li>
</ul>
<p><strong>Steady-State Simulations</strong><br/>
The purpose of steady-state simulation is to study the long-run behavior of a system. A performance measure is a steady-state parameter if it is a characteristic of the equilibrium distribution of an output process.</p>
<p>Examples:</p>
<ul>
<li>Continuously operating communication system where the objective is the computation of the mean delay of a packet in the long run.</li>
<li>Distribution system over a long period of time.</li>
<li>Many Markov chains.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Mathematical-Interlude">Mathematical Interlude<a class="anchor-link" href="#Mathematical-Interlude">¶</a></h3><p>Let's now look at the math underpinning the theory. We'll look at a few examples illustrating the fact that things turn out a little differently when you don't have iid observations.</p>
<p>One simple assumption needs to be made</p>
<ul>
<li>Suppose $Y_1,...,Y_n$ are identically distributed with mean $\mu$<ul>
<li>note that they are NOT independent</li>
</ul>
</li>
<li>Such an assumption often applies in steady-state simulation</li>
</ul>
<p>Let's get properties of the sample mean and variance - these guys perform very well in the iid case, but still they require careful consideration in output analysis.</p>
<p><strong>$\color{red}{\text{ Properties of the Sample Mean }}$</strong></p>
<p>Recall that the sample mean is unbiased for the mean $\mu$</p>
<ul>
<li>ie $E[\bar{Y}_n] = \frac{1}{n} \sum_{i=1}^n E[Y_i] = \mu $</li>
</ul>
<p>Also recall the covariance function $R_k = Cov(Y_1,Y_{1+k}), \forall k $, then<br/>
$\begin{split} 
Var(\bar{Y}_n) &amp; = Cov(\bar{Y}_n,\bar{Y}_n) &amp; \text{ by definition }           \\
&amp; = \frac{1}{n^2} \sum_i \sum_j Cov(\hat{Y}_i,\hat{Y}_j)                       \\
&amp; = \frac{1}{n^2} \sum_i \sum_j R_{|i-j|}                    &amp; (1)             \\
&amp; = \frac{1}{n} \left[ R_0 + 2 \sum_{k=1}^{n-1} (1 - k/n) R_k \right]  &amp; (2)
\end{split}$</p>
<p><img src="ISYE6644_images/MOD9-01.png" width="400;"/></p>
<p>Equation (2) is higly important and will influence many of the subsequent sections.</p>
<ul>
<li>It relates the variance of the sample mean to the covariances of the process. </li>
<li>We may now use this to define<br/>
$\sigma_n^2 = n Var(\hat{Y}_n) = R_0 + 2 \sum_{k=1}^{n-1} (1 - k/n) R_k $</li>
</ul>
<p>We may also use it to define the related variance parameter<br/>
$\sigma^2 = \lim_{n\to\infty} \sigma_n^2  =* R_0 + 2 \sum_{k=1}^{\infty} R_k $</p>
<ul>
<li>where =* holds if the $R_k's$ decrease to 0 quickly as $k\to\infty$</li>
</ul>
<p>The variance parameter $\sigma^2$ is so pretty and turns up all over the place. Notice that if the $Y_i's$ are iid then for all $k \ne 0$ we have $R_k = 0$, in which case we have the familiar result $\sigma^2 = \sigma_n^2 = R_0 = Var(Y_1)$. But in the <strong>dependent</strong> case, $\sigma^2 = \sum_{k=-\infty}^{\infty} R_k$ adds in the effects of the covariances. In queueing applications, the covariances are positive and $\sigma^2 = \sigma_n^2 &gt;&gt; V(Y_1)$, which can be bigger than you might assume.</p>
<p>The ration $\sigma^2 / Var(Y_1)$ is sort of the number of $Y_i's$ needed to obtain the information equivalent to one "independent" observation.</p>
<p><strong>Warning:</strong> $\sigma_n^2 &gt;&gt; Var(Y_1)$ causes the classical confidence interval CI for the mean $\mu$ to misbehave.</p>
<p><strong>Example</strong><br/>
The first order Auto-regressive process is defined by<br/>
$ Y_i = \phi Y_{i-1} + \epsilon_i $<br/>
Where $-1 &lt; \phi &lt; 1$ and $Y_0 \sim N(0,1)$ and the $\epsilon_i's$ are iid $N(0,1-\phi^2)$ RV's that are independent of $Y_0$</p>
<p>Recall that the $Y_i's$ are all N(0,1) and $R_k = \phi^{|k|}; \forall k$<br/>
$\sigma^2 = \sum_{k=-\infty}^{\infty} \phi^{|k|} \frac{1+\phi}{1-\phi}$</p>
<p>So for $\phi=0.9$, we have $\sigma^2 = 19$</p>
<p><strong>$\color{red}{\text{ Properties of the Sample Variance }}$</strong></p>
$$\large S_Y^2 = \frac{1}{n-1} \sum_{i=1}^n ( Y_i - \bar{Y}_n)^2  $$
<pre><code> 

</code></pre>
<p>If $Y_1,...,Y_n$ are iid then $S_Y^2$ is unbiased for $R_0 = Var(Y_1)$. Moreover, $S_Y^2$ is also unbiased for $\sigma_n^2 = n Var(\bar{Y}_n) = R_0$ and $\sigma^2 = \lim_{n\to\infty} = R_0$.</p>
<p>But if the $Y_i's$ are dependent then $S_Y^2$ may not be such a great estimator for $V(Y_1), \; \sigma_n^2 \; or \; \sigma^2$.</p>
<p>So let's again suppose that $Y_1,...,Y_n$ are iid with mean $\mu$ and covariance $R_k$ and see what happens ... when we get the expected value of $S_Y^2$</p>
<p>$\begin{split}
E[S_Y^2] &amp; = \frac{1}{n-1} E\left[ \sum (Y_i - \bar{Y}_n)^2  \right]                                     \\
&amp; = \frac{1}{n-1} E\left[ \sum Y_i^2 - n\bar{Y}_n^2  \right]                                             \\
&amp; = \frac{n}{n-1} \left( E[Y_1^2] - E[\bar{Y}_n^2] \right)                                               \\
&amp; = \frac{n}{n-1} \left[ \{Var(Y_1)-(E[Y_1])^2 \} - \{Var(\bar{Y}_n)-(E[\bar{Y}_n])^2 \} \right]         \\
&amp; = \frac{n}{n-1} \left[ Var(Y_1) - Var(\bar{Y}_n) \right]  &amp; \text{ since } \mu=E[Y_1]=E[\bar{Y}_n]     \\
&amp; \text{Now let's assume that the Rk's &gt; 0 and apply Eq 2} \\
&amp; = \frac{n}{n-1} \left\{ R_0 - \frac{1}{n} \left[ R_0 + 2 \sum_{k=1}^{n-1} (1 - \frac{k}{n}) R_k \right] \right\}    \\
&amp; = R_0 - \frac{2}{n-1} \sum_{k=1}^{n-1} (1 - \frac{k}{n}) R_k \\
&amp; &lt; R_0 &lt;&lt; R_0 - 2 \sum_{k=1}^{n-1} (1 - \frac{k}{n}) R_k \\
\end{split}$</p>
<p>Collecting these results shows that: $E[S_Y^2] &lt; Var(Y_1) &lt;&lt; n Var(\bar{Y}_n) $<br/>
Thus, one should not use $S_Y^2 / n$ to estimate $Var(\bar{Y}_n)$.</p>
<p>What if you make a mistake and do use it?<br/>
Well a 100(1-$\alpha$)% CI for the mean iid of normal observations with an unknown variance<br/>
Should be $\mu \in \bar{Y}_n \pm t_{\alpha/2,n-1} \sqrt{S_Y^2 / n}$<br/>
Where $t_{\alpha/2,n-1}$ is the t-distribution quantile</p>
<p>But since $E[S_Y^2 / n] &lt;&lt; Var(\bar{Y}_n)$, the CI will have true coverage &lt;&lt; $(1-\alpha)$!!!</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Finite-Horizon-Analysis">Finite-Horizon Analysis<a class="anchor-link" href="#Finite-Horizon-Analysis">¶</a></h3><ul>
<li><strong>Last Time:</strong> Talked about various math issues related to difficulties that arise when analyzing simulation output.    </li>
<li><strong>This Time:</strong> How to get around these issues in the case of terminating simulations.    </li>
<li><strong>The Big Reveal:</strong> The method of independent replications.    </li>
</ul>
<p>Goal: To simulate some system of interest over a finite time horizon and analyze the output. For now, assume we obtain discrete simulation output $Y_1,Y_2,...,Y_m$ where the number of observations (m) can be constant or random.</p>
<p>Example: Obtain the waiting times $Y_1,Y_2,...,Y_{100}$ of the first 100 customers to show up at the store. Or m could denote the random number of customers observed during a time period [0,T], where T itself could be known or random.</p>
<p>For example we might consider all customers from 10am to 2pm (T is specified, but m is random). Or all customers from 10am until the cashier gets a call to pick up his kid at school (now T is random). Alternatively we might observe continuous simulation output Y(t) over an interval [0,T], where T can again be known or random.</p>
<p><strong>Example:</strong> Y(t) could denote the number of customers in the queue over the time period 8am to 5pm. T is constant. or from 8am until the cashier gets a call from her boyfriend (T is random).</p>
<p><strong>Easiest goal:</strong> Estimate the expected value of the sample mean of the observations $\theta = E[\bar{Y}_m]$ where $\bar{Y}_m = \frac{1}{m} \sum_1^m Y_i$ Of course, the distribution of the Yi's may change over the day. This is no problem, $\theta$ is simply the expected value of the average of all of these $Y_i's$. Tn the continuous case, we'd be interested in estimating $\theta = E[\bar{Y}(T)]$ where $\bar{Y}(T) = \frac{1}{T} \int_0^T Y(t) dt$</p>
<p>consider the discrete case. Although $\hat{Y}_m$ is an unbiased estimator for $\theta$ (by definition). A proper statistical analysis requires that we also provide an estimate of Var($\bar{Y}_m$)</p>
<p>But since the Yi's are not necassarily iid then Eq(2) and the fact that the Yi's may not be identically distributed show that we could have $Var(\bar{Y}_m) \ne Var(Y_1)/m$. Then according to our mathemtatical interlude this means that we cannot use $S_Y^2 / m $ to estimate $Var(\bar{Y}_m)$.</p>
<p>So what do we do now?</p>
<p>The way around the problem is via the method of independent replications (IR). IR Estimates $Var(\bar{Y}_m)$ by conducting r independent simulation runs (replications) of the system under study, where each replication consists of m observations. Furthermore it's easy to make the replications independent, just re-initialize each replication with a different pseudo-random number seed.</p>
<p><strong>Notation and Stuff</strong></p>
<p>Denote the sample mean from replication by $Z_i = \frac{1}{m} \sum_{j=1}^m Y_{i,j}$<br/>
Where $Y_{i,j}$ is the observation from j=0,1,...m from replication i=1,2,...,r<br/>
ie $Y_{i,j}$ is customer j's waiting time from rep i.</p>
<p>If each run is started under the same operating conditions (e.g. all queues empty and idle) then the replication sample means $Z_1,Z_2,...,Z_r$ are iid random variable.</p>
<p>Define the grand sample mean as $\bar{Z}_r = \frac{1}{r} \sum_{i=1}^r Z_i$. The obvious point estimator for $Var(\bar{Y}_m) = Var(Z_i)$ is the sample variance of the $Z_i's$<br/>
$$S_Z^2 = \frac{1}{r-1} \sum_{i=1}^r (Z_i - \bar{Z}_r)^2$$</p>
<p>Note that the forms of $S_Z^2$ and $S_Y^2 / m$ resemble each other. But since the replicate sample means are iid, $S_Z^2$ is usually much less biased for $Var(\bar{Y}_m) = Var(Z_i)$ than is $S_Y^2 / m$.</p>
<p>Having said all this $S_Z^2 / r$ is a reasonable estimator for $Var(\bar{Z}_r)$.</p>
<p>If the number of observations per replication, m, is large enough, a central limit theorem tells us that the replicate sample means $Z_1,...,Z_r$ are approximately iid $Nor(\theta,Var(Z_1))$ and<br/>
$$\large S_Z^2 \approx \frac{Var(Z_1) \chi^2 (r-1)}{r-1}$$</p>
<p>Then after the usual baby stats manipulations, we have the approximate IR $100(1-\alpha)\%$ two-sided CI for $\theta$.<br/>
$$\large \theta \in \bar{Z}_r \pm t_{\alpha/2,r-1} \sqrt{S_Z^2 / r}$$</p>
<p><strong>Example:</strong> Suppose we want to estimate the expected average waiting time for the first m=5000 customers at the bank. We make r=5 independent replications of the system, each initialized empty and idle and consisting of 5000 waiting times. The resulting replication means are:</p>
<pre><code>  i    1     2     3     4      5
Z_i    3.2   4.3   5.1   4.2    4.6</code></pre>
<p>Then $\bar{Z}_5 = 4.28, S_Z^2 = 0.487$. For level $\alpha=0.05$ we have $t_{0.025,4}=2.78$ and (3) gives the following 95% CI for the expected waiting time for the first 5000 customers
$$\large \theta \in 4.28 \pm 2.78 \sqrt{0.487 / 5} = [3.41,5.15]$$</p>
<p>Another Example</p>
<pre><code> i  1    2    3    4
Zi  5.2  4.3  3.1  4.2

then 
r = 4
Z_5 = (1/r)*(5.2+4.3+3.1+4.2)
t   = 2.353
S2  = (1/(r-1))*((5.2 - Z_5)**2 + (4.3 - Z_5)**2 +(3.1 - Z_5)**2 + (4.2 - Z_5)**2)

print(Z_5+t*np.sqrt(S2/r))
print(Z_5-t*np.sqrt(S2/r))

Yields
    5.2120
    3.1879</code></pre>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Finite-Horizon-Extensions">Finite-Horizon Extensions<a class="anchor-link" href="#Finite-Horizon-Extensions">¶</a></h3><p>In this section we expand the range of things that Independent Replications (IR) can perform.</p>
<p>For example:</p>
<ul>
<li>Want smaller CI's for the mean      </li>
<li>Want CI's for quantiles</li>
</ul>
<p>What if we'd like a smaller CI?<br/>
We will need more replications!!!</p>
<ul>
<li>Let $H = t_{\alpha/2,r-1} \sqrt{S_Z^2 / r}$ denote the half-length of the current CI</li>
<li>and let $\epsilon = t_{\alpha/2,r*-1} \sqrt{S_Z^2 / r* } $ <ul>
<li>denote the desired half length based on the same variance estimator $S_Z^2$ but more replications $r* &gt; r$    </li>
</ul>
</li>
</ul>
<p><strong>HOW MANY MORE?</strong><br/>
$\large r* = \frac{t_{\alpha/2,r*-1} S_Z^2 }{\epsilon^2} &lt; \frac{t_{\alpha/2,r-1} S_Z^2 }{\epsilon^2} = (H/\epsilon)^2 r$</p>
<p>So take $r* \leftarrow (H/\epsilon)^2 r$, and run $r* - r$ more reps. Then re-calculate the CI using all the $r*$ reps. You'll probably get a CI with half-length close to $\epsilon$</p>
<p>If we want to reduce the length of the CI by a factor of 10, we'll need to increase the reps by a factor of 100. What if we'd like a CI for other performance measures? Such as Quantiles?</p>
<p><strong>Definition:</strong> The p-quantile of a RV W with cdf $F(w)$ is $\xi = min{w|F(w) \ge p}$. If W is continuous, then $F(\xi_p) = p$ and $F^{-1}(p)$.</p>
<p><strong>Example:</strong> Suppose that $W \sim Exp(\lambda)$. Then (we've seen this a million times) $F(w) = 1-e^{-\lambda w}$, so that $\xi_p = \frac{1}{\lambda} ln(1-p)$.</p>
<p>We can use the method of independent replications to obtain confidence intervals for quantiles.</p>
<p><strong>Example:</strong> Let $W_i$ denote the maximum waiting time that some customer experiences at the airport ticket counter between 8 a.m. and 5 p.m. during replication i of a simulation, i=1,2,...,r.</p>
<p>Let's order the i.i.d $W_i's: \; W_{(1)} \le W_{(2)} \le \cdots \le W_{(r)}$.</p>
<p>Then the typical point estimator for the quantile $\xi_p$ is:<br/>
$\hat{\xi_p} = W_{(\lfloor rp+0.5 \rfloor)}$<br/>
Where $\lfloor \cdot \rfloor$ is the floor (round-down) function</p>
<p>So now that we have a point estimator for $\xi_p$ we'll get a CI for the $\xi_p$ ....</p>
<p>A slightly conservative approximate nonparametric CI fo $\xi_p$ will turn out to be of the form $\xi_p in [W_{(j)},W_{(k)}]$<br/>
To this end, first note that $P(W_i \le \epsilon_p) = p$ So if we define A as the number of $W_i's$ that are $\le \xi_p$ then $A \sim Bin(r,p)$.</p>
<p>Second the event that $\{j \le A \le k-1\}$ means that between j and k-1 of the $W_i's$ are $\le \xi_p$.<br/>
This is equivalent to the event $\{ (\xi_p \ge W_{(j)}) \; and \; (\xi_p \lt W_{(k)}) \}$</p>
<p>Putting this all together, we have ...<br/>
$\begin{split} 
P( W_{(j)} \le \xi_p \le W_{(k)} ) &amp; = P(j \le A \le k-1)  \\
&amp; = \sum_{l=j}^{k-1} {r \choose l} p^l (1-p)^{r-l} \\
&amp; = \phi( \frac{k-0.5-rp}{\sqrt{rp(1-p)}} ) - \phi( \frac{j-0.5-rp}{\sqrt{rp(1-p)}} )   
\end{split}$</p>
<p>Where $\phi(\cdot)$ is the Nor(0,1) cdf, the "0.5" terms are "continuity corrections", and the approximation requires rp and $r(1-p) \ge 5$.</p>
<p>So in order to get an approximate 100(1-$\alpha$)% CI of the form $\xi_p \in [W_{(j)} , W_{(k)}]$ we need to find j and k such that<br/>
$$\large \phi( \frac{k-0.5-rp}{\sqrt{rp(1-p)}} ) - \phi( \frac{j-0.5-rp}{\sqrt{rp(1-p)}} ) \ge 1-\alpha$$</p>
<p>(<strong>Note</strong> that this is a little conservative because of the binomial discretization)</p>
<p>Suggested values for the j and k arise by setting.</p>
<ul>
<li>$\frac{j-0.5-rp}{\sqrt{rp(1-p)}} = -z_{\alpha/2}$<ul>
<li>thus $j = \lfloor rp + 0.5 - z_{\alpha/2} \sqrt{rp(1-p)} \rfloor$</li>
</ul>
</li>
<li>and </li>
<li>$\frac{k-0.5-rp}{\sqrt{rp(1-p)}} = z_{\alpha/2}$             <ul>
<li>thus $k = \lceil rp + 0.5 - z_{\alpha/2} \sqrt{rp(1-p)} \rceil$</li>
</ul>
</li>
</ul>
<p>Sometimes - especially for "extreme" quantiles, you need a lot of replications to get reasonably small half-lengths.</p>
<p><strong>Example:</strong> Let's suppose that we want a 95% CI for $\xi_{0.9}$ and we've made r=1000 reps. Point estimator for $\xi_{0.9}$ is $\hat{\xi}_{0.9} = W_{(\lfloor 1000(0.9)+0.5 \rfloor)} = W_{(900)}$.</p>
<p>With the CI in mind,</p>
<ul>
<li>$j = \lfloor 900.5-1.96\sqrt{90} \rfloor = 881 $</li>
<li>$k = \lceil 900.5+1.96\sqrt{90} \rceil = 920 $</li>
</ul>
<p>Therefore the CI 95% is $[W_{(881)},W_{(920)}]$.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Simulation-Initialization">Simulation Initialization<a class="anchor-link" href="#Simulation-Initialization">¶</a></h3><p>$\rightarrow$ How to start a simulation and when to keep the data.</p>
<p>Before a simulation can be run, one must provide initial values for all of the simulation's state variables. Experimenter may not know appropriate initial values for the state variables, so these values might be chosen arbitrarily. Eg. it might be convenient to initialize a queue as empty and idle. Such a choice has a significant but unrecognized impact on the simulation run's outcome. This initialization bias problem can lead to errors, particularly in steady-state output analysis.</p>
<p><strong>Possible Issues</strong></p>
<p>Visual detection of initialization effects is sometimes difficult - eg: queueing systems having high intrinsic variance.</p>
<p>How to init the simulation?</p>
<ul>
<li>Suppose a machine shop closes at a certain time each day.  </li>
<li>The start each day with a demand depending on the number of jobs remaining from the previous day.</li>
</ul>
<p>Initialization bias can lead to point estimators for steady-state parameters having high MSE, as well as CIs having poor coverage.</p>
<p><strong>Detecting Init Bias</strong><br/>
Since initialization bias raises important concerns, how do we detect and deal with it?</p>
<p>First detection Methods:</p>
<ul>
<li>Try to detect the bias visually by scanning the simulation output.  <ul>
<li>This may not be easy, since visual analysis is tedious and can miss bias</li>
<li>Can transform the data to make it more efficient</li>
<li>Smoothing, log, or even sqare roots</li>
</ul>
</li>
<li>Alternatively, you conduct statistical tests for initialization bias<ul>
<li>Does the mean or variance of a process changes over time?</li>
</ul>
</li>
</ul>
<p><strong>Dealing with Bias</strong><br/>
If initialization bias is detected, one may want to do something about it. For this there are two simple methods.</p>
<p>Method A: Truncate the output by allowing the simulation to "warm up" before data are retained for analysis.</p>
<ul>
<li>Experimenter hopes that the remaining data are representative of the steady-state system.</li>
<li>Output truncation - most popular method for dealing with bias. <ul>
<li>All of the major simulation languages have built-in truncation functions</li>
</ul>
</li>
<li>How to find a good truncation point?<ul>
<li>If output is truncated too early $\rightarrow$ significant bias might still exist </li>
<li>If truncated too late $\rightarrow$ good observations might be wasted.</li>
<li>Of course as with any simple rule, it doesn't generalize very well to many cases</li>
</ul>
</li>
<li>Another reasonable approach: Take the avg observations across several reps, and then visually choose a truncation point</li>
<li>More sophisticated approaches include sequential change-point detection algorithms</li>
</ul>
<p>Method B: Make a very long run to overwhelm the initialization effects.</p>
<ul>
<li>Conceptually simple to carry out and may yield point estimators having lower MSEs than truncation methods.</li>
<li><strong>Problem:</strong> <ul>
<li>This approach can be wasteful with observations; </li>
<li>might need excessive run length before initialization effects are rendered negligible</li>
</ul>
</li>
<li><strong>Bottom Line</strong> <ul>
<li>Once initialization effects are dealt with you can do steady state analysis</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Steady-State-Analysis">Steady-State Analysis<a class="anchor-link" href="#Steady-State-Analysis">¶</a></h3><p>Assume we have the output from a stationary (steady-state) simulation output $Y_1,...,Y_n$</p>
<ul>
<li>goal is to estimate some parameter of interest (eg mean customer waiting time or expected profit produced)  </li>
<li>In particular, suppose the mean of this output is the unknown quantity $\mu$. We'll use the sample mean $\bar{Y}_n$ to estimate $\mu$.</li>
<li>As in the case of terminating / fintie-horizon simulations (where we used the method of IR), we must accompany the value of any point estimator with a measure of it's variance.</li>
</ul>
<p>Instead of $Var(\bar{Y}_n)$ we can estimate the variance parameter,<br/>
$\begin{split}
\sigma^2 &amp; = \lim_{n\to\infty} n Var({\bar{Y}_n})  \\
&amp; = \lim_{n\to\infty} \left( R_0 + 2 \sum_{k=1}^{n-1} (1 - \frac{k}{n}) R_k \right) \\
&amp; = \sum_{k=-\infty}^{\infty} R_k \; \text{ If the } R_k's \text{ decrease quickly } k\to\infty
\end{split}$</p>
<ul>
<li>Thus $\sigma^2$ is simply the sum of all covariances</li>
</ul>
<p>$\sigma^2$ pops up all over the place. Simulation output analysis, Brownian motions, financial engineering applications, etc.</p>
<p><strong>Example:</strong> MA(1) process, $Y_{i+1} = \theta \epsilon_i + \epsilon_{i+1}$ where $\epsilon_i's$ are iid N(0,1). Then $R_0 = 1+\theta^2, R_{\pm 1}=\theta, R_k=0$</p>
<p>By (2) (from Mathematical interlude)</p>
<ul>
<li>$nVar(\bar{Y}_n)$</li>
<li>$=R_0 + 2 \sum_{k=1}^{n-1} (1 - \frac{k}{n}) R_k $</li>
<li>$=(1+\theta)^2 - \frac{20}{n}$</li>
<li>and so </li>
<li>$\sigma^2 = \lim_{n\to\infty} nVar(\bar{Y}_n) = (1 + \theta)^2$</li>
</ul>
<p><strong>Example:</strong> AR(1) process, $Y_{i+1} = \phi Y_i + \epsilon_{i+1}$ where $\epsilon_i's$ are iid's $N(0,1-\phi^2), -1 \lt \phi \lt 1$ and $Y_0 \sim N(0,1)$.</p>
<p>For the AR(1),</p>
<ul>
<li>$R_k = \phi^{|k|}, \forall k$. </li>
<li>Then after lots of algebra, it turns out that </li>
<li>$\sigma^2 = (1+\phi)/(1-\phi)$ </li>
<li>so $\sigma^2$ explodes as $\phi \to 1$</li>
</ul>
<p>Many methods for estimating $\sigma^2$ and for conducting steady-state output analysis in general: batch means, IR, standardized time series, spectral analysis, regeneration, ARMA time series modeling, etc.</p>
<p><strong>$\color{red}{\text{Batch Means}}$</strong></p>
<p>The method of batch means (BM) is often used to estimate $\sigma^2$ and to calculate confidence intervals for $\mu$.</p>
<p>IDEA: Divide one long simulation run into a number of contiguous batches, and then appeal to a central limit theorem to assume that the resulting batch sample means are approximately iid normal.</p>
<p>In particular, suppose that we partition $Y_1,\cdots,Y_n$ into b nonoverlapping, contiguous batches, each consisting of m observations (assume that n=bm)</p>
<p><img src="ISYE6644_images/w10_01.png" width="600;"/></p>
<p>Then the i'th batch mean is the sample mean of the m observations from batch i=1,2,...,b.<br/>
$$\large  \bar{Y}_{i,m} = \frac{1}{m} \sum_{j=1}^m Y_{(i-1)m+j}   $$</p>
<p>The batch means are correlated for small m, but for large m, 
$$\large \bar{Y}_{1,m},\cdots,\bar{Y}_{b,m} \approx \text{ iid } N(\mu,V(\bar{Y}_{i,m})) \approx N(\mu,\sigma^2/m)  $$</p>
<p>Similar to IR (actually more similar than it may seem) we define the <strong>batch means estimator</strong> for $\sigma^2 = \lim_{n\to\infty} n Var(\bar{Y}_n) = \lim_{m\to\infty} m V(\bar{Y}_{1,m})$ as 
$$\large \hat{V}_B = \frac{m}{b-1} \sum_{i=1}^b (\bar{Y}_{i,m} - \bar{Y}_n)^2 \approx \frac{\sigma^2 \chi^2(b-1)}{b-1} $$</p>
<p>How good is $\hat{V}_B$ as an estimator of $\sigma^2$? For now, let's at least look at its mean.</p>
<p>We have $E[\hat{V}_B] = \frac{\sigma^2}{b-1} E[\chi^2(b-1)] = \sigma^2$, so $\hat{V}_B$ is asymptotically unbiased for $\sigma^2$ as the batch size $m\to\infty$</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Prop-of-Batch-Means">Prop of Batch Means<a class="anchor-link" href="#Prop-of-Batch-Means">¶</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="End-of-Notes">End of Notes<a class="anchor-link" href="#End-of-Notes">¶</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Pi-Simulation">Pi Simulation<a class="anchor-link" href="#Pi-Simulation">¶</a></h2>
</div>
</div>
</div>
</div></div></body>
</html>
